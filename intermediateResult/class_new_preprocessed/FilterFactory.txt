licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java data input import java data output import java import org apach cassandra type size import org apach cassandra util ob bit set import org apach cassandra util ob heap bit set import org apach cassandra util ob open bit set import org slf logger import org slf logger factori public class filter factori privat static final logger logger logger factori logger filter factori class privat static final type size type size privat static final long public enum type public static void serial filter data output output throw serial output type public static void serial filter data output output type type throw switch type case legaci bloom filter serial serial legaci bloom filter output break case murmur bloom filter serial serial murmur bloom filter output break default murmur bloom filter serial serial murmur bloom filter output break public static filter deseri data input input type type boolean offheap throw switch type case return legaci bloom filter serial deseri input case return murmur bloom filter serial deseri input offheap default return murmur bloom filter serial deseri input offheap public static long serial size filter return serial size type public static long serial size filter type type switch type case return legaci bloom filter serial serial size legaci bloom filter case return murmur bloom filter serial serial size murmur bloom filter default return murmur bloom filter serial serial size murmur bloom filter return bloom filter lowest practic fals posit probabl number element public static filter filter long num element int target bucket elem boolean offheap return filter num element target bucket elem type offheap helper method test static filter filter long num element int target bucket elem type type boolean offheap int max bucket element math max bloom calcul max bucket element num element int bucket element math min target bucket elem max bucket element bucket element target bucket elem logger warn string format provid optim bloom filter element bucket element num element bucket element target bucket elem bloom calcul bloom specif spec bloom calcul comput bloom spec bucket element return creat filter spec num element spec bucket element type offheap return smallest bloom filter provid fals posit probabl rate number element assert probabl satisfi filter public static filter filter long num element doubl max fals pos probabl boolean offheap return filter num element max fals pos probabl type offheap helper method test static filter filter long num element doubl max fals pos probabl type type boolean offheap assert max fals pos probabl invalid probabl max fals pos probabl return alway present filter int bucket element bloom calcul max bucket element num element bloom calcul bloom specif spec bloom calcul comput bloom spec bucket element max fals pos probabl return creat filter spec num element spec bucket element type offheap privat static filter creat filter int hash long num element int bucket type type boolean offheap long num bit num element bucket bit set bitset offheap heap bit set num bit open bit set num bit switch type case return murmur bloom filter hash bitset default return murmur bloom filter hash bitset 