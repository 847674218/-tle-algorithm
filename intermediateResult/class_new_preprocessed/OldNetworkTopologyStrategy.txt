licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra locat import java net inet address import java util array list import java util iter import java util list import java util map import org apach cassandra tabl import org apach cassandra configur import org apach cassandra dht token replic strategi return node respons key respect rack awar place replica differ data center ani data center replica differ rack datacent ani remain replica unus node ring public class network topolog strategi extend abstract replic strategi public network topolog strategi string tabl token metadata token metadata endpoint snitch snitch map string string config option super tabl token metadata snitch config option public list inet address calcul natur endpoint token token token metadata metadata int replica replic factor list inet address endpoint array list inet address replica array list token token metadata sort token token empti return endpoint iter token iter token metadata ring iter token token fals token primari token iter endpoint add metadata endpoint primari token boolean data center fals boolean rack fals endpoint size replica iter tri find differ data center token iter snitch datacent metadata endpoint primari token equal snitch datacent metadata endpoint alreadi someth diff datacent find anoth data center endpoint add metadata endpoint data center true continu tri find differ rack snitch rack metadata endpoint primari token equal snitch rack metadata endpoint snitch datacent metadata endpoint primari token equal snitch datacent metadata endpoint alreadi someth diff rack find anoth rack endpoint add metadata endpoint rack true number node good loop wil exit otherwis loop list add node endpoint size replica iter token metadata ring iter token token fals endpoint size replica iter token iter endpoint metadata endpoint endpoint add metadata endpoint return endpoint public int replic factor return integ pars int config option replic factor public void valid option throw configur config option null config option replic factor null throw configur simpl strategi requir replic factor strategi option valid replic factor config option replic factor 