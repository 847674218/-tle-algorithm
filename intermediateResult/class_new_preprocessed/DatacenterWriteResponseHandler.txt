licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java net inet address import java util collect import googl common collect iter import org apach cassandra config databas descriptor import org apach cassandra tabl import org apach cassandra unavail import org apach cassandra gms failur detector import org apach cassandra locat endpoint snitch import org apach cassandra net messag import org apach cassandra consist level import org apach cassandra write type import org apach cassandra util util class block quorum respons local datacent onli public class datacent write respons handler extend write respons handler privat static final endpoint snitch snitch databas descriptor endpoint snitch public datacent write respons handler collect inet address natur endpoint collect inet address pend endpoint consist level consist level tabl tabl runnabl callback write type write type super natur endpoint pend endpoint consist level tabl callback write type assert consist level consist level overrid public void respons messag messag messag null databas descriptor local data center equal snitch datacent messag respons decrement signal 