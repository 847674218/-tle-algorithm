licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import java nio byte buffer import java util import org slf logger import org slf logger factori import org apach cassandra config import org apach cassandra import org apach cassandra filter disk atom filter import org apach cassandra filter queri filter import org apach cassandra filter slice queri filter import org apach cassandra index secondari index manag import org apach cassandra marshal abstract type import org apach cassandra marshal marshal import org apach cassandra dht partition import org apach cassandra dht random partition import org apach cassandra dht token import org apach cassandra servic storag servic import org apach cassandra util byte buffer util import org apach cassandra util util lot build block cassandra server call valid input ensur column conform declar compar instanc method tri part valid combin differ supercolumn regular rang slice batch singl column valid column path main includ tabl valid public class thrift valid privat static final logger logger logger factori logger thrift valid class public static void valid key meta data metadata byte buffer key throw org apach cassandra invalid request key null key remain throw org apach cassandra invalid request key empti check key handl util write short byte array key remain util throw org apach cassandra invalid request key length key remain longer maximum util tri metadata key valid valid key catch marshal throw org apach cassandra invalid request messag public static void valid tabl string tablenam throw keyspac defin schema instanc tabl tablenam throw keyspac defin keyspac tablenam doe exist public static meta data valid column famili string tablenam string boolean commut throw org apach cassandra invalid request meta data metadata valid column famili tablenam commut metadata default valid commut throw org apach cassandra invalid request invalid oper commut columnfamili els metadata default valid commut throw org apach cassandra invalid request invalid oper commut columnfamili return metadata oper author counter public static meta data valid column famili string tablenam string throw org apach cassandra invalid request valid tabl tablenam empti throw org apach cassandra invalid request empti columnfamili requir meta data metadata schema instanc meta data tablenam metadata null throw org apach cassandra invalid request unconfigur columnfamili return metadata valid part path column includ column public static void valid column path meta data metadata column path column path throw org apach cassandra invalid request metadata type column famili type standard column path super column null throw org apach cassandra invalid request supercolumn paramet invalid standard metadata column path column null throw org apach cassandra invalid request column paramet option standard metadata els column path super column null throw org apach cassandra invalid request supercolumn paramet option super metadata column path column null valid column metadata column path super column array list column path column column path super column null valid column metadata byte buffer null array list column path super column public static void valid column parent meta data metadata column parent column parent throw org apach cassandra invalid request metadata type column famili type standard column parent super column null throw org apach cassandra invalid request columnfamili alon requir standard metadata column parent super column null valid column metadata byte buffer null array list column parent super column column path parent column path remov column option standard static void valid column path parent meta data metadata column path column path parent throw org apach cassandra invalid request metadata type column famili type standard column path parent super column null throw org apach cassandra invalid request supercolumn specifi standard metadata metadata type column famili type super column path parent super column null column path parent column null throw org apach cassandra invalid request column specifi specifi super column remov super metadata column path parent column null valid column metadata column path parent super column array list column path parent column column path parent super column null valid column metadata byte buffer null array list column path parent super column valid column parent path data privat static void valid column meta data metadata byte buffer super column iter byte buffer column throw org apach cassandra invalid request super column null super column remain column throw org apach cassandra invalid request supercolumn length greater column super column remain throw org apach cassandra invalid request supercolumn empti metadata type column famili type standard throw org apach cassandra invalid request supercolumn specifi column famili metadata normal column abstract type compar metadata compar super column byte buffer column remain column throw org apach cassandra invalid request column length greater column remain throw org apach cassandra invalid request column empti tri compar valid catch marshal throw org apach cassandra invalid request messag public static void valid column meta data metadata column parent column parent iter byte buffer column throw org apach cassandra invalid request valid column metadata column parent super column column public static void valid rang meta data metadata column parent column parent slice rang rang throw org apach cassandra invalid request abstract type compar metadata compar column parent super column tri compar valid rang start compar valid rang finish catch marshal throw org apach cassandra invalid request messag rang count throw org apach cassandra invalid request slice requir negat count compar byte buffer order compar rang revers compar revers compar compar rang start remain rang finish remain order compar compar rang start rang finish throw org apach cassandra invalid request rang finish start order travers public static void valid column super column meta data metadata column super column cosc throw org apach cassandra invalid request boolean commut metadata default valid commut int null cosc column null null cosc super column null null cosc counter column null null cosc counter super column null null null throw org apach cassandra invalid request column super column onli column super column counter counter super column cosc column null commut throw org apach cassandra invalid request invalid oper commut columnfamili metadata valid ttl cosc column valid column path metadata column path metadata set super column byte buffer null set column cosc column valid column data metadata cosc column fals cosc super column null commut throw org apach cassandra invalid request invalid oper commut columnfamili metadata column cosc super column column valid column path metadata column path metadata set super column cosc super column set column valid column data metadata true cosc counter column null commut throw org apach cassandra invalid request invalid oper commut columnfamili metadata valid column path metadata column path metadata set super column byte buffer null set column cosc counter column cosc counter super column null commut throw org apach cassandra invalid request invalid oper commut columnfamili metadata counter column cosc counter super column column valid column path metadata column path metadata set super column cosc counter super column set column privat static void valid ttl column column throw org apach cassandra invalid request column set ttl column ttl throw org apach cassandra invalid request ttl posit column ttl expir column throw org apach cassandra invalid request string format ttl larg request maximum column ttl expir column els set check thrift doesn chang contract assert column ttl public static void valid mutat meta data metadata mutat mut throw org apach cassandra invalid request column super column cosc mut column supercolumn delet del mut delet int null cosc null null del null null null throw org apach cassandra invalid request mutat onli column supercolumn delet cosc null valid column super column metadata cosc els valid delet metadata del public static void valid delet meta data metadata delet del throw org apach cassandra invalid request del super column null valid column metadata byte buffer null array list del super column del predic null valid slice predic metadata del super column del predic del predic slice rang null throw org apach cassandra invalid request delet doe support slice rang predic metadata type column famili type standard del super column null string msg string format delet super column possibl standard column famili key space column famili delet metadata metadata del throw org apach cassandra invalid request msg metadata default valid commut forc server timestamp timestamp set coher counter oper del timestamp system current time milli els del set timestamp throw org apach cassandra invalid request delet timestamp option commut column famili metadata public static void valid slice predic meta data metadata byte buffer slice predic predic throw org apach cassandra invalid request predic column null predic slice rang null throw org apach cassandra invalid request slice predic list column slice rang predic slice rang null valid rang metadata column parent metadata set super column predic slice rang predic column null valid column metadata predic column valid data part column everyth column object assum valid public static void valid column data meta data metadata column column boolean column throw org apach cassandra invalid request valid ttl column column set valu throw org apach cassandra invalid request column valu requir column set timestamp throw org apach cassandra invalid request column timestamp requir column definit column def metadata column definit column column tri abstract type valid metadata valu valid column def valid null valid valid column valu catch marshal logger debug enabl logger debug reject invalid valu byte buffer util byte hex summar column valu throw org apach cassandra invalid request string format fail valid messag metadata metadata column metadata subcolumn compar metadata compar string column index column valu larger detail tabl open metadata column famili store metadata index manag valid column throw org apach cassandra invalid request string format index column valu size index column valu remain column def index metadata metadata return buffer avoid veri larg column valu log entireti privat static byte buffer summar byte buffer buffer int short buffer remain return buffer return byte buffer buffer slice limit buffer posit public static void valid predic meta data metadata column parent column parent slice predic predic throw org apach cassandra invalid request predic column null predic slice rang null throw org apach cassandra invalid request predic column slice rang null predic column null predic slice rang null throw org apach cassandra invalid request predic column slice rang present predic slice rang null valid rang metadata column parent predic slice rang els valid column metadata column parent predic column public static void valid key rang meta data metadata byte buffer super column key rang rang throw org apach cassandra invalid request rang start key null rang start token null rang key null rang token null throw org apach cassandra invalid request exact start key start token key token specifi key token support wide row token key rang start token null rang key null throw org apach cassandra invalid request start token key support key rang partition storag servic partition rang start key null rang key null token start token token rang start key token token token rang key start token compar token token minimum preserv order throw org apach cassandra invalid request start key sort befor equal finish key partition els throw org apach cassandra invalid request start key token sort key token probabl specifi key order partition els rang start key null rang token null start token token wrap key token row posit stop token factori string rang token max key bound row posit key rang start key compar stop throw org apach cassandra invalid request start key token sort token valid filter claus metadata rang row filter empti rang row filter super column null throw org apach cassandra invalid request super column support index rang count throw org apach cassandra invalid request max row posit privat static boolean empti list index express claus return claus null claus empti public static void valid index claus meta data metadata index claus index claus throw org apach cassandra invalid request index claus express empti throw org apach cassandra invalid request index claus list empti valid filter claus metadata index claus express throw org apach cassandra invalid request index column present index claus oper return true index claus index column oper public static boolean valid filter claus meta data metadata list index express index claus throw org apach cassandra invalid request empti index claus filter appli return fals secondari index manag idx manag tabl open metadata column famili store metadata index manag abstract type valid column famili compar metadata metadata null boolean index fals index express express index claus tri valid valid express column catch marshal throw org apach cassandra invalid request string format fail valid byte buffer util byte hex express column byte buffer util byte hex express valu messag express valu remain throw org apach cassandra invalid request index express valu larger abstract type valu valid schema instanc valu valid metadata metadata express column tri valu valid valid express valu catch marshal throw org apach cassandra invalid request string format fail valu valid byte buffer util byte hex express column byte buffer util byte hex express valu messag index express index oper idx manag index express column return index public static void valid keyspac exist string throw org apach cassandra invalid request keyspac uniqu case insensit becaus keyspac becom directori store sstabl differ onli case caus problem case insensit filesystem instal string schema instanc tabl equal ignor case throw org apach cassandra invalid request string format keyspac case insensit uniqu conflict public static void valid keyspac system string modifi keyspac throw org apach cassandra invalid request modifi keyspac equal ignor case tabl throw org apach cassandra invalid request system keyspac user modifi public static disk atom filter filter slice predic abstract type compar slice rang slice rang null sort set byte buffer tree set byte buffer compar add column return queri filter els return slice queri filter start finish revers count 