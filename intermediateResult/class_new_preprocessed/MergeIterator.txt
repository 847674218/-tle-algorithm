licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java import java util import googl common collect abstract iter merg sort input iter individu uniqu item public abstract class merg iter extend abstract iter implement merg iter protect final reduc reduc protect final list extend closeabl iter iter protect merg iter list extend closeabl iter iter reduc reduc iter iter reduc reduc public static merg iter final list extend closeabl iter sourc compar compar final reduc reduc sourc size return reduc trivial reduc trivial trivial sourc reduc sourc reduc return mani sourc compar reduc public iter extend closeabl iter iter return iter public void close closeabl iter iter iter tri iter close catch throw runtim reduc close merg iter consum multipl input valu output valu privat static final class mani extend merg iter queue return candid open item protect final prioriti queue candid queue stack consum candid lazili call advanc prioriti queue implement stash item array wouldn storag protect final array dequ candid candid public mani list extend closeabl iter iter compar comp reduc reduc super iter reduc queue prioriti queue candid math max iter size closeabl iter iter iter candid candid candid iter comp candid advanc empti continu queue add candid candid array dequ candid queue size protect final comput advanc return consum consum valu send reduc equal protect final consum reduc key chang candid candid queue peek candid null return data candid queue poll candid push candid reduc reduc candid item queue peek null queue peek compar candid return reduc reduc advanc enqueu item consum iter protect final void advanc candid candid candid candid poll null candid advanc queue add candid hold compar head item iter protect static final class candid implement compar candid privat final closeabl iter iter privat final compar comp privat item public candid closeabl iter iter compar comp iter iter comp comp return true iter item avail protect boolean advanc iter return fals item iter return true public int compar candid return comp compar item item accumul collect valu type output valu type public static abstract class reduc return true case singl sourc iter public boolean trivial reduc trivial return fals combin object previous intermedi state implement public abstract void reduc current return object comput reduc protect abstract reduc call key befor ani reduc call overriden implement class protect void key chang overridden implement requir clean public void close privat static class extend merg iter privat final closeabl iter sourc public list extend closeabl iter sourc reduc reduc super sourc reduc sourc sourc protect comput sourc return data reduc key chang reduc reduc sourc return reduc reduc privat static class trivial extend merg iter privat final closeabl iter sourc public trivial list extend closeabl iter sourc reduc reduc super sourc reduc sourc sourc protect comput sourc return data return sourc 