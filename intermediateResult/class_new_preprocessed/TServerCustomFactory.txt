licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import org slf logger import org slf logger factori import org apach thrift server server helper implement creat thrift server base common type support sync async hsha custom type set fulli qualifi java class rpc server type set public class server custom factori implement server factori privat static logger logger logger factori logger server custom factori class privat final string server type public server custom factori string server type assert server type null server type server type public server build server server factori arg arg server server thrift server equal ignor case server type server custom thread pool server factori build server arg logger info string format synchron threadpool thrift server arg addr host arg addr port els thrift server equal ignor case server type server custom block server factori build server arg logger info string format block asynchron thrift server arg addr host arg addr port els thrift server equal ignor case server type server custom server factori build server arg logger info string format custom sync async thrift server arg addr host arg addr port els server factori server factori tri server factori server factori class server type instanc catch throw runtim fail instanti server factori server type server server factori build server arg logger info string format custom thrift server server class arg addr host arg addr port return server 