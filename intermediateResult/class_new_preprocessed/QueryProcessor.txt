licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql import java nio byte buffer import java util import googlecod concurrentlinkedhashmap concurr link hash map import org antlr runtim import org slf logger import org slf logger factori import org apach cassandra cql statement import org apach cassandra transport messag result messag import org apach cassandra config import org apach cassandra import org apach cassandra filter import org apach cassandra marshal abstract type import org apach cassandra import org apach cassandra servic client state import org apach cassandra servic queri state import org apach cassandra trace trace import org apach cassandra util util import org apach cassandra util digest import org apach cassandra util semant version public class queri processor public static final semant version semant version privat static final logger logger logger factori logger queri processor class public static final int buggi client ing privat static final map digest statement prepar statement concurr link hash map builder digest statement maximum weight capac build privat static final map integ statement thrift prepar statement concurr link hash map builder integ statement maximum weight capac build public static statement prepar digest return prepar statement public static statement prepar integ return thrift prepar statement public static void valid key byte buffer key throw invalid request key null key remain throw invalid request key empti check key handl util write short byte array key remain util throw invalid request key length key remain longer maximum util public static void valid column iter byte buffer column throw invalid request byte buffer column remain column throw invalid request string format column long remain column remain throw invalid request length column public static void valid column byte buffer column throw invalid request valid column collect singleton list column public static void valid filter meta data metadata disk atom filter filter throw invalid request filter instanceof slice queri filter valid slice filter metadata slice queri filter filter els valid column queri filter filter column public static void valid slice filter meta data metadata slice queri filter rang throw invalid request tri abstract type compar metadata compar null column slice valid rang slice compar rang revers catch illeg argument throw invalid request messag privat static result messag process statement statement statement consist level queri state queri state list byte buffer variabl throw request execut request valid client state client state queri state client state statement valid client state statement check access client state result messag result statement execut queri state variabl return result null result messag void result public static result messag process string queri string consist level queri state queri state throw request execut request valid logger trace queri string return process statement statement queri string queri state client state statement queri state collect byte buffer empti list public static untyp result set process string queri throw request execut tri queri state state queri state client state true result messag result process queri consist level state result instanceof result messag row return untyp result set result messag row result result els return null catch request valid throw runtim public static untyp result set process intern string queri tri client state state client state true queri state state queri state state state set keyspac tabl statement statement statement queri state statement statement valid state result messag result statement execut intern state result instanceof result messag row return untyp result set result messag row result result els return null catch request execut throw runtim catch request valid throw assert error public static untyp result set resultifi string queri row row tri select statement select statement statement queri null statement result set cql row process collect singleton list row return untyp result set cql row catch request valid throw assert error public static result messag prepar prepar string queri string client state client state boolean thrift throw request valid logger trace queri string pars statement prepar prepar statement queri string client state result messag prepar msg store prepar statement queri string prepar thrift assert prepar statement bound term prepar bound size return msg privat static result messag prepar store prepar statement string queri string pars statement prepar prepar boolean thrift thrift int statement queri string hash code thrift prepar statement put statement prepar statement logger trace string format store prepar statement bind marker statement prepar statement bound term return result messag prepar thrift statement prepar bound els digest statement digest comput queri string logger trace string format store prepar statement bind marker statement prepar statement bound term prepar statement put statement prepar statement return result messag prepar statement prepar bound public static result messag process prepar statement statement consist level queri state queri state list byte buffer variabl throw request execut request valid check ani bound variabl verifi variabl empti statement bound term variabl size statement bound term throw invalid request string format marker bound variabl statement bound term variabl size point match count marker variabl logger trace enabl int variabl size logger trace variabl return process statement statement queri state variabl privat static pars statement prepar statement string queri str client state client state throw request valid trace trace pars statement pars statement statement pars statement queri str set keyspac statement requir login statement instanceof statement statement statement prepar keyspac client state trace trace pepar statement return statement prepar public static pars statement pars statement string queri str throw syntax tri lexer parser char stream stream string stream queri str cql lexer lexer cql lexer stream token stream token stream common token stream lexer cql parser parser cql parser token stream pars queri string statement instanc pars statement statement parser queri lexer parser queue ani error encount necessari turn lexer throw recognit error parser throw recognit error return statement catch runtim syntax ire syntax fail pars statement queri str reason class simpl messag throw ire catch recognit syntax ire syntax invalid malform queri string messag throw ire 