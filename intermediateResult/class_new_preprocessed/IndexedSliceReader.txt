licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra columniter import java import java nio byte buffer import java util array dequ import java util dequ import java util list import googl common collect abstract iter import org apach cassandra column famili import org apach cassandra decor key import org apach cassandra delet info import org apach cassandra disk atom import org apach cassandra row index entri import org apach cassandra filter column slice import org apach cassandra marshal abstract type import org apach cassandra sstabl corrupt tabl import org apach cassandra sstabl index helper import org apach cassandra sstabl index helper index info import org apach cassandra sstabl tabl reader import org apach cassandra util file data input import org apach cassandra util file mark import org apach cassandra util byte buffer util reader find block start column return block befor call function assum sort exploit index class index slice reader extend abstract iter disk atom implement disk atom iter privat final column famili empti column famili privat final tabl reader sstabl privat final list index helper index info index privat final file data input origin input privat file data input file privat final boolean revers privat final column slice slice privat final block fetcher fetcher privat final dequ disk atom block column array dequ disk atom privat final abstract type compar slice reader assum slice sort correct lookup slice lexicograph order start element revers lookup revers lexicograph order finish revers start element revers reader assum valid perform term interv overlap interv public index slice reader tabl reader sstabl row index entri index entri file data input input column slice slice boolean revers sstabl sstabl origin input input revers revers slice slice compar sstabl metadata compar tri sstabl descriptor version promot index index index entri column index index empti set row start sstabl index entri input empti column famili column famili creat sstabl metadata empti column famili delet delet info serial deseri tabl file sstabl descriptor version fetcher simpl block fetcher els empti column famili column famili creat sstabl metadata empti column famili delet index entri delet info fetcher index block fetcher index entri posit els set row start sstabl index entri input index helper skip bloom filter file index index helper deseri index file empti column famili column famili creat sstabl metadata empti column famili delet delet info serial deseri tabl file sstabl descriptor version fetcher index empti simpl block fetcher index block fetcher file file pointer column count skip base posit catch sstabl mark suspect throw corrupt tabl file path set seek posit start row column scan privat void set row start tabl reader reader row index entri index entri file data input input throw input null file sstabl file data input index entri posit els file input input seek index entri posit sstabl decod key byte buffer util read short length file tabl reader read row size file sstabl descriptor public column famili column famili return empti column famili public decor key key throw unsupport oper protect disk atom comput true disk atom column block column poll column null fetcher fetch data return data els return column public void close throw origin input null file null file close protect void add column disk atom col revers block column add col els block column add col privat abstract class block fetcher protect int current slice idx protect block fetcher int slice idx current slice idx slice idx return smallest key select current column slice protect byte buffer current start return revers slice current slice idx finish slice current slice idx start return biggest key select current column slice protect byte buffer current finish return revers slice current slice idx start slice current slice idx finish protect abstract boolean set slice protect abstract boolean fetch data protect boolean column befor slice start disk atom column return befor slice start column protect boolean befor slice start byte buffer byte buffer start current start return start remain compar compar start protect boolean column befor slice finish disk atom column byte buffer finish current finish return finish remain compar compar column finish protect boolean slice finish byte buffer byte buffer finish current finish return finish remain compar compar finish privat class index block fetcher extend block fetcher row start privat final long base posit index entri block deseri privat int index idx index block read disk privat int deseri block revers column deseri block match slice privat final dequ disk atom prefetch public index block fetcher long base posit super base posit base posit prefetch revers array dequ disk atom null set slice protect boolean set slice current slice idx slice length index idx index helper index slice current slice idx start index compar revers index idx index idx index idx index size index block slice continu check exclud slice entir index index info info index index idx revers befor slice start info return true els slice finish info return true index idx return fals protect boolean slice return current slice idx slice length protect boolean fetch data slice return fals read block revers disk order column previous block handl note prefetch column revers disk order revers prefetch empti boolean fals avoid comparison boolean slice fals disk atom prefetch col prefetch col prefetch peek null col befor slice updat slice column befor slice start prefetch col slice fals set slice return fals col slice column revers slice check slice chang slice els slice column befor slice finish prefetch col block column add prefetch poll true slice true col slice ignor els prefetch poll return true tri return block catch throw corrupt tabl file path privat boolean block throw deseri block index idx revers index idx els index idx deseri block index idx deseri block deseri block index size return fals index info current index index deseri block seek correct offset data calcul data size long posit seek base posit current index offset promot index seek data file happen point file null file origin input null sstabl file data input posit seek origin input disk atom serial atom serial empti column famili disk serial file seek posit seek file mark mark file mark remenb whithin slice avoid comparison boolean slice fals scan index start disk atom column null file byte mark mark current index width onli fetch column haven dealt previous column null column atom serial deseri tabl file sstabl descriptor version col befor slice slice don bother check chang slice slice column befor slice start column revers slice select column befor current match column prefetch add column column null col slice els column befor slice finish column slice true add column column column null col slice els read hit column sort current slice slice revers current slice read previous index block howev case current slice column block part current slice column prefetch revers prefetch empti break set slice break slice fals index block correspond block column newli set slice differ current block block case prefetch column won match index idx deseri block revers prefetch clear break slice column block revers column prefetch block revers break otherwis deal column iter return true privat class simpl block fetcher extend block fetcher public simpl block fetcher throw sinc deseri order read slice revers slice behav revers super revers slice length remenb whithin slice avoid comparison boolean slice fals disk atom serial atom serial empti column famili disk serial int column file read int int column disk atom column atom serial deseri tabl file sstabl descriptor version col befor slice slice don bother check chang slice slice column befor slice start column continu col slice column befor slice finish column slice true add column column col slice slice els slice fals set slice break protect boolean set slice revers current slice idx return fals current slice idx els current slice idx slice length return fals current slice idx return true protect boolean fetch data return fals 