packag org apach cassandra hadoop licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util array list import java util hash map import java util list import java util map import org apach cassandra compress compress paramet import org slf logger import org slf logger factori import org apach cassandra configur import org apach cassandra dht partition import org apach cassandra thrift import org apach cassandra util util import org apach cassandra util hex import org apach hadoop conf configur import org apach thrift base import org apach thrift deseri import org apach thrift import org apach thrift serial import org apach thrift transport socket import org apach thrift transport transport import org apach thrift transport transport import javax secur auth login login public class config helper privat static final string cassandra input partition class privat static final string cassandra output partition class privat static final string cassandra input keyspac privat static final string cassandra output keyspac privat static final string cassandra input keyspac usernam privat static final string cassandra input keyspac passwd privat static final string cassandra output keyspac usernam privat static final string cassandra output keyspac passwd privat static final string cassandra input columnfamili privat static final string mapreduc output basenam output format privat static final string cassandra input predic privat static final string cassandra input key rang privat static final string cassandra input split size privat static final string cassandra input widerow privat static final int privat static final string cassandra rang batch size privat static final int privat static final string cassandra input thrift port privat static final string cassandra output thrift port privat static final string cassandra input thrift address privat static final string cassandra output thrift address privat static final string cassandra consistencylevel read privat static final string cassandra consistencylevel write privat static final string cassandra output compress class privat static final string cassandra output compress length privat static final string cassandra input transport factori class privat static final string cassandra output transport factori class privat static final logger logger logger factori logger config helper class set keyspac column famili input job param conf job configur run param keyspac param column famili param widerow public static void set input column famili configur conf string keyspac string column famili boolean widerow keyspac null throw unsupport oper keyspac null column famili null throw unsupport oper columnfamili null conf set keyspac conf set column famili conf set string valu widerow set keyspac column famili input job param conf job configur run param keyspac param column famili public static void set input column famili configur conf string keyspac string column famili set input column famili conf keyspac column famili fals set keyspac output job param conf job configur run param keyspac public static void set output keyspac configur conf string keyspac keyspac null throw unsupport oper keyspac null conf set keyspac set column famili output job param conf job configur run param column famili public static void set output column famili configur conf string column famili conf set column famili set column famili output job param conf job configur run param keyspac param column famili public static void set output column famili configur conf string keyspac string column famili set output keyspac conf keyspac set output column famili conf column famili number row request rang slice request big timeout cassandra long fetch data small perform eaten overhead request param conf job configur run param batchsiz number row request time public static void set rang batch size configur conf int batchsiz conf set int batchsiz number row request rang slice request big timeout cassandra long fetch data small perform eaten overhead request param conf job configur run return number row request time public static int rang batch size configur conf return conf int set size input split affect number map creat number small overhead map bulk job time param conf job configur run param splitsiz size input split public static void set input split size configur conf int splitsiz conf set int splitsiz public static int input split size configur conf return conf int set predic determin column select row param conf job configur run param predic public static void set input slice predic configur conf slice predic predic conf set thrift string predic public static slice predic input slice predic configur conf string conf return null null predic string privat static string thrift string base object assert object null aw kind cool serial serial serial binari protocol factori tri return hex byte hex serial serial object catch throw runtim privat static slice predic predic string string assert null deseri deseri deseri binari protocol factori slice predic predic slice predic tri deseri deseri predic hex hex byte catch throw runtim return predic set key rang limit row param conf job configur run public static void set input rang configur conf string start token string token key rang rang key rang set start token start token set token token conf set thrift string rang set key rang limit row param conf job configur run public static void set input rang configur conf string start token string token list index express filter key rang rang key rang set start token start token set token token set row filter filter conf set thrift string rang set key rang limit row param conf job configur run public static void set input rang configur conf list index express filter key rang rang key rang set row filter filter conf set thrift string rang null unset public static key rang input key rang configur conf string str conf return str null null key rang string str privat static key rang key rang string string assert null deseri deseri deseri binari protocol factori key rang key rang key rang tri deseri deseri key rang hex hex byte catch throw runtim return key rang public static string input keyspac configur conf return conf public static string output keyspac configur conf return conf public static void set input keyspac user password configur conf string usernam string password set input keyspac user conf usernam set input keyspac password conf password public static void set input keyspac user configur conf string usernam conf set usernam public static string input keyspac user configur conf return conf public static void set input keyspac password configur conf string password conf set password public static string input keyspac password configur conf return conf public static void set output keyspac user password configur conf string usernam string password set output keyspac user conf usernam set output keyspac password conf password public static void set output keyspac user configur conf string usernam conf set usernam public static string output keyspac user configur conf return conf public static void set output keyspac password configur conf string password conf set password public static string output keyspac password configur conf return conf public static string input column famili configur conf return conf public static string output column famili configur conf conf null return conf els throw unsupport oper set output column famili set output column famili ad output multipl output public static boolean input wide configur conf return boolean pars boolean conf public static string read consist level configur conf return conf public static string write consist level configur conf return conf public static int input rpc port configur conf return integ pars int conf public static void set input rpc port configur conf string port conf set port public static string input initi address configur conf return conf public static void set input initi address configur conf string address conf set address public static void set input partition configur conf string classnam conf set classnam public static partition input partition configur conf tri return util partition conf catch configur throw runtim public static int output rpc port configur conf return integ pars int conf public static void set output rpc port configur conf string port conf set port public static string output initi address configur conf return conf public static void set output initi address configur conf string address conf set address public static void set output partition configur conf string classnam conf set classnam public static partition output partition configur conf tri return util partition conf catch configur throw runtim public static string output compress class configur conf return conf public static string output compress chunk length configur conf return conf string valu compress paramet public static void set output compress class configur conf string classnam conf set classnam public static void set output compress chunk length configur conf string length conf set length public static compress paramet output compress paramat configur conf output compress class conf null return compress paramet null map string string option hash map string string option put compress paramet output compress class conf option put compress paramet output compress chunk length conf tri return compress paramet creat option catch configur throw runtim public static cassandra client client input address list configur conf throw return client address list conf config helper input initi address conf split config helper input rpc port conf public static cassandra client client output address list configur conf throw return client address list conf config helper output initi address conf split config helper output rpc port conf privat static cassandra client client address list configur conf string address int port throw cassandra client client null list array list string address address tri client creat connect conf address port break catch ioe add ioe client null logger error fail connect ani initi address ioe logger error ioe throw size return client public static cassandra client creat connect configur conf string host integ port throw tri socket socket socket host port transport transport input transport factori conf open transport socket return cassandra client binari protocol transport catch login throw unabl login server host port catch transport throw unabl connect server host port public static transport factori input transport factori configur conf return transport factori conf frame transport factori class public static void set input transport factori class configur conf string classnam conf set classnam public static transport factori output transport factori configur conf return transport factori conf frame transport factori class public static void set output transport factori class configur conf string classnam conf set classnam privat static transport factori transport factori string factori class tri return transport factori class factori class instanc catch throw runtim fail instanti transport factori factori class 