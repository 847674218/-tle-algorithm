licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra hadoop import java import java nio byte buffer import java util hash map import java util list import java util map import org slf logger import org slf logger factori import org apach cassandra auth authent import org apach cassandra thrift import org apach hadoop conf configur import org apach hadoop mapreduc import org apach thrift import org apach thrift transport socket import org apach thrift transport transport import javax secur auth login login code column famili output format code act hadoop specif output format reduc task store key correspond valu cassandra row respect column column famili case link column famili input format set keyspac column famili hadoop job configur link config helper class link config helper set output column famili method provid simpl sake perform class employ lazi write cach mechan record writer batch mutat creat base reduc input task specif map period chang offici send batch mutat request cassandra public class column famili output format extend output format byte buffer list mutat implement org apach hadoop mapr output format byte buffer list mutat public static final string mapreduc output columnfamilyoutputformat batch threshold public static final string mapreduc output columnfamilyoutputformat queue size privat static final logger logger logger factori logger column famili output format class check valid output specif job param context inform job throw output attempt overrid public void check output spec job context context check output spec context configur privat void check output spec configur conf config helper output keyspac conf null throw unsupport oper set keyspac set output keyspac config helper output partition conf null throw unsupport oper set output partition cassandra cluster config helper output initi address conf null throw unsupport oper set initi output address cassandra node output committ format doe write ani data param context task context return output committ throw throw interrupt overrid public output committ output committ task attempt context context throw interrupt return null output committ fill deprec output format interfac stream deprec public void check output spec org apach hadoop file system filesystem org apach hadoop mapr job conf job throw check output spec job fill deprec output format interfac stream deprec overrid public column famili record writer record writer org apach hadoop file system filesystem org apach hadoop mapr job conf job string org apach hadoop util progress progress throw return column famili record writer job progress progress link record writer task param context inform current task return link record writer write output job throw overrid public column famili record writer record writer final task attempt context context throw interrupt return column famili record writer context return client base socket point configur keyspac log configur credenti param socket socket point node seed otherwis param conf job configur return cassandra client throw invalid request throw throw authent throw author public static cassandra client creat authent client socket socket configur conf throw invalid request authent author login logger debug creat authent client output format transport transport config helper output transport factori conf open transport socket binari protocol binari protocol binari protocol transport cassandra client client cassandra client binari protocol client set keyspac config helper output keyspac conf config helper output keyspac user conf null map string string cred hash map string string cred put authent config helper output keyspac user conf cred put authent config helper output keyspac password conf authent request auth request authent request cred client login auth request logger debug authent client output format creat success return client link output committ doe noth public static class null output committ extend output committ public void abort task task attempt context task context public void cleanup job job context job context public void commit task task attempt context task context public boolean task commit task attempt context task context return fals public void setup job job context job context public void setup task task attempt context task context 