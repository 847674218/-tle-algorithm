licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra tool import static org apach cassandra util byte buffer util hex byte import java file import java import java nio byte buffer import java util list import java util map import java util sort map import java util tree map import org apach common cli command line import org apach common cli command line parser import org apach common cli option import org apach common cli option import org apach common cli pars import org apach common cli posix parser import org apach cassandra config meta data import org apach cassandra configur import org apach cassandra config databas descriptor import org apach cassandra config schema import org apach cassandra abstract column import org apach cassandra column famili import org apach cassandra column famili type import org apach cassandra counter column import org apach cassandra decor key import org apach cassandra delet info import org apach cassandra expir column import org apach cassandra rang tombston import org apach cassandra super column import org apach cassandra filter queri path import org apach cassandra marshal abstract type import org apach cassandra marshal byte type import org apach cassandra marshal marshal import org apach cassandra dht partition import org apach cassandra sstabl tabl writer import org apach cassandra util byte buffer util import org codehaus jackson json factori import org codehaus jackson json parser import org codehaus jackson json token import org codehaus jackson map map json factori import org codehaus jackson type type refer creat tabl input public class tabl import privat static final string privat static final string privat static final string privat static final string privat static final option option option privat static command line cmd privat integ key count import privat final boolean sort privat static final json factori factori map json factori configur json parser featur fals static option opt keyspac option true keyspac opt keyspac set requir true option add option opt keyspac option opt colfamili option true column famili opt colfamili set requir true option add option opt colfamili option add option option true number key import option option add option option fals assum file alreadi sort creat sstabl json tool option privat static class json column privat byte buffer privat byte buffer valu privat long timestamp privat string kind expir column privat int ttl privat int local expir time counter column privat long timestamp delet public json column json meta data meta boolean column json instanceof list abstract type compar column meta subcolumn compar meta compar list field list json assert field size column definit string type string field compar timestamp long field kind field size field instanceof boolean format read compat sake field size kind ttl integ field local expir time integ field els kind boolean field els kind string field expir ttl integ field local expir time integ field els counter timestamp delet long integ field els rang tombston local expir time integ field valu delet byte buffer util hex byte string field string type string field meta valu valid duplic public boolean delet return kind equal public boolean expir return kind equal public boolean counter return kind equal public boolean rang tombston return kind equal public byte buffer return duplic public byte buffer valu return valu duplic public tabl import null fals public tabl import boolean sort null sort public tabl import integ key count import boolean sort key count import key count import sort sort privat void add standard list row column famili cfamili add column row null cfamili add column column famili param row column associ row param super super column ani param cfamili column famili add column privat void add column list row byte buffer super column famili cfamili meta data cfm cfamili metadata assert cfm null object row json column col json column list list cfm super null queri path path queri path cfm super col col expir cfamili add column null expir column col col valu col timestamp col ttl col local expir time els col counter cfamili add column null counter column col col valu col timestamp col timestamp delet els col delet cfamili add tombston path col valu col timestamp els col rang tombston cfamili add atom rang tombston col col valu col timestamp col local expir time els cfamili add column path col valu col timestamp privat void pars meta map map abstract column column delet info onli metadata store map key delet info map unpars delet info map map delet info number number number unpars delet info mark delet long mark delet number instanceof long long number integ number long valu int local delet time integ unpars delet info local delet time column set delet info delet info mark delet local delet time add super column column famili param row super column associ row param cfamili column famili add column privat void add super map row column famili cfamili meta data meta data cfamili metadata assert meta data null abstract type compar meta data compar super column map entri entri row entri set map data map entri valu byte buffer super string type string entri key compar add column list data column super cfamili data key metadata pars meta map data metadata super column cfamili column super convert format file tabl param json file file format data param keyspac keyspac data belong param column famili data belong param tabl path file write tabl throw error read write input output public int import json string json file string keyspac string string tabl path throw column famili column famili column famili creat keyspac partition partition databas descriptor partition int import key sort import sort json file column famili tabl path partition import unsort json file column famili tabl path partition import key system printf key import success import key return import key privat int import unsort string json file column famili column famili string tabl path partition partition throw int import key long start system current time milli json parser parser parser json file object data parser read valu type refer object key count import key count import null data length key count import tabl writer writer tabl writer tabl path key count import system printf import key key count import sort represent hold hex version sort map decor key map decor key tree map decor key map object row data map row map map row decor key put partition decor key hex byte string row map key row map map entri decor key map row decor key entri set row valu key metadata pars meta map row valu metadata column famili object column row valu column column famili type column famili type super add super map column column famili els add standard list column column famili writer append row key column famili column famili clear readi column famili row sinc read delet info metadata column famili delet delet info import key long current system current time milli current start sec system printf current import key import key start current key count import import key break writer close open reader return import key privat int import sort string json file column famili column famili string tabl path partition partition throw int import key alreadi import key count long start system current time milli json parser parser parser json file key count import null key count import system println count key import pleas wait skip num key parser token parser token null parser skip children parser current token json token break key count import system printf import key key count import parser parser json file renew parser tabl writer writer tabl writer tabl path key count import int line number decor key prev store key null parser token parser token null string key parser current map row parser read valu type refer map decor key current key partition decor key hex byte string row key row key metadata pars meta map row metadata column famili column famili type column famili type super add super map row column column famili els add standard list row column column famili prev store key null prev store key compar current key system err printf line key greater previous collect sort proper abort import delet tabl manual line number key return save decor key writer append current key column famili column famili clear prev store key current key import key line number long current system current time milli current start sec system printf current import key import key start current key count import import key break writer close open reader return import key json parser object file param file file return json parser instanc file throw ani error privat json parser parser string file throw return factori creat json parser file file convert tabl file input file specifi option command line argument suppli standard param arg command line argument throw failur open read write file output stream throw pars failur pars input throw configur configur error public static void main string arg throw pars configur command line parser parser posix parser tri cmd parser pars option arg catch org apach common cli pars system err println messag print program usag system exit cmd arg length print program usag system exit string json cmd arg string tabl cmd arg string keyspac cmd option valu string cfamili cmd option valu integ key count import null boolean sort fals cmd option key count import integ valu cmd option valu cmd option sort true databas descriptor load schema schema instanc system tabl size string msg system tabl defin system err println msg throw configur msg tri tabl import key count import sort import json json keyspac cfamili tabl catch print stack trace system err println messag system exit system exit privat static void print program usag system printf usag keyspac column famili num key json sstabl tabl import class system println option object option option option opt option system println opt opt opt descript convert string byte byte buffer accord type param content string convert param type type convers return byte buffer represent string privat static byte buffer string type string content abstract type type tri return type byte type instanc hex byte content type string content catch marshal throw runtim messag 