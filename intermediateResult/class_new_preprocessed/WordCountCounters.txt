licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util import org slf logger import org slf logger factori import org apach hadoop conf configur import org apach hadoop conf configur import org apach hadoop path import org apach hadoop text import org apach hadoop long writabl import org apach hadoop mapreduc job import org apach hadoop mapreduc mapper import org apach hadoop mapreduc lib output file output format import org apach hadoop util tool import org apach hadoop util tool runner import org apach cassandra column import org apach cassandra hadoop column famili input format import org apach cassandra hadoop config helper import org apach cassandra thrift import org apach cassandra util byte buffer util sum word count store input word count column famili key key vers output written text file public class word count counter extend configur implement tool privat static final logger logger logger factori logger word count counter class static final string input word count privat static final string tmp word count counter public static void main string arg throw tool runner handl generic command line option tool runner run configur word count counter arg system exit public static class sum mapper extend mapper byte buffer sort map byte buffer column text long writabl public void map byte buffer key sort map byte buffer column column context context throw interrupt long sum column column column valu logger debug read key column context input split sum byte buffer util long column valu context write text byte buffer util string key long writabl sum public int run string arg throw job job job conf wordcountcount job set jar class word count counter class job set mapper class sum mapper class job set output key class text class job set output valu class long writabl class file output format set output path job path job set input format class column famili input format class config helper set input rpc port job configur config helper set input initi address job configur localhost config helper set input partition job configur org apach cassandra dht murmur partition config helper set input column famili job configur word count word count counter slice predic predic slice predic set slice rang slice rang set start byte buffer util set finish byte buffer util set count config helper set input slice predic job configur predic job wait complet true return 