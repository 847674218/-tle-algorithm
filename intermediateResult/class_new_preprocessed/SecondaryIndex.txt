licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra index import java nio byte buffer import java util import java util concurr import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra config meta data import org apach cassandra config column definit import org apach cassandra configur import org apach cassandra column famili store import org apach cassandra decor key import org apach cassandra system tabl import org apach cassandra compact compact manag import org apach cassandra index key key index import org apach cassandra index composit composit index import org apach cassandra marshal abstract type import org apach cassandra marshal byte type import org apach cassandra marshal composit type import org apach cassandra marshal local partion type import org apach cassandra dht import org apach cassandra sstabl reduc key iter import org apach cassandra sstabl tabl reader import org apach cassandra thrift column import org apach cassandra servic storag servic abstract base class differ type secondari index extend direct pleas pick column secondari index row secondari index public abstract class secondari index protect static final logger logger logger factori logger secondari index class public static final string class base mani index protect column famili store base cfs column definit index respons protect final set column definit column def collect set map concurr hash map column definit boolean perform ani initi work public abstract void init reload exist index follow chang configur index column differ init expect expect resourc index creat init public abstract void reload valid index option pass column def throw configur public abstract void valid option throw configur return index abstract public string index return uniqu index column store system tabl track column built param column column return uniqu abstract public string system tabl byte buffer column check index specifi column fulli built param column column return true index fulli built public boolean index built byte buffer column return system tabl index built base cfs tabl system tabl column public void set index built column definit column def column def system tabl set index built base cfs tabl system tabl column def public void set index remov column definit column def column def system tabl set index remov base cfs tabl system tabl column def call queri time creat implement specif searcher instanc index type param column list column belong index type return secondari index search impl protect abstract secondari index searcher creat secondari index searcher set byte buffer column forc index memori data disk public abstract void forc block flush current amount memori index consum byte public abstract long live size access column famili store return column famili store null public abstract column famili store index cfs delet file refer index param column index column remov public abstract void remov index byte buffer column remov index unregist index mbean exist public abstract void invalid truncat data current index param truncat truncat timestamp data befor timestamp reject public abstract void truncat long truncat build index data block complet protect void build index block logger info string format submit index build data index string util join base cfs tabl collect tabl reader sstabl base cfs mark current tabl referenc secondari index builder builder secondari index builder base cfs collect singleton index reduc key iter sstabl futur futur compact manag instanc submit index build builder tri futur forc block flush set index built catch interrupt throw assert error catch execut throw runtim final tabl reader releas refer sstabl logger info index build index complet build index data block return futur object caller block option public futur build index async link index index column alreadi built index post restart boolean built true column definit cdef column def system tabl index built base cfs tabl system tabl cdef built fals break built return null build asynchron add index call open schema updat block long period actual build serial compact manag runnabl runnabl runnabl public void run tri base cfs forc block flush build index block catch execut throw runtim catch interrupt throw assert error futur task futur task object runnabl null thread creat index index start return public column famili store base cfs return base cfs privat void set base cfs column famili store base cfs base cfs base cfs public set column definit column def return column def void add column def column definit column def column def add column def void remov column def byte buffer iter column definit column def iter equal remov return decor key column valu param valu column valu return decor key public decor key index key byte buffer valu impli column definit index byte buffer column def iter return decor key local token base cfs metadata column definit valid valu valu return true provid column index secondari index default implement check column def overriden subclass public boolean index byte buffer column definit column def column def base cfs compar compar column def return true return fals primari creat secondari index instanc column valid index option befor initi param base cfs sourc data index param cdef meta inform column index type index option return secondari index instanc column throw configur public static secondari index creat instanc column famili store base cfs column definit cdef throw configur secondari index index switch cdef index type case index key index break case index composit index break case assert cdef index option null string class cdef index option assert class null tri index secondari index class class instanc catch throw runtim break default throw runtim unknown index type cdef index index add column def cdef index valid option index set base cfs base cfs return index public abstract boolean valid column column return index compar index null note cleaner member method howev open index sstabl won fulli initi secondari index object won access public static abstract type index compar meta data base metadata column definit cdef partition row partition storag servic partition abstract type key compar row partition instanceof order preserv partition row partition instanceof byte order partition byte type instanc local partion type row partition switch cdef index type case return key compar case assert base metadata compar instanceof composit type int prefix size tri prefix size integ pars int cdef index option composit index catch number format shouldn happen valid correct throw runtim list abstract type type array list abstract type prefix size type add key compar int prefix size type add composit type base metadata compar type return composit type instanc type case return null throw assert error 