licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra gms import java net inet address import java util import org slf logger import org slf logger factori import org apach cassandra config databas descriptor import org apach cassandra net verb handler import org apach cassandra net messag import org apach cassandra net messag import org apach cassandra net messag servic public class gossip digest syn verb handler implement verb handler gossip digest syn privat static final logger logger logger factori logger gossip digest syn verb handler class public void verb messag gossip digest syn messag string inet address messag logger trace enabl logger trace receiv gossip digest syn messag gossip instanc enabl logger trace enabl logger trace ignor gossip digest syn messag becaus gossip disabl return gossip digest syn digest messag messag payload messag differ cluster throw digest messag cluster equal databas descriptor cluster logger warn cluster mismatch digest messag cluster databas descriptor cluster return digest messag partion null digest messag partion equal databas descriptor partition logger warn partition mismatch digest messag partion databas descriptor partition return list gossip digest digest list digest messag gossip digest logger trace enabl string builder string builder gossip digest digest digest list append digest append logger trace gossip syn digest string sort digest list list gossip digest delta gossip digest list array list gossip digest map inet address endpoint state delta state map hash map inet address endpoint state gossip instanc examin gossip digest list delta gossip digest list delta state map messag gossip digest ack digest ack messag messag gossip digest ack messag servic verb gossip digest ack delta gossip digest list delta state map gossip digest ack serial logger trace enabl logger trace send gossip digest ack messag messag servic instanc send digest ack messag construct map key endpoint gossip digest valu gossip digest build list version differ differ version gossip digest version local state inet address sort list loop sort list retriev gossip digest correspond endpoint map initi construct privat void sort list gossip digest digest list construct map endpoint gossip digest map inet address gossip digest digest map hash map inet address gossip digest gossip digest digest digest list digest map put digest endpoint digest digest max version set differ version local endpoint state version gossip digest list gossip digest diff digest array list gossip digest digest list size gossip digest digest digest list inet address digest endpoint endpoint state state gossip instanc endpoint state endpoint int version state null gossip instanc max endpoint state version state int diff version math ab version digest max version diff digest add gossip digest digest generat diff version digest list clear collect sort diff digest int size diff digest size report digest descend order care endpoint local endpoint int size digest list add digest map diff digest endpoint 