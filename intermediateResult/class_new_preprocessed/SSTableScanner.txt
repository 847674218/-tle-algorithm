licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java import java util array import java util iter import org apach cassandra decor key import org apach cassandra row index entri import org apach cassandra row posit import org apach cassandra columniter column iter factori import org apach cassandra columniter lazi column iter import org apach cassandra columniter disk atom iter import org apach cassandra compact compact scanner import org apach cassandra filter queri filter import org apach cassandra util file util import org apach cassandra util random access reader import org apach cassandra util byte buffer util public class tabl scanner implement compact scanner protect final random access reader dfile protect final random access reader ifil public final tabl reader sstabl privat disk atom iter row protect boolean exhaust fals protect iter disk atom iter iter privat final queri filter filter param sstabl tabl scan tabl scanner tabl reader sstabl boolean skip cach dfile sstabl open data reader skip cach ifil sstabl open index reader skip cach sstabl sstabl filter null param sstabl tabl scan param filter filter scan column tabl scanner tabl reader sstabl queri filter filter dfile sstabl open data reader fals ifil sstabl open index reader fals sstabl sstabl filter filter public void close throw file util close dfile ifil public void seek row posit seek key tri long index posit sstabl index scan posit seek key key befor everyth sstabl start index posit index posit ifil seek index posit ifil long start posit ifil file pointer decor key index decor key sstabl decod key byte buffer util read short length ifil int comparison index decor key compar seek key comparison read data posit seek index data file long data posit ifil read long ifil seek start posit dfile seek data posit row null return els row index entri serial skip ifil sstabl descriptor version exhaust true catch sstabl mark suspect throw corrupt tabl ifil path public long length byte return dfile length public long current posit return dfile file pointer public string file return sstabl string public boolean iter null iter exhaust array list disk atom iter iter creat iter return iter public disk atom iter iter null iter exhaust array list disk atom iter iter creat iter return iter public void remov throw unsupport oper privat iter disk atom iter creat iter return filter null key scan iter filter key scan iter protect class key scan iter implement iter disk atom iter protect long finish public boolean row null return dfile return finish dfile length public disk atom iter tri row null dfile seek finish assert dfile read data header decor key key sstabl decod key byte buffer util read short length dfile long data size tabl reader read row size dfile sstabl descriptor long data start dfile file pointer finish data start data size row tabl ident iter sstabl dfile key data start data size return row catch sstabl mark suspect throw corrupt tabl dfile path public void remov throw unsupport oper overrid public string string return class simpl finish finish protect class filter key scan iter implement iter disk atom iter protect decor key key protect row index entri entri public boolean row null return ifil return key null public disk atom iter tri final decor key current key final row index entri current entri row null current key sstabl decod key byte buffer util read short length ifil current entri row index entri serial deseri ifil sstabl descriptor version els current key key current entri entri ifil key null entri null els key sstabl decod key byte buffer util read short length ifil entri row index entri serial deseri ifil sstabl descriptor version assert dfile return row lazi column iter current key column iter factori public disk atom iter creat return filter tabl column iter sstabl dfile current key current entri catch sstabl mark suspect throw corrupt tabl ifil path public void remov throw unsupport oper overrid public string string return class simpl dfile dfile ifil ifil sstabl sstabl exhaust exhaust 