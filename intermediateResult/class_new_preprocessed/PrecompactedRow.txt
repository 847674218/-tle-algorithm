licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra compact import java data output import java import java secur messag digest import java util list import googl common base function import org apach cassandra import org apach cassandra index secondari index manag import org apach cassandra sstabl column stat import org apach cassandra sstabl tabl ident iter import org apach cassandra util data output buffer import org apach cassandra util heap alloc precompact row merg row constructor memori public class precompact row extend abstract compact row privat final column famili compact privat column index column index caller respons call remov delet remov shard befor call constructor public precompact row decor key key column famili super key compact public static column famili remov delet shard decor key key compact control control column famili assert key null assert control null assert null avoid call purg actual veri expens hundr overlap sstabl essenti method ugli refactor remov delet shard control purg key control account boolean purg null irrelev data control befor purg control purg key max timestamp onli tombston purg true otherwis collect column shadow delet remov delet integ column famili compact column famili store remov delet purg null purg control befor integ compact null compact metadata default valid commut purg null purg control purg key delet info max timestamp purg counter column merg remov shard key compact control befor control merg shard befor return compact public static column famili remov delet shard decor key key boolean purg compact control control column famili comment preced method column famili compact column famili store remov delet purg control befor integ control cfs index manag updat key fals purg compact null compact metadata default valid commut counter column merg remov shard key compact control befor control merg shard befor return compact public precompact row compact control control list tabl ident iter row row key remov delet shard row key control merg row control privat static column famili merg list tabl ident iter row compact control control assert row empti column famili null secondari index manag updat index null tabl ident iter row row column famili tri map onc sinc merg sort column factori factori null tree map sort column factori array sort column factori row column famili column factori catch throw runtim fail merg row row key row key null index control cfs index manag updat row key fals onli init index onc els add array sort column add size delta heap alloc instanc function column ident index return public long write data output throw assert compact null data output buffer buffer data output buffer column index builder builder column index builder compact key key compact column count buffer column index builder build compact type size type size type size long del size delet time serial serial size compact delet info top level delet type size long data size buffer length del size type size sizeof write long data size delet info serial serial tabl compact delet info write int builder written atom count write buffer data buffer length return data size public void updat messag digest digest assert compact null data output buffer buffer data output buffer tri delet info serial serial tabl compact delet info buffer buffer write int compact column count digest updat buffer data buffer length catch throw runtim compact updat digest digest public boolean empti return compact null public column stat column stat return compact column stat return full column famili repres compact row provid method abstract compact row becaus fit row memori don sens implement public column famili full column famili return compact public delet info delet info return compact delet info return column index row public column index index return column index public void close 