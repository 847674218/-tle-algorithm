licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java file import java filenam filter import java import java nio byte buffer import java util hash set import java util set import org apach cassandra config meta data import org apach cassandra config databas descriptor import org apach cassandra import org apach cassandra context counter context import org apach cassandra dht partition import org apach cassandra util counter import org apach cassandra util pair public abstract class abstract tabl simpl writer protect final file directori protect final meta data metadata protect decor key current key protect column famili column famili protect super column current super column protect final counter counterid counter generat public abstract tabl simpl writer file directori meta data metadata partition partition metadata metadata directori directori databas descriptor set partition partition protect tabl writer writer return tabl writer filenam directori metadata metadata don care bloom filter metadata databas descriptor partition tabl metadata creat collector find avail generat pick filenam privat static string filenam file directori final string keyspac final string column famili final set descriptor exist hash set descriptor directori list filenam filter public boolean accept file dir string pair descriptor compon tabl tri compon filenam dir descriptor desc null null left desc null return fals desc cfname equal column famili exist add desc return fals int max gen descriptor desc exist max gen math max max gen desc generat return descriptor directori keyspac column famili max gen true filenam compon start row key code key param key row key public void row byte buffer key throw current key null column famili empti write row current key column famili current key databas descriptor partition decor key key column famili column famili start super column code param super column public void super column byte buffer column famili super throw illeg state add super column standard column famili current super column super column metadata subcolumn compar column famili add column current super column privat void add column column column column famili super current super column null throw illeg state tri add column super column famili super column start column column famili super current super column column famili add column column insert regular column current row super column applic param column param valu column valu param timestamp column timestamp public void add column byte buffer byte buffer valu long timestamp add column column valu timestamp insert expir column current row super column applic param column param valu column valu param timestamp column timestamp param ttl column time live param expir timestamp local expir timestamp millisecond server time timestamp actual expir column consequ synchron cassandra server time code timestamp repres insert time microsecond requir code timestamp ttl public void add expir column byte buffer byte buffer valu long timestamp int ttl long expir timestamp add column expir column valu timestamp ttl int expir timestamp insert counter column current row super column applic param column param valu valu counter public void add counter column byte buffer long valu add column counter column counter context instanc creat counterid valu fals system current time milli close writer method call otherwis produc sstabl guarante complet won practic public abstract void close throw protect abstract void write row decor key key column famili column famili throw protect abstract column famili column famili 