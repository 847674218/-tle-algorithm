licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra filter import java import java nio byte buffer import java util import googl common collect abstract iter import googl common collect list import org slf logger import org slf logger factori import org apach cassandra import org apach cassandra columniter disk atom iter import org apach cassandra columniter tabl column iter import org apach cassandra columniter tabl slice iter import org apach cassandra marshal abstract type import org apach cassandra marshal composit type import org apach cassandra version serial import org apach cassandra sstabl tabl reader import org apach cassandra util file data input import org apach cassandra net messag servic import org apach cassandra trace trace public class slice queri filter implement disk atom filter privat static final logger logger logger factori logger slice queri filter class public static final serial serial serial public final column slice slice public final boolean revers public volatil int count privat final int composit group hack roll upgrad pre node privat final int count mutlipli compat serial ack rang slice find number live column count group privat column counter column counter public slice queri filter byte buffer start byte buffer finish boolean revers int count column slice column slice start finish revers count public slice queri filter byte buffer start byte buffer finish boolean revers int count int composit group column slice column slice start finish revers count composit group constructor accept multipl slice slice assum direct revers public slice queri filter column slice slice boolean revers int count slice revers count public slice queri filter column slice slice boolean revers int count int composit group int count mutlipli compat slice slice revers revers count count composit group composit group count mutlipli compat count mutlipli compat public slice queri filter updat count int count return slice queri filter slice revers count composit group count mutlipli compat public slice queri filter updat slice column slice slice return slice queri filter slice revers count composit group count mutlipli compat public disk atom iter memtabl column iter column famili decor key key return memtabl slice iter key public tabl column iter tabl column iter tabl reader sstabl decor key key return tabl slice iter sstabl key slice revers public tabl column iter tabl column iter tabl reader sstabl file data input file decor key key row index entri index entri return tabl slice iter sstabl file key slice revers index entri public super column filter super column super column super column int befor clone shallow add theori general interest relat small number subcolumn poor assumpt super column filter super column clone shallow final iter column subcolumn revers list column column list array list column super column column subcolumn list revers column list iter els subcolumn super column column iter final compar byte buffer compar revers super column compar revers compar super column compar iter column result abstract iter column protect column comput subcolumn column subcolumn subcolumn iter real start column compar compar subcolumn start continu exit loop column rang finish remain compar compar subcolumn finish break return subcolumn return data subcolumn empti redefin loop abov collect reduc column filter result befor return filter public compar column column compar abstract type compar return revers compar column revers compar compar column compar public void collect reduc column column iter column reduc column int befor column counter column counter reduc column column column reduc column logger trace enabl logger trace string format collect column counter live count column string compar column counter count column column counter live count break add abl column result read repair queri filter relev column befor add column column trace trace read live cell tombston column counter live column counter ignor public int live count column famili column counter counter column counter column column counter count column return counter live privat column counter column counter column abstract type compar compar composit group return column counter els composit group return column counter group prefix null els return column counter group prefix composit type compar composit group public void trim column famili int trim column counter counter column counter collect byte buffer remov null boolean trim remain fals collect column column revers revers sort column sort column column column column trim remain remov add column continu counter count column counter live trim remov hash set byte buffer remov add column trim remain true remov null byte buffer column remov remov column public byte buffer start return slice start public byte buffer finish return slice slice length finish public void set start byte buffer start assert slice length slice column slice start slice finish public int count return column counter null column counter live overrid public string string return slice queri filter revers revers slice array string slice count count group composit group public boolean revers return revers public void updat column limit int limit count limit public boolean includ compar byte buffer cmp byte buffer column slice slice slice slice includ cmp return true return fals public static class serial implement version serial slice queri filter public void serial slice queri filter data output dos int version throw version messag servic kind lame probabl throw column slice slice column slice start finish column slice serial serial slice dos version els dos write int slice length column slice slice slice column slice serial serial slice dos version dos write boolean revers int count count composit group version messag servic count count mutlipli compat dos write int count version messag servic return dos write int composit group public slice queri filter deseri data input dis int version throw column slice slice version messag servic slice column slice column slice serial deseri dis version els slice column slice dis read int int slice length slice column slice serial deseri dis version boolean revers dis read boolean int count dis read int int composit group version messag servic composit group dis read int return slice queri filter slice revers count composit group public long serial size slice queri filter int version type size size type size int size version messag servic size column slice serial serial size column slice start finish version els size size sizeof slice length column slice slice slice size column slice serial serial size slice version size size sizeof revers size size sizeof count version messag servic size size sizeof composit group return size 