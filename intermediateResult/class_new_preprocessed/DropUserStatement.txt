licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import org apach cassandra auth auth import org apach cassandra auth authent user import org apach cassandra config databas descriptor import org apach cassandra invalid request import org apach cassandra request execut import org apach cassandra unauthor import org apach cassandra servic client state import org apach cassandra transport messag result messag public class drop user statement extend authent statement privat final string usernam public drop user statement string usernam usernam usernam public void valid client state state throw invalid request auth exist user usernam throw invalid request string format user doesn exist usernam authent user user state user user null user equal usernam throw invalid request user aren themselv public void check access client state state throw unauthor state valid login state user super throw unauthor onli superus perfrom queri public result messag execut client state state throw invalid request request execut clean permiss drop user databas descriptor author revok usernam auth delet user usernam databas descriptor authent drop usernam return null 