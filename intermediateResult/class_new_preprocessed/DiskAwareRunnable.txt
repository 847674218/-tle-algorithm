licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java file import org apach cassandra directori import org apach cassandra util wrap runnabl public abstract class disk awar runnabl extend wrap runnabl run task select optim disk protect void run throw throw long write size directori data directori directori true write size expect write size directori directori locat capabl size write size directori null reduc scope limit space break directori null throw runtim insuffici disk space write write size byte directori current task increment directori estim work size add write size tri run directori locat final directori estim work size add write size directori current task decrement execut task code data directori param data directori data directori work protect abstract void run file data directori throw expect write size determin disk task return expect size byte task write disk public abstract long expect write size call disk avail free space full write size return true scope task success reduc public boolean reduc scope limit space return fals 