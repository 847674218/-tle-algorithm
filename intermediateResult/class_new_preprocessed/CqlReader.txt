packag org apach cassandra stress oper licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util array list import java util list import yammer metric core timer context import org apach cassandra column famili type import org apach cassandra stress session import org apach cassandra stress util cassandra client import org apach cassandra stress util oper import org apach cassandra thrift compress import org apach cassandra thrift cql result public class cql reader extend oper privat static string cql queri null public cql reader session client int idx super client idx public void run cassandra client client throw session column famili type column famili type super throw runtim super column implement cql queri null string builder queri string builder session column null session cql version start queri append append session column key append els queri append els int session column size queri append queri append queri append append wrap quot requir standard session cql version start queri append append session consist level string queri append cql queri queri string list string queri param array list string session column null int session column size queri param add quot cql blob session column array byte key generat key queri param add quot cql blob key string format queri null timer context context session latenc time boolean success fals string messag null int session retri time success break tri cql result result null session prepar statement integ stmnt prepar statement client cql queri session cql version start result client execut prepar cql queri stmnt queri param byte buffer queri param session consist level els result client execut prepar cql queri stmnt queri param byte buffer queri param els format queri null format queri format cql queri cql queri queri param session cql version start result client execut cql queri byte buffer wrap format queri byte compress session consist level els result client execut cql queri byte buffer wrap format queri byte compress success result row column size catch messag messag success fals success error string format oper retri time error read key queri index session retri time string key messag null messag cql queri session oper increment session key increment context stop 