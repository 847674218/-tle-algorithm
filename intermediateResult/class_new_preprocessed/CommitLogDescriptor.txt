licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra commitlog import java util regex matcher import java util regex pattern import org apach cassandra net messag servic public class commit log descriptor privat static final string privat static final string commit log privat static final string log match legaci version commitlog commit log log commit log log privat static final pattern pattern compil public static final int public static final int increment number chang commit log disc layout messag version chang note handl link messag version public static final int current version privat final int version public final long public commit log descriptor int version long version version public commit log descriptor long current version public static commit log descriptor file string matcher matcher matcher matcher match throw runtim pars version file matcher group null long long pars long matcher group split return commit log descriptor integ pars int matcher group els long long pars long matcher group return commit log descriptor public int messag version assert messag servic current version messag servic switch version case return messag servic case return messag servic default throw illeg state unknown commitlog version version public string file return version param filenam filenam check return true filenam commit log base filenam public static boolean valid string filenam return matcher filenam match 