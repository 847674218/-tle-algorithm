licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql oper import java nio byte buffer import java util collect import java util iter import java util list import java util set import org apach cassandra cql column builder import org apach cassandra cql column specif import org apach cassandra cql term import org apach cassandra cql updat paramet import org apach cassandra column famili import org apach cassandra column import org apach cassandra marshal abstract type import org apach cassandra marshal collect type import org apach cassandra marshal marshal import org apach cassandra marshal set type import org apach cassandra invalid request import org apach cassandra util byte buffer util import org apach cassandra util pair public class set oper implement oper enum kind privat final list term valu privat final kind kind privat set oper list term valu kind kind valu valu kind kind public void execut column famili column builder builder abstract type valid updat paramet param list pair byte buffer column list throw invalid request valid instanceof set type throw invalid request set oper onli support set type column valid switch kind case fallthrough purpos remov previous set befor set add atom param tombston overwrit builder copi build builder copi build rang case add builder collect type valid param break case discard builder collect type valid param break default throw assert error unsupport set oper kind public oper mayb convert empti map oper empti proper invalid queri parser hasn abl distinguish empti set empti map howev reject point duplic valid valu empti return switch kind case return map oper set collect term term empti map case return map oper put collect term term empti map return public static void set prepar column famili column builder builder set type valid term valu updat paramet param throw invalid request valu bind marker throw invalid request appli oper column valid type add atom param tombston overwrit builder copi build builder copi build rang add prepar builder valid valu param public static void add prepar column famili column builder builder set type valid term valu updat paramet param throw invalid request valu bind marker throw invalid request appli oper column valid type tri set valid compos param variabl valu bind index iter iter iter iter column builder iter builder copi builder byte buffer add valid compar decompos iter build add column param column byte buffer util catch marshal throw invalid request messag public static void discard prepar column famili column builder builder set type valid term valu updat paramet param throw invalid request valu bind marker throw invalid request appli oper column valid type tri set valid compos param variabl valu bind index iter iter iter iter column builder iter builder copi builder byte buffer add valid compar decompos iter build add column param tombston catch marshal throw invalid request messag privat void add column famili column builder builder collect type valid updat paramet param throw invalid request int valu size column builder valu size builder builder copi byte buffer add valu byte buffer valid compar param variabl build add column param column byte buffer util privat void discard column famili column builder builder collect type valid updat paramet param throw invalid request int valu size column builder valu size builder builder copi byte buffer add valu byte buffer valid compar param variabl build add column param tombston public void add bound column specif column column specif bound throw invalid request term valu bind marker bound bind index column public list term valu return valu public boolean requir read abstract type valid return fals public type type return type util method public static oper set list term valu return set oper valu kind public static oper add list term valu return set oper valu kind public static oper discard list term valu return set oper valu kind 