licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra filter import java data input import java data output import java import java nio byte buffer import java util compar import java util iter import java util sort set import java util tree set import org apach common lang string util import org apach cassandra import org apach cassandra columniter tabl column iter import org apach cassandra columniter disk atom iter import org apach cassandra columniter tabl iter import org apach cassandra marshal abstract type import org apach cassandra version serial import org apach cassandra sstabl tabl reader import org apach cassandra util file data input import org apach cassandra net messag servic import org apach cassandra util byte buffer util import org apach cassandra util util public class queri filter implement disk atom filter public static final serial serial serial public final sort set byte buffer column true live count alway return fact filter cell span multipl row privat final boolean count row public queri filter sort set byte buffer column column fals public queri filter sort set byte buffer column boolean count row column column count row count row public queri filter byte buffer column util singleton column public queri filter updat column sort set byte buffer column return queri filter column count row public disk atom iter memtabl column iter column famili decor key key return memtabl iter key public tabl column iter tabl column iter tabl reader sstabl decor key key return tabl iter sstabl key column public tabl column iter tabl column iter tabl reader sstabl file data input file decor key key row index entri index entri return tabl iter sstabl file key column index entri public super column filter super column super column super column int befor column column super column column column column queri filter relev column super column befor super column remov column return super column public void collect reduc column column iter column reduc column int befor reduc column column column reduc column queri filter relev column befor add column column public compar column column compar abstract type compar return compar column compar overrid public string string return queri filter column string util join column public boolean revers return fals public void updat column limit int limit public int live count column famili count row return onli tombston int count column column column live count return count public static class serial implement version serial queri filter public void serial queri filter data output dos int version throw dos write int column size byte buffer column byte buffer util write short length dos talk older node count row doe node return data requir workaround upgrad node version messag servic dos write boolean count row public queri filter deseri data input dis int version throw throw unsupport oper public queri filter deseri data input dis int version abstract type compar throw int size dis read int sort set byte buffer column tree set byte buffer compar int size column add byte buffer util read short length dis boolean count row version messag servic dis read boolean fals return queri filter column count row public long serial size queri filter int version type size size type size int size size sizeof column size byte buffer column int size remain size size sizeof short size size version messag servic size size sizeof count row return size 