licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java import java nio byte buffer import java nio channel file channel import googl common annot visibl test import org apach cassandra read error import org apach cassandra util librari public class random access reader extend random access file implement file data input public static final long long math pow default buffer size public static final int absolut filesystem path file privat final string file path buffer cach file block protect byte buffer current current posit file buffer offset offset buffer mark pointer fold offset file mark protect long buffer offset current mark pointer valid buffer byte number byte buffer actual valid buffer capac buffer full protect int valid buffer byte channel file retriev data forc updat protect final file channel channel privat final boolean skip cach file descriptor privat final int skip cach enabl privat long byte sinc cach flush privat final long file length protect final pool segment file owner protect random access reader file file int buffer size boolean skip cach pool segment file owner throw file super file owner owner channel super channel file path file absolut path alloc requir size buffer buffer size throw illeg argument buffer size posit buffer byte buffer size skip cach skip cach tri librari getfd catch null suppos happen throw runtim cach file length read onli mode tri file length channel size catch throw read error file path valid buffer byte trigger buffer demand read seek oper public static random access reader open file file return open file fals public static random access reader open file file pool segment file owner return open file fals owner public static random access reader open file file boolean skip cach return open file skip cach null visibl test static random access reader open file file int buffer size boolean skip cach pool segment file owner tri return random access reader file buffer size skip cach owner catch file throw runtim visibl test static random access reader open sequenti writer writer return open file writer path fals null read data file start current current offset popul buffer protect void buffer reset buffer tri buffer offset channel size return channel posit buffer offset set channel posit int read read buffer length int super read buffer read buffer length read break read valid buffer byte read byte sinc cach flush read catch throw read error file path skip cach byte sinc cach flush random control skip appropri skip file reach threshold librari tri skip cach byte sinc cach flush overrid public long file pointer return current public string path return file path public void reset seek mark pointer public long byte mark long byte current mark pointer assert byte return byte public file mark mark mark pointer current return buffer random access file mark mark pointer public void reset file mark mark assert mark instanceof buffer random access file mark seek buffer random access file mark mark pointer public long byte mark file mark mark assert mark instanceof buffer random access file mark long byte current buffer random access file mark mark pointer assert byte return byte return true data read public boolean return file pointer length public long byte remain return length file pointer protect int buffer cursor return int current buffer offset protect void reset buffer buffer offset current valid buffer byte overrid public void close owner null buffer null buffer null check pool owner dealloc call close call dealloc recycl dealloc object comfort dealloc didn handl idempot random access file close call abstract interrupt channel close call close case close sinc overrid dealloc els owner recycl public void dealloc buffer null don ostens close skip cach byte sinc cach flush librari tri skip cach tri super close catch throw read error file path overrid public string string return class simpl file path file path skip cach skip cach class hold mark posit file protect static class buffer random access file mark implement file mark final long pointer public buffer random access file mark long pointer pointer pointer overrid public void seek long posit posit throw illeg argument posit negat posit length save call length read onli mode throw illeg argument string format unabl seek posit byte read onli mode posit path length current posit posit buffer offset valid buffer byte posit buffer offset buffer overrid return noth read higher level method read int read fulli random access file throw public int read buffer null throw assert error attempt read close return requir random access file current buffer offset buffer length valid buffer byte buffer assert current buffer offset current buffer offset valid buffer byte return int buffer int current buffer offset xff overrid public int read byte buffer return read buffer buffer length overrid return noth read higher level method read int read fulli random access file throw public int read byte buff int offset int length buffer null throw assert error attempt read close length return return current buffer offset buffer length valid buffer byte buffer assert current buffer offset current buffer offset valid buffer byte string format file current offset buffer offset buffer limit path current buffer offset valid buffer byte int copi math min length valid buffer byte buffer cursor system arraycopi buffer buffer cursor buff offset copi current copi return copi public byte buffer read byte int length throw assert length buffer length negat length byte buff byte length tri read fulli buff read data buffer catch throw catch throw read error file path return byte buffer wrap buff overrid public long length return file length overrid public void write int valu throw unsupport oper overrid public void write byte buffer throw unsupport oper overrid public void write byte buffer int offset int length throw unsupport oper 