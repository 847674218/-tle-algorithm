licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stress import java import java net inet address import java net unknown host import java nio byte buffer import java util import java util concurr atom atom integ import java util concurr atom atom long import yammer metric metric import yammer metric core histogram import org apach cassandra cli transport frame transport factori import org apach cassandra config meta data import org apach cassandra config encrypt option import org apach cassandra config encrypt option client encrypt option import org apach cassandra configur import org apach cassandra syntax import org apach cassandra marshal import org apach common cli import org apach cassandra column famili type import org apach cassandra stress util cassandra client import org apach cassandra thrift import org apach common lang string util import org apach cassandra util byte buffer util import org apach thrift protocol binari protocol import org apach thrift transport socket import org apach thrift transport transport import org apach thrift transport transport factori public class session implement serializ command line option public static final option avail option option public static final string keyspac public static final string ascii type public static final string byte type privat static inet address local inet address public final atom integ oper atom integ public final atom integ key atom integ public final yammer metric core timer latenc metric timer session class latenc privat static final string truststor privat static final string truststor password privat static final string ssl protocol privat static final string ssl alg privat static final string store type privat static final string ssl cipher static avail option add option fals show messag exit avail option add option num key true number key default avail option add option num differ key true number differ key key multipl time default avail option add option skip key true fraction key skip initi default avail option add option thread true number thread default avail option add option column true number column key default avail option add option column size true size column valu byte default avail option add option cardin true number uniqu valu store column default avail option add option node true host node comma separ default locahost avail option add option nodesfil true file host node line avail option add option stdev true standard deviat factor default avail option add option random fals random key generat effect default fals avail option add option file true write output file avail option add option port true thrift port default avail option add option oper true oper perform default avail option add option supercolumn true number super column key default avail option add option famili type true column famili type super standard default standard avail option add option tri true retri oper time case failur posit integ default avail option add option fals ignor error insert read set tri effect default fals avail option add option progress interv true progress report interv default avail option add option key call true number key rang slice multiget call default avail option add option replic factor true replic factor creat column famili default avail option add option enabl cql fals perform queri cassandra queri languag avail option add option enabl cql fals perform queri cassandra queri languag avail option add option prepar statement fals perform queri prepar statement onli applic avail option add option consist level true consist level default avail option add option creat index true type index creat column famili avail option add option replic strategi true replic strategi onli insert keyspac doe exist default org apach cassandra locat simpl strategi avail option add option strategi properti true replic strategi properti follow format num num avail option add option replic write fals set replic write fals counter onli counter add work avail option add option averag size valu fals generat column valu averag specif size avail option add option send true send request stress daemon specifi address avail option add option compress true specifi compress sstabl default compress avail option add option queri true comma separ list column retriev row avail option add option compact strategi true compact strategi avail option add option compar true column compar current support type time type ascii type type avail option add option transport factori true fulli qualifi transport factori class creat connect note thrift org apach cassandra stress transport factori avail option add option true full path truststor avail option add option tspw true full path truststor avail option add option prtcl true connect protocol default avail option add option alg true algorithm default sun avail option add option true type store avail option add option cipher true comma separ list encrypt suit privat int num key privat int num differ key num key privat float skip key privat int thread privat int column privat int column size privat int cardin public string node string privat boolean random fals privat int retri time public int port privat int super column privat string compress null privat string compact strategi null privat int progress interv privat int key call privat boolean replic write true privat boolean ignor error fals privat boolean enabl cql fals privat boolean prepar fals privat boolean trace fals privat final string file privat index type index type null privat stress oper oper stress oper privat column famili type column famili type column famili type standard privat consist level consist level consist level privat string replic strategi org apach cassandra locat simpl strategi privat map string string replic strategi option hash map string string exact column read set option public final list byte buffer column public string cql version public final boolean averag size valu requir gaussian distribut protect int protect float sigma public final inet address send daemon public final string compar public final boolean time compar public doubl trace probabl public encrypt option enc option client encrypt option public transport factori transport factori frame transport factori public session string argument throw illeg argument syntax float dev command line parser parser posix parser tri command line cmd parser pars avail option argument cmd arg length system err println applic doe arbitrari argument string util join cmd arg list system exit cmd option throw illeg argument cmd option num key integ pars int cmd option valu cmd option num differ key integ pars int cmd option valu els num differ key num key cmd option skip key float pars float cmd option valu cmd option thread integ pars int cmd option valu cmd option column integ pars int cmd option valu cmd option column size integ pars int cmd option valu cmd option cardin integ pars int cmd option valu cmd option node cmd option valu split cmd option tri string node null list string tmp node array list string buffer reader buffer reader input stream reader file input stream cmd option valu node read line null node length tmp node add node node tmp node array string tmp node size close catch ioe throw runtim ioe cmd option dev float pars float cmd option valu cmd option random true file cmd option cmd option valu null cmd option port integ pars int cmd option valu cmd option oper stress oper valu cmd option valu upper case cmd option super column integ pars int cmd option valu cmd option column famili type column famili type valu cmd option valu cmd option retri time integ valu cmd option valu retri time throw runtim tri option valu cmd option retri time ignor error true cmd option progress interv integ pars int cmd option valu cmd option key call integ pars int cmd option valu cmd option consist level consist level valu cmd option valu upper case cmd option index type index type valu cmd option valu upper case cmd option replic strategi cmd option valu cmd option replic strategi option put replic factor string valu integ pars int cmd option valu els replic strategi simpl strategi replic strategi option put replic factor cmd option enabl cql true cql version cmd option enabl cql true cql version cmd option enabl cql system err println prepar statement onli applic enabl cql system exit prepar true cmd option string pair string util split cmd option valu string pair pair string key valu string util split pair key valu length throw runtim invalid strategi properti valu replic strategi option put key valu key valu cmd option replic write fals cmd option compress cmd option valu averag size valu cmd option tri send daemon cmd option send inet address cmd option valu send null catch unknown host throw runtim cmd option abstract type compar type parser pars string string util split cmd option valu column array list byte buffer length string column column add compar string column els column null cmd option compact strategi cmd option valu tri valid compact strategi class meta data creat compact strategi compact strategi catch configur system err println messag system exit cmd option abstract type pars null tri pars type parser pars cmd option valu catch configur system err println messag system exit compar cmd option valu time compar pars instanceof time type pars instanceof time type pars instanceof ascii type pars instanceof type system err println current support type time type ascii type type system exit els compar null time compar fals cmd option enc option truststor cmd option valu cmd option enc option truststor password cmd option valu cmd option enc option protocol cmd option valu cmd option enc option algorithm cmd option valu cmd option enc option store type cmd option valu cmd option enc option cipher suit cmd option valu split cmd option transport factori valid set transport factori cmd option valu catch pars throw illeg argument messag catch configur throw illeg state messag num differ key sigma num differ key dev privat transport factori valid set transport factori string transport factori tri class factori class transport factori transport factori class assign factori throw illeg argument string format transport factori deriv transport factori transport factori return transport factori factori instanc catch throw illeg argument string format creat transport factori transport factori public int cardin return cardin public int column size return column size public int column key return column public column famili type column famili type return column famili type public int num key return num key public int num differ key return num differ key public int thread return thread public float skip key return skip key public int super column return super column public int key thread return num key thread public int total key length return integ string num differ key length public consist level consist level return consist level public int retri time return retri time public boolean ignor error return ignor error public stress oper oper return oper public print stream output stream tri return file null system print stream file output stream file catch file throw runtim messag public int progress interv return progress interv public boolean random generat return random public int key call return key call requir gaussian distribut public int return requir gaussian distribut public float sigma return sigma public boolean return enabl cql public boolean prepar statement return prepar creat keyspac standard super counter column famili public void creat key space def keyspac def string default compar compar null compar column famili standard column def standard def def standard map string string compress option hash map string string compress null compress option put sstabl compress compress standard def set compar type default compar set default valid class set compress option compress option time compar int column key standard def add column metadata column def byte buffer util byte byte type index type null column def standard column column def byte buffer util byte byte type standard column set index type index type set index idx standard def set column metadata array list standard column column famili super column def super def def super set column type super super def set compar type set subcompar type default compar set default valid class set compress option compress option column famili standard counter def counter def def counter set compar type default compar set compar type default compar set default valid class counter column type set replic write replic write set compress option compress option column famili counter super column def counter super def def super counter set compar type default compar set default valid class counter column type set replic write replic write set column type super set compress option compress option keyspac set keyspac set strategi class replic strategi replic strategi option empti keyspac set strategi option replic strategi option compact strategi null standard def set compact strategi compact strategi super def set compact strategi compact strategi counter def set compact strategi compact strategi counter super def set compact strategi compact strategi keyspac set def array list def array list standard def super def counter def counter super def cassandra client client client fals tri client system add keyspac keyspac counter client set cql version creat counter cql client set keyspac client execut cql queri creat counter statement compress consist level enabl cql client set cql version cql version system println string format creat keyspac sleep propag node length thread sleep node length catch invalid request system err println unabl creat stress keyspac whi catch system err println messag thrift client connect keyspac set return cassandra client connect public cassandra client client return client true thrift client connect param set keyspac set keyspac client return cassandra client connect public cassandra client client boolean set keyspac random node select fake load balanc string current node node stress random int node length socket socket socket current node port transport transport transport factori transport socket cassandra client client cassandra client binari protocol transport tri transport open transport open enabl cql client set cql version cql version set keyspac client set keyspac keyspac catch invalid request throw runtim whi catch throw runtim messag return client public static inet address local address local inet address null tri local inet address inet address local host catch unknown host throw runtim return local inet address privat byte buffer creat counter statement string builder counter string builder counter blob int column key counter append append append counter column key counter append counter append return byte buffer util byte counter string 