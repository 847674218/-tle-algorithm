licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import java import java unsupport encod import java nio byte buffer import java nio charset charact code import java util import java util concurr timeout import java util zip data format import java util zip inflat import googl common base joiner import googl common collect immut map import googl common collect list import googl common collect map import org slf logger import org slf logger factori import org apach cassandra auth permiss import org apach cassandra config meta data import org apach cassandra config databas descriptor import org apach cassandra config meta data import org apach cassandra config schema import org apach cassandra cql statement import org apach cassandra cql queri processor import org apach cassandra import org apach cassandra context counter context import org apach cassandra filter disk atom filter import org apach cassandra filter queri path import org apach cassandra marshal marshal import org apach cassandra marshal time type import org apach cassandra dht import org apach cassandra read timeout import org apach cassandra request execut import org apach cassandra request valid import org apach cassandra unauthor import org apach cassandra util data output buffer import org apach cassandra locat abstract replic strategi import org apach cassandra locat dynam endpoint snitch import org apach cassandra schedul request schedul import org apach cassandra servic import org apach cassandra trace trace import org apach cassandra util byte buffer util import org apach cassandra util pair import org apach cassandra util semant version import org apach cassandra util gen import org apach thrift public class cassandra server implement cassandra ifac privat static final logger logger logger factori logger cassandra server class privat final static int privat final static list column super column collect empti list privat final static list column collect empti list privat final static list counter column collect empti list request schedul perform schedul incom request privat final request schedul request schedul public cassandra server request schedul databas descriptor request schedul public thrift client state state return thrift session manag instanc current session protect map decor key column famili read column famili list read command command org apach cassandra consist level consist level throw org apach cassandra invalid request unavail time support multipl column famili row row onli column famili map decor key column famili column famili key map hash map decor key column famili list row row null tri schedul databas descriptor read rpc timeout tri row storag proxi read command consist level final releas catch request execut thrift convers rethrow catch throw runtim row row row column famili key map put row key row return column famili key map public list column thriftifi column collect column column column null column empti return array list column thrift column array list column column size column column column column mark delet continu column thrift column column column set valu column valu set timestamp column timestamp column instanceof expir column thrift column set ttl expir column column time live thrift column add thrift column return thrift column public list counter column thriftifi counter column collect column column column null column empti return array list counter column thrift column array list counter column column size column column column column mark delet continu assert column instanceof org apach cassandra counter column counter column thrift column counter column column counter context instanc total column valu thrift column add thrift column return thrift column public list column super column thriftifi column collect column column boolean revers order array list column super column thrift column array list column super column column size column column column column mark delet continu column instanceof org apach cassandra counter column counter column thrift column counter column column counter context instanc total column valu thrift column add column super column set counter column thrift column els column thrift column column column set valu column valu set timestamp column timestamp column instanceof expir column thrift column set ttl expir column column time live thrift column add column super column set column thrift column revers sinc intern pass result column famili object alway sort column natur order inconveni direct user storag proxi revers order collect revers thrift column return thrift column privat list column super column thriftifi super column collect column column boolean revers order boolean counter counter return thriftifi counter super column column revers order els return thriftifi super column column revers order privat list column super column thriftifi super column collect column column boolean revers order array list column super column thrift super column array list column super column column size column column column list column subcolumn thriftifi column column column subcolumn empti continu super column super column super column column subcolumn thrift super column add column super column set super column super column revers order collect revers thrift super column return thrift super column privat list column super column thriftifi counter super column collect column column boolean revers order array list column super column thrift super column array list column super column column size column column column list counter column subcolumn thriftifi counter column column column subcolumn empti continu counter super column super column counter super column column subcolumn thrift super column add column super column set counter super column super column revers order collect revers thrift super column return thrift super column privat map byte buffer list column super column slice list read command command org apach cassandra consist level consist level throw org apach cassandra invalid request unavail time map decor key column famili column famili read column famili command consist level map byte buffer list column super column column famili map hash map byte buffer list column super column read command command command column famili column famili storag servic partition decor key command key boolean revers order command instanceof slice read command slice read command command filter revers list column super column thriftifi column thriftifi column famili command queri path super column null revers order column famili map put command key thriftifi column return column famili map privat list column super column thriftifi column famili column famili boolean subcolumn onli boolean revers order null empti return subcolumn onli column column iter collect column subcolumn column column subcolumn null subcolumn empti return els return thriftifi column subcolumn revers order super boolean counter metadata default valid commut return thriftifi super column sort column revers order counter els return thriftifi column sort column revers order public list column super column slice byte buffer key column parent column parent slice predic predic consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column parent column parent string predic predic string consist level consist level trace instanc slice trace paramet els logger debug slice tri client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss return multiget slice intern keyspac collect singleton list key column parent predic consist level key catch request valid throw thrift convers thrift final trace instanc stop session public map byte buffer list column super column multiget slice list byte buffer key column parent column parent slice predic predic consist level consist level throw invalid request unavail time start session request list string key list list array list byte buffer key key key list add byte buffer util byte hex key map string string trace paramet immut map key key list string column parent column parent string predic predic string consist level consist level trace instanc multiget slice trace paramet els logger debug multiget slice tri client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss return multiget slice intern keyspac key column parent predic consist level catch request valid throw thrift convers thrift final trace instanc stop session privat map byte buffer list column super column multiget slice intern string keyspac list byte buffer key column parent column parent slice predic predic consist level consist level throw org apach cassandra invalid request unavail time meta data metadata thrift valid valid column famili keyspac column parent column famili thrift valid valid column parent metadata column parent thrift valid valid predic metadata column parent predic org apach cassandra consist level consist level thrift convers thrift consist level consist level valid read keyspac list read command command array list read command key size predic column null byte buffer key key thrift valid valid key metadata key command add slice read command keyspac key column parent predic column els slice rang rang predic slice rang byte buffer key key thrift valid valid key metadata key command add slice read command keyspac key column parent rang start rang finish rang revers rang count return slice command consist level privat column super column intern byte buffer key column path column path consist level consist level throw request valid unavail time thrift client state state state string keyspac state keyspac state column famili access keyspac column path column famili permiss meta data metadata thrift valid valid column famili keyspac column path column famili thrift valid valid column path metadata column path org apach cassandra consist level consist level thrift convers thrift consist level consist level valid read keyspac queri path path queri path column path column famili column path column null null column path super column list byte buffer list array list column path column null column path super column column path column thrift valid valid key metadata key read command command slice read command keyspac key path list map decor key column famili cfamili read column famili array list command consist level column famili cfamili storag servic partition decor key command key null throw list column super column tcolumn thriftifi column famili command queri path super column null fals tcolumn empti throw assert tcolumn size return tcolumn public column super column byte buffer key column path column path consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column path column path string consist level consist level trace instanc trace paramet els logger debug tri return intern key column path consist level catch request valid throw thrift convers thrift final trace instanc stop session public int count byte buffer key column parent column parent slice predic predic consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column parent column parent string predic predic string consist level consist level trace instanc count trace paramet els logger debug count tri thrift client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss tabl tabl tabl open keyspac column famili store cfs tabl column famili store column parent column famili predic column null return slice key column parent predic consist level size int page size request page larg row cfs column int averag column size int cfs row size cfs column page size math min databas descriptor memori compact limit averag column size page size math max page size logger debug averag row column size page size averag column size page size els page size int total count list column super column column predic slice rang null predic slice rang slice rang byte buffer util byte buffer util fals integ final int request count predic slice rang count int remain request count int page true predic slice rang count math min page size math max remain fetch column column slice key column parent predic consist level column empti break byte buffer column int column page equal predic slice rang start column size column size total count column count return origin limit total count request count return request count remain column page queri number column request user fetch page onli column alreadi fetch remain column size equal predic slice rang start break els predic slice rang start column column size return total count catch request valid throw thrift convers thrift final trace instanc stop session privat static byte buffer column super column cosc return cosc set super column cosc super column cosc set column cosc column cosc set counter column cosc counter column cosc counter super column public map byte buffer integ multiget count list byte buffer key column parent column parent slice predic predic consist level consist level throw invalid request unavail time start session request list string key list list array list byte buffer key key key list add byte buffer util byte hex key map string string trace paramet immut map key key list string column parent column parent string predic predic string consist level consist level trace instanc multiget count trace paramet els logger debug multiget count tri thrift client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss map byte buffer integ count hash map byte buffer integ map byte buffer list column super column column famili map multiget slice intern keyspac key column parent predic consist level map entri byte buffer list column super column column famili map entri set count put key valu size return count catch request valid throw thrift convers thrift final trace instanc stop session privat void intern insert byte buffer key column parent column parent column column consist level consist level throw request valid unavail time thrift client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss meta data metadata thrift valid valid column famili keyspac column parent column famili fals thrift valid valid key metadata key thrift valid valid column parent metadata column parent super column field usual option insert metadata type column famili type super column parent super column null throw org apach cassandra invalid request mandatori super column super column parent column famili thrift valid valid column metadata column parent array list column thrift valid valid column data metadata column column parent super column null row mutat row mutat state keyspac key tri add queri path column parent column famili column parent super column column column valu column timestamp column ttl catch marshal throw org apach cassandra invalid request messag insert consist level array list public void insert byte buffer key column parent column parent column column consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column parent column parent string column column string consist level consist level trace instanc insert trace paramet els logger debug insert tri intern insert key column parent column consist level catch request valid throw thrift convers thrift final trace instanc stop session privat list mutat creat mutat list consist level consist level map byte buffer map string list mutat mutat map boolean counter mutat throw request valid list string cfam array list string list mutat row mutat array list mutat thrift client state state state string keyspac state keyspac map entri byte buffer map string list mutat mutat entri mutat map entri set byte buffer key mutat entri key separ row mutat standard counter encapsul counter mutat becaus doesn follow code path row mutat standard null row mutat counter null map string list mutat column famili mutat mutat entri valu map entri string list mutat column famili mutat column famili mutat entri set string column famili mutat key avoid unneed author cfam state column famili access keyspac permiss cfam add meta data metadata thrift valid valid column famili keyspac thrift valid valid key metadata key row mutat metadata default valid commut thrift convers thrift consist level valid counter write metadata counter counter null row mutat keyspac key counter counter els standard standard null row mutat keyspac key standard standard mutat mutat column famili mutat valu thrift valid valid mutat metadata mutat mutat delet null delet column super column mutat delet mutat column supercolumn null add column super column mutat column supercolumn standard null standard empti row mutat add standard counter null counter empti counter mutat row mutat add counter mutat counter thrift convers thrift consist level els throw org apach cassandra invalid request counter mutat atom batch return row mutat public void batch mutat map byte buffer map string list mutat mutat map consist level consist level throw invalid request unavail time start session request map string string trace paramet map link hash map map entri byte buffer map string list mutat mutat entri mutat map entri set trace paramet put byte buffer util byte hex mutat entri key joiner key valu separ join mutat entri valu trace paramet put consist level consist level trace instanc batch mutat trace paramet els logger debug batch mutat tri insert consist level creat mutat list consist level mutat map true catch request valid throw thrift convers thrift final trace instanc stop session public void atom batch mutat map byte buffer map string list mutat mutat map consist level consist level throw invalid request unavail time start session request map string string trace paramet map link hash map map entri byte buffer map string list mutat mutat entri mutat map entri set trace paramet put byte buffer util byte hex mutat entri key joiner key valu separ join mutat entri valu trace paramet put consist level consist level trace instanc atom batch mutat trace paramet els logger debug atom batch mutat tri insert consist level creat mutat list consist level mutat map fals true catch request valid throw thrift convers thrift final trace instanc stop session privat void intern remov byte buffer key column path column path long timestamp consist level consist level boolean commut throw request valid unavail time thrift client state state state string keyspac state keyspac state column famili access keyspac column path column famili permiss meta data metadata thrift valid valid column famili keyspac column path column famili commut thrift valid valid key metadata key thrift valid valid column path parent metadata column path commut thrift convers thrift consist level valid counter write metadata row mutat row mutat keyspac key delet queri path column path timestamp commut insert consist level array list counter mutat thrift convers thrift consist level els insert consist level array list public void remov byte buffer key column path column path long timestamp consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column path column path string timestamp timestamp consist level consist level trace instanc remov trace paramet els logger debug remov tri intern remov key column path timestamp consist level fals catch request valid throw thrift convers thrift final trace instanc stop session privat void insert consist level consist level list extend mutat mutat throw unavail time org apach cassandra invalid request insert consist level mutat fals privat void insert consist level consist level list extend mutat mutat boolean mutat atom throw unavail time org apach cassandra invalid request org apach cassandra consist level consist level thrift convers thrift consist level consist level valid write state keyspac mutat empti return schedul databas descriptor write rpc timeout tri mutat atom storag proxi mutat atom list row mutat mutat consist level els storag proxi mutat mutat consist level catch request execut thrift convers rethrow final releas privat void valid login throw invalid request tri state valid login catch unauthor throw invalid request messag public def describ keyspac string tabl throw invalid request valid login meta data ksm schema instanc tabl definit tabl ksm null throw return ksm thrift public list key slice rang slice column parent column parent slice predic predic key rang rang consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map column parent column parent string predic predic string rang rang string consist level consist level trace instanc rang slice trace paramet els logger debug rang slice tri string keyspac null meta data metadata null thrift client state state state keyspac state keyspac state column famili access keyspac column parent column famili permiss metadata thrift valid valid column famili keyspac column parent column famili thrift valid valid column parent metadata column parent thrift valid valid predic metadata column parent predic thrift valid valid key rang metadata column parent super column rang org apach cassandra consist level consist level thrift convers thrift consist level consist level valid read keyspac list row row null partition storag servic partition abstract bound row posit bound rang start key null token token factori token factori token factori token left token factori string rang start token token token factori string rang token bound rang row rang left els row posit rang key null token factori string rang token max key bound row posit key rang key bound bound row posit row posit key rang start key schedul databas descriptor rang rpc timeout tri disk atom filter filter thrift valid filter predic metadata compar column parent super column row storag proxi rang slice rang slice command keyspac column parent filter bound rang row filter rang count consist level final releas assert row null return thriftifi key slice row column parent predic catch request valid throw thrift convers thrift catch read timeout logger debug time throw thrift convers thrift catch org apach cassandra unavail throw thrift convers thrift catch throw runtim final trace instanc stop session public list key slice page slice string column famili key rang rang byte buffer start column consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map column famili column famili rang rang string start column byte buffer util byte hex start column consist level consist level trace instanc page slice trace paramet els logger debug page slice tri thrift client state state state string keyspac state keyspac state column famili access keyspac column famili permiss meta data metadata thrift valid valid column famili keyspac column famili thrift valid valid key rang metadata null rang org apach cassandra consist level consist level thrift convers thrift consist level consist level valid read keyspac slice predic predic slice predic set slice rang slice rang start column byte buffer util fals partition storag servic partition abstract bound row posit bound rang start key null token key unsupport assum token token token token factori token factori token factori token left token factori string rang start token token token factori string rang token bound rang row rang left els row posit rang key null token factori string rang token max key bound row posit key rang key bound bound row posit row posit key rang start key list row row schedul databas descriptor rang rpc timeout tri disk atom filter filter thrift valid filter predic metadata compar row storag proxi rang slice rang slice command keyspac column famili null filter bound rang row filter rang count true true consist level final releas assert row null return thriftifi key slice row column parent column famili predic catch request valid throw thrift convers thrift catch read timeout logger debug time throw thrift convers thrift catch org apach cassandra unavail throw thrift convers thrift catch throw runtim final trace instanc stop session privat list key slice thriftifi key slice list row row column parent column parent slice predic predic list key slice key slice array list key slice row size boolean revers predic slice rang null predic slice rang revers row row row list column super column thriftifi column thriftifi column famili row column parent super column null revers key slice add key slice row key key thriftifi column return key slice public list key slice index slice column parent column parent index claus index claus slice predic column predic consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map column parent column parent string index claus index claus string slice predic column predic string consist level consist level trace instanc index slice trace paramet els logger debug scan tri thrift client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss meta data metadata thrift valid valid column famili keyspac column parent column famili fals thrift valid valid column parent metadata column parent thrift valid valid predic metadata column parent column predic thrift valid valid index claus metadata index claus org apach cassandra consist level consist level thrift convers thrift consist level consist level valid read keyspac partition storag servic partition abstract bound row posit bound bound row posit row posit key index claus start key minimum token min key bound disk atom filter filter thrift valid filter column predic metadata compar column parent super column rang slice command command rang slice command keyspac column parent column famili null filter bound index claus express index claus count list row row storag proxi rang slice command consist level return thriftifi key slice row column parent column predic catch request valid throw thrift convers thrift catch read timeout logger debug time throw thrift convers thrift catch org apach cassandra unavail throw thrift convers thrift catch throw runtim final trace instanc stop session public list def describ keyspac throw invalid request valid login set string keyspac schema instanc tabl list def ksset array list def keyspac size string keyspac tri ksset add describ keyspac catch nfe logger info fail find metadata keyspac continu return ksset public string describ cluster throw return databas descriptor cluster public string describ version throw return constant public list token rang describ ring string keyspac throw invalid request tri return storag servic instanc describ ring keyspac catch request valid throw thrift convers thrift public map string string describ token map throw invalid request return storag servic instanc token endpoint map public string describ partition throw return storag servic partition class public string describ snitch throw databas descriptor endpoint snitch instanceof dynam endpoint snitch return dynam endpoint snitch databas descriptor endpoint snitch subsnitch class return databas descriptor endpoint snitch class deprec public list string describ split string string start token string token int key split throw invalid request list split split describ split start token token key split list string result array list string split size result add split start token split split split result add split token return result public list split describ split string string start token string token int key split throw invalid request tri token token factori storag servic partition token factori rang token rang token string start token string token list pair rang token long split storag servic instanc split state keyspac key split list split result array list split split size pair rang token long split split result add split split left left string split left string split return result catch request valid throw thrift convers thrift public void login authent request auth request throw authent author tri state login auth request credenti catch org apach cassandra authent throw thrift convers thrift schedul current thread access requir servic privat void schedul long timeout throw unavail tri request schedul queue thread current thread state schedul valu timeout catch timeout throw unavail releas count resourc privat void releas request schedul releas public string system add column famili def def throw invalid request schema disagr logger debug add column famili tri client state state state string keyspac state keyspac state keyspac access keyspac permiss def unset explicit ignor ani set client hector set meta data cfm meta data thrift def meta data valid compact option cfm compact strategi class cfm compact strategi option cfm add default index migrat manag announc column famili cfm return schema instanc version string catch request valid throw thrift convers thrift public string system drop column famili string column famili throw invalid request schema disagr logger debug drop column famili thrift client state state state tri string keyspac state keyspac state column famili access keyspac column famili permiss migrat manag announc column famili drop keyspac column famili return schema instanc version string catch request valid throw thrift convers thrift public string system add keyspac def def throw invalid request schema disagr logger debug add keyspac tri thrift valid valid keyspac system def state keyspac access permiss thrift valid valid keyspac exist def trial run valid class class option abstract replic strategi creat replic strategi def abstract replic strategi class def strategi class storag servic instanc token metadata databas descriptor endpoint snitch def strategi option generat meaning error user setup keyspac column definit incorrect def def def keyspac equal def throw invalid request def keyspac definit match def collect meta data def array list meta data def def size def def def def def unset explicit ignor ani set client system add column famili meta data cfm meta data thrift def cfm add default index def add cfm migrat manag announc keyspac meta data thrift def def array meta data def size return schema instanc version string catch request valid throw thrift convers thrift public string system drop keyspac string keyspac throw invalid request schema disagr logger debug drop keyspac tri thrift valid valid keyspac system keyspac state keyspac access keyspac permiss migrat manag announc keyspac drop keyspac return schema instanc version string catch request valid throw thrift convers thrift updat exist keyspac column famili modif throw schema disagr public string system updat keyspac def def throw invalid request schema disagr logger debug updat keyspac tri thrift valid valid keyspac system def state keyspac access def permiss thrift valid valid tabl def def def null def def size throw invalid request keyspac updat ani column famili definit migrat manag announc keyspac updat meta data thrift def return schema instanc version string catch request valid throw thrift convers thrift public string system updat column famili def def throw invalid request schema disagr logger debug updat column famili tri def keyspac null def null throw invalid request keyspac set meta data cfm schema instanc meta data def keyspac def cfm null throw invalid request find column famili definit modifi state column famili access def keyspac def permiss meta data appli implicit default def meta data cfm meta data thrift def meta data valid compact option cfm compact strategi class cfm compact strategi option cfm add default index migrat manag announc column famili updat cfm return schema instanc version string catch request valid throw thrift convers thrift public void truncat string cfname throw invalid request unavail time client state state state tri string keyspac state keyspac state column famili access keyspac cfname permiss start session request trace instanc truncat immut map cfname keyspac els logger debug truncat state keyspac cfname schedul databas descriptor truncat rpc timeout tri storag proxi truncat block state keyspac cfname final releas catch request valid throw thrift convers thrift catch org apach cassandra unavail throw thrift convers thrift catch timeout logger debug time throw time catch throw unavail unavail init caus final trace instanc stop session public void set keyspac string keyspac throw invalid request valid login tri thrift valid valid tabl keyspac state set keyspac keyspac catch request valid throw thrift convers thrift public map string list string describ schema version throw invalid request logger debug check schema agreement return storag proxi describ schema version counter method public void add byte buffer key column parent column parent counter column column consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map column parent column parent string column column string consist level consist level trace instanc add trace paramet els logger debug add tri client state state state string keyspac state keyspac state column famili access keyspac column parent column famili permiss meta data metadata thrift valid valid column famili keyspac column parent column famili true thrift valid valid key metadata key thrift convers thrift consist level valid counter write metadata thrift valid valid column parent metadata column parent super column field usual option ad metadata type column famili type super column parent super column null throw invalid request mandatori super column super column parent column famili thrift valid valid column metadata column parent array list column row mutat row mutat keyspac key tri add counter queri path column parent column famili column parent super column column column valu catch marshal throw invalid request messag insert consist level array list counter mutat thrift convers thrift consist level catch request valid throw thrift convers thrift final trace instanc stop session public void remov counter byte buffer key column path path consist level consist level throw invalid request unavail time start session request map string string trace paramet immut map key byte buffer util byte hex key column path path string consist level consist level trace instanc remov counter trace paramet els logger debug remov counter tri intern remov key path system current time milli consist level true catch request valid throw thrift convers thrift final trace instanc stop session privat static string uncompress byte buffer queri compress compress throw invalid request string queri string null decompress queri string tri switch compress case data output buffer decompress data output buffer byte buffer byte buffer byte inflat decompressor inflat int len read true decompressor input len read queri remain queri remain queri buffer len read decompressor set input buffer len read int len write len write decompressor inflat buffer decompress write buffer len write decompressor finish break decompressor queri string string decompress data decompress size break case tri queri string byte buffer util string queri catch charact code throw invalid request messag break catch data format throw invalid request error deflat queri string catch unsupport encod throw invalid request unknown queri string encod return queri string privat void valid version int major throw invalid request rule version set don valid anyth reason client call set cql version client remov set cql version updat client upgrad pre shouldn case howev sinc set cql version mandatori otherwis check major match whatev set semant version version set state version version set null return version set major major throw invalid request execut prepar major statement sinc set version set major client hasn upgrad correct method introduc cassandra public cql result execut cql queri byte buffer queri compress compress throw invalid request unavail time schema disagr valid version tri string queri string uncompress queri compress start session request trace instanc execut cql queri immut map queri queri string els logger debug execut cql queri return queri processor process queri string state catch request execut thrift convers rethrow return null catch request valid throw thrift convers thrift final trace instanc stop session public cql result execut cql queri byte buffer queri compress compress consist level level throw invalid request unavail time schema disagr valid version tri string queri string uncompress queri compress start session request trace instanc execut cql queri immut map queri queri string els logger debug execut cql queri thrift client state state state return org apach cassandra cql queri processor process queri string thrift convers thrift level state queri state thrift result catch request execut thrift convers rethrow return null catch request valid throw thrift convers thrift final trace instanc stop session public cql prepar result prepar cql queri byte buffer queri compress compress throw invalid request logger debug enabl logger debug prepar cql queri valid version tri thrift client state state state string queri string uncompress queri compress return queri processor prepar queri string state catch request valid throw thrift convers thrift public cql prepar result prepar cql queri byte buffer queri compress compress throw invalid request logger debug enabl logger debug prepar cql queri valid version tri thrift client state state state string queri string uncompress queri compress return org apach cassandra cql queri processor prepar queri string state true thrift prepar result catch request valid throw thrift convers thrift public cql result execut prepar cql queri int item list byte buffer bind variabl throw invalid request unavail time schema disagr valid version start session request don type access bind variabl open add support trace instanc execut prepar cql queri collect string string empti map els logger debug execut prepar cql queri tri thrift client state state state statement statement state prepar item statement null throw invalid request string format prepar queri item logger trace retriev prepar statement bind marker item statement bound term return queri processor process prepar statement state bind variabl catch request execut thrift convers rethrow return null catch request valid throw thrift convers thrift final trace instanc stop session public cql result execut prepar cql queri int item list byte buffer bind variabl consist level level throw invalid request unavail time schema disagr valid version start session request don type access bind variabl open add support trace instanc execut prepar cql queri collect string string empti map els logger debug execut prepar cql queri tri thrift client state state state org apach cassandra cql statement statement org apach cassandra cql queri processor prepar item statement null throw invalid request string format prepar queri queri prepar host mayb host restart prepar queri queri evict intern cach item org apach cassandra cql queri processor item logger trace retriev prepar statement bind marker item statement bound term return org apach cassandra cql queri processor process prepar statement thrift convers thrift level state queri state bind variabl thrift result catch request execut thrift convers rethrow return null catch request valid throw thrift convers thrift final trace instanc stop session deprec client set compat sake set howev throw becaus client hasn updat cassandra start execut cql queri point warn earli public void set cql version string version throw invalid request tri state set version version catch org apach cassandra invalid request throw invalid request messag public byte buffer trace queri throw session gen time state queri state prepar trace session session return time type instanc decompos session privat boolean start session request state queri state trace queri state queri state creat trace session return true return fals main method move cassandra daemon 