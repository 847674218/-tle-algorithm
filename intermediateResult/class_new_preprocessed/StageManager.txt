licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra concurr import java util enum map import java util concurr import org slf logger import org slf logger factori import org apach cassandra net messag servic import org apach cassandra util util import static org apach cassandra config databas descriptor class manag executor servic messag reciev messag request run specif stage concurr control henc map approach stage executor creat dynam public class stage manag privat static final logger logger logger factori logger stage manag class privat static final enum map stage thread pool executor stage enum map stage thread pool executor stage class public static final long extra thread aliv idl public static final int util avail processor static stage put stage multi thread configur stage stage concurr writer stage put stage multi thread configur stage stage concurr reader stage put stage multi thread stage stage util avail processor stage put stage multi thread stage stage util avail processor stage put stage multi thread configur stage stage concurr replic rest singl thread stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage multi thread stage stage util avail processor stage put stage trace executor privat static thread pool executor trace executor reject execut handler reh reject execut handler public void reject execut runnabl thread pool executor executor messag servic instanc increment drop messag messag servic verb return execut onli executor time unit array block queue runnabl thread factori stage jmx reh privat static thread pool executor multi thread stage stage stage int num thread return enabl thread pool executor num thread time unit link block queue runnabl thread factori stage jmx stage jmx type privat static thread pool executor multi thread configur stage stage stage int num thread return configur thread pool executor num thread time unit link block queue runnabl thread factori stage jmx stage jmx type privat static thread pool executor multi thread configur stage stage stage int num thread int max task befor block return configur thread pool executor num thread time unit link block queue runnabl max task befor block thread factori stage jmx stage jmx type retriev stage stage manag param stage stage retriev public static thread pool executor stage stage stage return stage stage method shut regist stage public static void shutdown stage stage stage valu stage manag stage stage shutdown disallow submit don worri unwrap trace stage background privat static class execut onli executor extend thread pool executor public execut onli executor int core pool size int maximum pool size long aliv time time unit unit block queue runnabl work queue thread factori thread factori reject execut handler handler super core pool size maximum pool size aliv time unit work queue thread factori handler overrid public futur submit runnabl task return super submit task overrid public futur submit runnabl task result return super submit task result overrid public futur submit callabl task return super submit task 