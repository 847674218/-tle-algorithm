licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra transport import java util array list import java util array import java util hash map import java util map import java util list import googl common base charset import org jboss netti buffer channel buffer import org apach cassandra request valid import org apach cassandra marshal import org apach cassandra util pair public enum data type implement option codec codec data type null ascii type instanc long type instanc byte type instanc boolean type instanc counter column type instanc decim type instanc doubl type instanc float type instanc int type instanc type instanc date type instanc type instanc type instanc integ type instanc time type instanc inet address type instanc null null null public static final option codec data type codec option codec data type data type class privat final int privat final abstract type type privat static final map abstract type data type data type map hash map abstract type data type static data type type data type valu type type null data type map put type type type privat data type int abstract type type type type public int return public object read valu channel buffer switch case return util read string case return data type type codec decod case return data type type codec decod case list abstract type array list abstract type add data type type codec decod add data type type codec decod return default return null public void write valu object valu channel buffer switch case assert valu instanceof string write byte util string string valu break case write byte codec encod data type type abstract type valu break case write byte codec encod data type type abstract type valu break case list abstract type list abstract type valu write byte codec encod data type type write byte codec encod data type type break public int serial valu size object valu switch case return string valu byte charset length case case return codec serial size data type type abstract type valu case list abstract type list abstract type valu int codec serial size data type type codec serial size data type type return default return public static pair data type object type abstract type type client revers type implement detail shouldn care type instanceof revers type type revers type type base type data type data type map type null type collect type instanceof list type return pair data type object creat list type type element els type instanceof map type map type map type type return pair data type object creat array list key valu els assert type instanceof set type return pair data type object creat set type type element return pair data type object creat type string els return pair creat null public static abstract type type pair data type object entri tri switch entri left case return type parser pars string entri case return list type instanc abstract type entri case return set type instanc abstract type entri case list abstract type list abstract type entri return map type instanc default return entri left type catch request valid throw protocol messag 