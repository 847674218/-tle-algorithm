licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java nio byte buffer import java util list import java util concurr atom atom refer import java util concurr copi write array list import org slf logger import org slf logger factori import googl common base object import org apach cassandra counter column import org apach cassandra system tabl public class counter implement compar counter privat static final logger logger logger factori logger counter class public static final int assum fix length size counter id lazi holder becaus open system tabl avoid trigger dure class initi privat static class local id static final local counter histori instanc local counter histori privat final byte buffer privat static local counter histori local id return local id instanc public static counter local return local id current renew local counter onli strict necessari counter context grow time public static void renew local renew local util timestamp micro public static synchron void renew local long local id renew current return list local counter node guarante return list sort grow counter henc item oldest counter host public static list counter record local counter id return local id function test purpos otherwis pack int valid counter result id respect numer order creat handcraft easi understand context unit test counter context test public static counter int int long bit return counter byte buffer alloc put long put long bit perform reason function intern provid byte buffer public static counter wrap byte buffer return counter public static counter wrap byte buffer int offset byte buffer dup duplic dup posit offset dup limit dup posit return wrap dup privat counter byte buffer remain throw illeg argument counter represent exact byte public static counter generat return counter byte buffer wrap gen time byte perform reason function return refer intern byte buffer client modifi result function public byte buffer byte return public boolean local return equal local public int compar counter return byte buffer util compar array posit posit counter overrid public string string return gen string overrid public boolean equal object return true null class class return fals counter counter return equal overrid public int hash code return hash code public static class shot renew privat boolean renew privat final counter initi public shot renew renew fals initi local public void mayb renew counter column column renew column counter initi renew local renew true privat static class local counter histori privat final atom refer counter current privat final list counter record local counter histori counter system tabl current local counter null record local counter generat save generat logger info save local counter newli generat system tabl write current local counter null util timestamp micro current atom refer counter copi write array list counter record els logger info save local counter current atom refer counter copi write array list counter record system tabl local counter id synchron void renew current long counter counter generat counter current system tabl write current local counter counter current set counter add counter record public static class counter record public final counter public final long timestamp public counter record counter long timestamp timestamp timestamp overrid public boolean equal object return true null class class return fals counter record record counter record return equal record timestamp record timestamp overrid public int hash code return object hash code timestamp public string string return string format string timestamp 