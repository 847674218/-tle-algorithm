licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java import java net inet address import java util collect import org slf logger import org slf logger factori import org apach cassandra configur import org apach cassandra def tabl import org apach cassandra row mutat import org apach cassandra gms failur detector import org apach cassandra net async callback import org apach cassandra net messag import org apach cassandra net messag import org apach cassandra net messag servic import org apach cassandra util wrap runnabl class migrat task extend wrap runnabl privat static final logger logger logger factori logger migrat task class privat final inet address endpoint migrat task inet address endpoint endpoint endpoint public void run throw throw messag messag messag messag servic verb null migrat manag migrat serial instanc failur detector instanc aliv endpoint logger error send migrat request node endpoint return async callback collect row mutat async callback collect row mutat overrid public void respons messag collect row mutat messag tri def tabl merg schema messag payload catch logger error merg remot schema catch configur logger error configur merg remot schema overrid public boolean latenc snitch return fals messag servic instanc send messag endpoint 