licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra gms import org apach cassandra type size import org apach cassandra dht partition import org apach cassandra dht token import org slf logger import org slf logger factori import java import java nio byte buffer import java util array list import java util collect public class token serial privat static final logger logger logger factori logger token serial class public static void serial partition partition collect token token data output dos throw token token token byte bintoken partition token factori byte array token array dos write int bintoken length dos write bintoken dos write int public static collect token deseri partition partition data input dis throw collect token token array list token true int size dis read int size break logger trace read token byte size byte bintoken byte size dis read fulli bintoken token add partition token factori byte array byte buffer wrap bintoken return token public static long serial size collect token token type size type size throw unsupport oper 