licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java data input import java data output import java import java nio byte buffer import java util array list import java util list import org apach cassandra config databas descriptor import org apach cassandra decor key import org apach cassandra dht partition import org apach cassandra util byte buffer util approach build index summari call mayb add entri everi potenti index entri call add entri add entri increment rowid public class index summari public static final index summari serial serial index summari serial privat final array list long posit privat final array list decor key key privat long key written public index summari long expect key long expect entri expect key databas descriptor index interv expect entri integ lot key veri interv throw runtim index interv databas descriptor index interv expect key expect key posit array list long int expect entri key array list decor key int expect entri privat index summari posit array list long key array list decor key public void increment rowid key written public boolean add entri return key written databas descriptor index interv public void add entri decor key key long index posit key add tabl minim key key posit add index posit public void mayb add entri decor key decor key long index posit add entri add entri decor key index posit increment rowid public list decor key key return key public long posit int index return posit index public void complet key trim size posit trim size public static class index summari serial public void serial index summari data output dos throw assert key size posit size keysiz posit size dos write int databas descriptor index interv dos write int key size int key size dos write long posit byte buffer util write length key key dos public index summari deseri data input dis partition partition throw index summari summari index summari dis read int databas descriptor index interv throw read save summari becaus index interv chang int size dis read int int size long locat dis read long byte buffer key byte buffer util read length dis summari add entri partition decor key key locat return summari 