licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra secur import java file input stream import java import java net inet address import java net inet socket address import java secur key store import java util set import javax net ssl key manag factori import javax net ssl context import javax net ssl server socket import javax net ssl socket import javax net ssl trust manag import javax net ssl trust manag factori import org apach cassandra config encrypt option import org apach cassandra util file util import org apach common lang string util import org slf logger import org slf logger factori import googl common collect set factori provid set client server wrap socket server socket public final class factori privat static final logger logger logger factori logger factori class public static server socket server socket encrypt option option inet address address int port throw context ctx creat context option true server socket server socket server socket ctx server socket factori creat server socket server socket set reus address true string suit filter cipher suit server socket support cipher suit option cipher suit server socket set enabl cipher suit suit server socket set client auth option requir client auth server socket bind inet socket address address port return server socket creat socket connect public static socket socket encrypt option option inet address address int port inet address local address int local port throw context ctx creat context option true socket socket socket ctx socket factori creat socket address port local address local port string suit filter cipher suit socket support cipher suit option cipher suit socket set enabl cipher suit suit return socket creat socket connect ani local address public static socket socket encrypt option option inet address address int port throw context ctx creat context option true socket socket socket ctx socket factori creat socket address port string suit filter cipher suit socket support cipher suit option cipher suit socket set enabl cipher suit suit return socket creat socket public static socket socket encrypt option option throw context ctx creat context option true socket socket socket ctx socket factori creat socket string suit filter cipher suit socket support cipher suit option cipher suit socket set enabl cipher suit suit return socket public static context creat context encrypt option option boolean build truststor throw file input stream tsf null file input stream ksf null context ctx tri ctx context instanc option protocol trust manag trust manag null build truststor tsf file input stream option truststor trust manag factori tmf trust manag factori instanc option algorithm key store key store instanc option store type load tsf option truststor password char array tmf init trust manag tmf trust manag ksf file input stream option keystor key manag factori kmf key manag factori instanc option algorithm key store key store instanc option store type load ksf option keystor password char array kmf init option keystor password char array ctx init kmf key manag trust manag null catch throw error creat initi context final file util close quiet tsf file util close quiet ksf return ctx privat static string filter cipher suit string support string desir set string des set hash set desir set string return set intersect set hash set support des des size return size logger warn filter isnt support socket string util join set differ des return return return array string return size 