licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra auth import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra config databas descriptor import org apach cassandra cql untyp result set import org apach cassandra cql queri processor import org apach cassandra request execut import org apach cassandra servic migrat manag public class auth privat static final logger logger logger factori logger auth class public static final string cassandra public static final string system auth public static final string user check usernam store param usernam usernam queri return cassandra user public static boolean exist user string usernam string queri string format escap usernam tri return queri processor process queri empti catch request execut throw runtim check user superus param usernam usernam queri return true user superus fals aren don exist public static boolean superus string usernam string queri string format super escap usernam tri untyp result set result queri processor process queri return result empti result boolean super catch request execut throw runtim insert user overwrit superus status result queri param usernam usernam insert param super user status public static void insert user string usernam boolean super throw request execut queri processor process string format super escap usernam super delet user param usernam usernam delet public static void delet user string usernam throw request execut queri processor process string format escap usernam set authent author public static void setup authent setup author setup regist custom migrat listen permiss cleanup drop keyspac cfs migrat manag instanc regist migrat listen set default superus public static void setup superus tri insert default superus empti queri processor process string format empti insert user true catch request execut logger warn skip default superus setup node readi onli worri charact proper escap privat static string escap string return string util replac privat static authent authent return databas descriptor authent privat static author author return databas descriptor author 