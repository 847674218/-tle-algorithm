licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java util import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra auth import org apach cassandra config databas descriptor import org apach cassandra config schema import org apach cassandra system tabl import org apach cassandra tabl import org apach cassandra authent import org apach cassandra invalid request import org apach cassandra unauthor import org apach cassandra util semant version state relat client connect public class client state privat static final logger logger logger factori logger client state class public static final semant version org apach cassandra cql queri processor privat static final set resourc hash set resourc privat static final set resourc hash set resourc static system cfs alway readabl sinc mani tool reli nodetool cqlsh bulkload string cfs string system tabl system tabl system tabl system tabl system tabl string cfs add data resourc column famili tabl add databas descriptor authent protect resourc add databas descriptor author protect resourc current user session privat volatil authent user user privat string keyspac privat semant version cql version intern call mark client state intern compon abil modifi system keyspac privat final boolean intern call public client state fals construct empti client state public client state boolean intern call intern call intern call databas descriptor authent requir authent user authent user public string raw keyspac return keyspac public string keyspac throw invalid request keyspac null throw invalid request keyspac specifi return keyspac public void set keyspac string throw invalid request schema instanc meta data null throw invalid request keyspac doe exist keyspac attempt login client credenti map public void login map string string credenti throw authent authent user user databas descriptor authent authent credenti user anonym auth exist user user throw authent string format user doesn exist creat queri user user user public void keyspac access permiss perm throw unauthor invalid request intern call return valid login ensur permiss perm data resourc root public void keyspac access string keyspac permiss perm throw unauthor invalid request access keyspac perm data resourc keyspac keyspac public void column famili access string keyspac string column famili permiss perm throw unauthor invalid request access keyspac perm data resourc column famili keyspac column famili privat void access string keyspac permiss perm data resourc resourc throw unauthor invalid request valid keyspac keyspac intern call return valid login prevent system schema modif keyspac perm perm equal permiss resourc return resourc throw unauthor string format resourc inaccess resourc ensur permiss perm resourc public void ensur permiss permiss perm resourc resourc throw unauthor resourc resourc chain resourc author perm return throw unauthor string format user permiss ani parent user perm resourc privat void prevent system schema modif string keyspac permiss perm throw unauthor schema system keyspac keyspac case perm equal permiss perm equal permiss throw unauthor keyspac keyspac user modifi public void valid login throw unauthor user null throw unauthor log public void ensur anonym throw unauthor valid login user anonym throw unauthor log perform queri privat static void valid keyspac string keyspac throw invalid request keyspac null throw invalid request set keyspac session public void set version string str throw invalid request semant version version tri version semant version str catch illeg argument throw invalid request messag semant version cql org apach cassandra cql queri processor semant version cql org apach cassandra cql queri processor incompat chang beta final becaus beta don support beta reject semant version cql beta semant version beta version equal cql beta throw invalid request string format syntax break chang beta main syntax option beta support pleas upgrad version support cql cql version cql els version support cql cql version cql els throw invalid request string format provid version support server support version string util join support version public authent user user return user public semant version version return cql version public static semant version support version semant version cql org apach cassandra cql queri processor semant version cql org apach cassandra cql queri processor return semant version cql cql privat set permiss author resourc resourc return databas descriptor author author user resourc 