licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra hadoop import java file import java import java net inet address import java nio byte buffer import java net unknown host import java util import java util concurr time unit import java util concurr timeout import org slf logger import org slf logger factori import org apach cassandra auth authent import org apach cassandra config config import org apach cassandra config databas descriptor import org apach cassandra marshal abstract type import org apach cassandra marshal byte type import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra sstabl tabl loader import org apach cassandra sstabl tabl simpl unsort writer import org apach cassandra thrift import org apach cassandra util output handler import org apach hadoop conf configur import org apach hadoop mapreduc record writer import org apach hadoop mapreduc task attempt context import org apach thrift protocol import org apach thrift transport frame transport import org apach thrift transport socket import org apach thrift transport transport import org apach thrift transport transport final class bulk record writer extend record writer byte buffer list mutat implement org apach hadoop mapr record writer byte buffer list mutat privat final static string mapreduc output bulkoutputformat localdir privat final static string mapreduc output bulkoutputformat buffers privat final static string mapreduc output bulkoutputformat streamthrottlembit privat final static string mapreduc output bulkoutputformat maxfailedhost privat final configur conf privat final logger logger logger factori logger bulk record writer class privat tabl simpl unsort writer writer privat tabl loader loader privat file outputdir privat progress progress privat int max failur privat enum type privat enum col type privat type type privat col type col type bulk record writer task attempt context context throw context configur progress progress context bulk record writer configur conf progress progress throw conf progress progress bulk record writer configur conf throw config set load yaml fals config set outbound bind ani true conf conf databas descriptor set stream throughput outbound megabit sec integ pars int conf max failur integ pars int conf privat string output locat throw string dir conf system properti java tmpdir dir null throw output directori defin hadoop set java tmpdir defin return dir privat void set type mutat mutat type null mutat column supercolumn set super column mutat column supercolumn set counter super column type type els type type mutat column supercolumn set counter column mutat column supercolumn set counter super column col type col type els col type col type privat void prepar writer throw outputdir null string keyspac config helper output keyspac conf dir loader outputdir file output locat file separ keyspac file separ config helper output column famili conf outputdir mkdir writer null abstract type subcompar null extern client extern client null string usernam config helper output keyspac user conf string password config helper output keyspac password conf type type subcompar byte type instanc writer tabl simpl unsort writer outputdir config helper output partition conf config helper output keyspac conf config helper output column famili conf byte type instanc subcompar integ pars int conf config helper output compress paramat conf extern client extern client config helper output initi address conf config helper output rpc port conf usernam password loader tabl loader outputdir extern client null output handler overrid public void write byte buffer keybuff list mutat valu throw set type valu prepar writer writer row keybuff mutat mut valu type type writer super column mut column supercolumn super column col type col type counter column column mut column supercolumn counter super column column writer add counter column column column valu els column column mut column supercolumn super column column column ttl writer add column column column valu column timestamp els writer add expir column column column valu column timestamp column ttl system current time milli long column ttl els col type col type writer add counter column mut column supercolumn counter column mut column supercolumn counter column valu els mut column supercolumn column ttl writer add column mut column supercolumn column mut column supercolumn column valu mut column supercolumn column timestamp els writer add expir column mut column supercolumn column mut column supercolumn column valu mut column supercolumn column timestamp mut column supercolumn column ttl system current time milli long mut column supercolumn column ttl progress progress overrid public void close task attempt context context throw interrupt close fill deprec record writer interfac stream deprec public void close org apach hadoop mapr report report throw close privat void close throw writer null writer close tabl loader loader futur futur loader stream true tri futur time unit break catch timeout progress progress catch interrupt throw futur failur futur fail host size max failur throw mani host fail futur fail host els logger warn host fail futur fail host static class extern client extend tabl loader client privat final map string set string cfs hash map string set string privat final string hostlist privat final int rpc port privat final string usernam privat final string password public extern client string hostlist int port string usernam string password super hostlist hostlist rpc port port usernam usernam password password public void init string keyspac set inet address host hash set inet address string node hostlist split string node node tri host add inet address node catch unknown host throw runtim iter inet address hostit host iter hostit tri inet address host hostit cassandra client client creat thrift client host host address rpc port log client set keyspac keyspac usernam null map string string cred hash map string string cred put authent usernam cred put authent password authent request auth request authent request cred client login auth request list token rang token rang client describ ring keyspac list def def client describ keyspac set partition client describ partition token token factori factori partition token factori token rang token rang rang token rang rang token factori string start token factori string token string endpoint add rang endpoint rang inet address def def def set string cfs hash set string def def def def cfs add def cfs put def cfs break catch hostit throw runtim retriev endpoint rang public boolean valid column famili string keyspac string set string cfs cfs keyspac return cfs null cfs privat static cassandra client creat thrift client string host int port throw transport socket socket socket host port transport tran frame transport socket tran open protocol protocol org apach thrift protocol binari protocol tran return cassandra client protocol static class null output handler implement output handler public void output string msg public void debug string msg public void warn string msg public void warn string msg throwabl 