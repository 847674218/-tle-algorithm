licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java nio byte buffer import java util import googl common base function import googl common collect abstract iter import googl common collect list import org apach cassandra filter column slice import org apach cassandra index secondari index manag import org apach cassandra marshal abstract type import org apach cassandra util alloc sort column array list implement synchron onli thread safeti requir implement sens main oper perform iter map ad column especi insert sort order public class array sort column extend abstract thread unsaf sort column implement sort column privat final abstract type compar privat final boolean revers privat final array list column column public static final sort column factori factori factori public sort column creat abstract type compar boolean insert revers return array sort column compar insert revers public sort column sort sort map byte buffer column sort map boolean insert revers return array sort column sort map valu abstract type sort map compar insert revers public static sort column factori factori return factori privat array sort column abstract type compar boolean revers super compar compar revers revers column array list column privat array sort column collect column column abstract type compar boolean revers compar compar revers revers column array list column column public sort column factori factori return factori public abstract type compar return compar public sort column clone return array sort column column compar revers public boolean insert revers return revers privat compar byte buffer intern compar return revers compar revers compar compar public column column byte buffer int pos binari search return pos column pos null add column throw column ad doe sort column map reason implement slower insert unsort order onli insert method sort order assert throw protect perform regress revisit decis case insert sort order public void add column column column alloc alloc column empti column add column return fast path insert tail int intern compar compar column size column note assert add column javadoc assert disabl add column work correct unsort input assert ad column doe sort revers column insert column add column els resolv resolv size column alloc els int pos binari search column pos resolv pos column alloc els column add pos column resolv element posit assum valid posit privat void resolv int column column alloc alloc column column column column instanceof super column deleg super column assert column instanceof super column super column column put column super column column alloc els calcul reconcil col exist col col column reconcil column column reconcil column alloc column set reconcil column privat int binari search byte buffer return binari search column intern compar simpl binari search column return valu exact collect binari search don collect binari search direct becaus requir creat fake column column compar search ugli privat static int binari search list column column compar byte buffer compar byte buffer int start int start int mid column size int high mid int result high mid high result compar compar column mid mid els result return mid els high mid return mid result public long add size delta sort column alloc alloc function column column transform secondari index manag updat index throw unsupport oper public void add sort column alloc alloc function column column transform delet delet info empti return column copi column array column size int idx iter column revers revers iter column slice iter column column column clear idx copi length column null int intern compar compar copi idx column column add copi idx idx els column add transform appli column column null els column add copi idx resolv size transform appli column alloc idx column null idx copi length column add copi idx column null column add transform appli column column null public boolean replac column column column column column equal column throw illeg argument int pos binari search column pos column set pos column return pos public collect column sort column return revers revers sort collect column public collect column revers sort column revers element sort revers expect return redefin iter sort order collect super constructor return revers sort collect revers sort collect public void remov column byte buffer int pos binari search pos column remov pos public int size return column size public void clear column clear public sort set byte buffer column memoiz creat set unlik call method lot object return column set public iter column iter return revers list revers column iter column iter public iter column iter column slice slice return slice iter column compar slice revers public iter column revers iter column slice slice return slice iter column compar slice revers privat static class slice iter extend abstract iter column privat final list column list privat final column slice slice privat final compar byte buffer compar privat int idx privat int previous slice privat iter column current slice public slice iter list column list abstract type compar column slice slice boolean revers list revers list revers list list slice slice compar revers compar revers compar compar protect column comput current slice null idx slice length return data column slice slice slice idx idx includ int start idx slice start remain binari search list compar slice start previous slice start idx start idx start idx idx exclud int finish idx slice finish remain list size binari search list compar slice finish previous slice finish idx finish idx els finish idx finish idx start idx finish idx list size current slice list iter els current slice list list start idx finish idx iter previous slice finish idx finish idx current slice return current slice current slice null return comput privat class revers sort collect extend abstract collect column public int size return column size public iter column iter return iter column int idx size public boolean return idx public column return column idx public void remov column remov idx privat class sort collect extend abstract collect column public int size return column size public iter column iter return column iter privat class column set extend abstract set byte buffer implement sort set byte buffer public int size return column size public iter byte buffer iter final iter column outer iter array sort column iter handl revers return iter byte buffer public boolean return outer iter public byte buffer return outer iter public void remov outer iter remov public compar byte buffer compar return compar public byte buffer final array sort column outer list array sort column outer list empti throw element return outer list column outer list revers size public byte buffer final array sort column outer list array sort column outer list empti throw element return outer list column outer list revers size fair hard implement head set tail set set respect specif part return set set chang return set reflect set vice versa simpli upper index array list wouldn ensur properti sinc function prefer return unsupport oper revisit aris public sort set byte buffer head set byte buffer element throw unsupport oper head set public sort set byte buffer tail set byte buffer element throw unsupport oper head set public sort set byte buffer set byte buffer element byte buffer element throw unsupport oper 