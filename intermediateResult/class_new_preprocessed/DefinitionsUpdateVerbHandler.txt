licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java util collect import org slf logger import org slf logger factori import org apach cassandra concurr stage import org apach cassandra concurr stage manag import org apach cassandra net verb handler import org apach cassandra net messag import org apach cassandra net messag servic import org apach cassandra util wrap runnabl call node receiv updat schema state schema migrat coordin node happen user local schema migrat node ring act coordin node send push updat schema state form row mutat aliv node cluster public class definit updat verb handler implement verb handler collect row mutat privat static final logger logger logger factori logger definit updat verb handler class public void verb final messag collect row mutat messag string logger debug receiv schema mutat push messag stage manag stage stage submit wrap runnabl public void run throw throw messag version messag servic logger error accept schema migrat cassandra version previous pleas upgrad return def tabl merg schema messag payload 