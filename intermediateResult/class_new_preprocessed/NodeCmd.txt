licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra tool import java import java input stream import java print stream import java lang manag memori usag import java net connect import java net inet address import java net unknown host import java text decim format import java util import java util map entri import java util concurr execut import googl common collect link hash multimap import googl common collect map import org apach common cli import org yaml snakeyaml loader import org yaml snakeyaml type descript import org yaml snakeyaml yaml import org yaml snakeyaml constructor constructor import org apach cassandra concurr enabl thread pool executor bean import org apach cassandra column famili store bean import org apach cassandra tabl import org apach cassandra compact compact manag bean import org apach cassandra compact oper type import org apach cassandra configur import org apach cassandra util file util import org apach cassandra locat endpoint snitch info bean import org apach cassandra net messag servic bean import org apach cassandra servic cach servic bean import org apach cassandra servic predict result import org apach cassandra servic predictor bean import org apach cassandra servic storag proxi bean import org apach cassandra util estim histogram import org apach cassandra util pair public class node cmd privat static final pair string string pair creat column famili privat static final pair string string pair creat host privat static final pair string string pair creat port privat static final pair string string pair creat usernam privat static final pair string string pair creat password privat static final pair string string pair creat tag privat static final pair string string pair creat token privat static final pair string string pair creat partition rang privat static final pair string string pair creat snapshot snapshot privat static final pair string string pair creat local local privat static final string privat static final int privat static final tool option option tool option privat final node probe probe static option add option true onli snapshot specifi column famili option add option true node hostnam address option add option true remot jmx agent port number option add option true remot jmx agent usernam option add option true remot jmx agent password option add option true option give snapshot option add option fals display token option add option fals onli repair rang return partition node option add option fals repair node time snapshot option add option fals onli repair node datacent public node cmd node probe probe probe probe privat enum node command print usag inform stdout privat static void print usag formatt formatt string builder header string builder header append avail command final node tool load node tool node tool command cmd command add cmd header cmd string usag string format java host arg command node cmd class print usag option system println header string privat static node tool load final input stream node cmd class class loader resourc stream org apach cassandra tool node tool yaml assert null tri final constructor constructor constructor node tool class type descript desc type descript node tool class desc put list properti type command node tool node tool command class final yaml yaml yaml loader constructor return node tool yaml load final file util close quiet privat static void add cmd string builder node tool node tool command cmd append append cmd ghetto indent tri hard bad cmd length int cmd length append append append cmd write textual represent cassandra ring param stream write public void print ring print stream string keyspac map string string token endpoint probe token endpoint map link hash multimap string string endpoint token link hash multimap creat map entri string string entri token endpoint entri set endpoint token put entri valu entri key string format calcul token ownership ring map inet address float ownership boolean keyspac select tri ownership probe effect ownership keyspac keyspac select true catch illeg state ownership probe ownership printf note ownership inform doe includ topolog complet inform specifi keyspac keyspac select fals tri println map string map inet address float ownership map link hash map differ dataset map token map entri inet address float ownership ownership entri set string probe endpoint snitch info proxi datacent ownership key host address ownership key ownership put link hash map inet address float ownership put ownership key ownership valu map entri string map inet address float entri ownership entri set print format entri key endpoint token keyspac select entri valu catch unknown host throw runtim privat void print print stream string format string link hash multimap string string endpoint token boolean keyspac select map inet address float filter ownership collect string live node probe live node collect string dead node probe unreach node collect string join node probe join node collect string leav node probe leav node collect string move node probe move node map string string load map probe load map println datacent println total amount replica token ring list string token array list string float total replica string token map entri inet address float entri filter ownership entri set token add endpoint token entri key host address token token token size total replica entri valu keyspac select print replica int total replica printf format address rack status state load token filter ownership size printf format token els println map entri inet address float entri filter ownership entri set string endpoint entri key host address string token endpoint token endpoint string rack tri rack probe endpoint snitch info proxi rack endpoint catch unknown host rack unknown string status live node endpoint dead node endpoint string state normal join node endpoint state join els leav node endpoint state leav els move node endpoint state move string load load map key endpoint load map endpoint string decim format format entri valu printf format endpoint rack status state load token println privat class cluster status string space null format null collect string join node leav node move node live node unreach node map string string load map host map token endpoint endpoint snitch info bean snitch info print stream cluster status print stream string space space space join node probe join node leav node probe leav node move node probe move node load map probe load map token endpoint probe token endpoint map live node probe live node unreach node probe unreach node host map probe host map snitch info probe endpoint snitch info proxi privat void print status legend println status println state normal leav join move privat map string map inet address float ownership map inet address float ownership throw unknown host map string map inet address float ownership map link hash map endpoint snitch info bean snitch info probe endpoint snitch info proxi map entri inet address float ownership ownership entri set string snitch info datacent ownership key host address ownership key ownership put link hash map inet address float ownership put ownership key ownership valu return ownership privat string format boolean effect boolean token node format null string buffer buf string buffer buf append status address load token node buf append token effect buf append effect els buf append buf append host token node buf append token buf append rack format buf string return format privat void print node string endpoint float map inet address float ownership boolean effect boolean token node throw unknown host string status state load str host rack fmt fmt format effect token node live node endpoint status els unreach node endpoint status els status join node endpoint state els leav node endpoint state els move node endpoint state els state load load map key endpoint load map endpoint str decim format format ownership inet address endpoint host host map endpoint rack snitch info rack endpoint token node printf fmt status state endpoint load str host probe token endpoint rack els int token probe token endpoint size printf fmt status state endpoint load token str host rack privat void print node header boolean effect boolean token node string fmt format effect token node string effect effect token node printf fmt address load host token rack els printf fmt address load token host rack void print throw unknown host map inet address float ownership boolean effect fals token node true tri ownership probe effect ownership space effect true catch illeg state ownership probe ownership token node aka vnode hash set string token endpoint valu size token endpoint key set size token node fals datacent map entri string map inet address float ownership ownership entri set string header string format datacent key printf header int header length print println print status legend print node header effect token node node map entri inet address float entri valu entri set print node entri key host address entri valu ownership effect token node write tabl cluster wide node inform print stream throw unknown host public void print cluster status print stream string keyspac throw unknown host cluster status keyspac print public void print thread pool stat print stream printf pool activ pend complet block time block iter map entri string enabl thread pool executor bean thread probe thread pool bean proxi thread entri string enabl thread pool executor bean thread thread string pool thread key enabl thread pool executor bean thread pool proxi thread valu printf pool thread pool proxi activ count thread pool proxi pend task thread pool proxi complet task thread pool proxi current block task thread pool proxi total block task printf messag type drop entri string integ entri probe drop messag entri set printf entri key entri valu write node inform param stream write public void print info print stream tool command line cmd boolean gossip initi probe initi list string tok probe token token print alway otherwis requir token pass output potenti verbos tok size printf token tok els cmd option left printf invok token token token tok size printf probe local host printf gossip activ gossip initi printf thrift activ probe thrift server run printf load probe load string gossip initi printf generat probe current generat number els printf generat uptim long probe uptim printf uptim memori usag memori usag heap usag probe heap memori usag doubl mem doubl heap usag doubl mem max doubl heap usag max printf heap memori mem mem max data center rack printf data center probe data center printf rack probe rack printf probe count cach servic bean cach servic probe cach servic bean key cach hit request hit rate save period printf size byte capac byte hit request hit rate save period key cach cach servic key cach size cach servic key cach capac byte cach servic key cach hit cach servic key cach request cach servic key cach hit rate cach servic key cach save period row cach hit request hit rate save period printf size byte capac byte hit request hit rate save period row cach cach servic row cach size cach servic row cach capac byte cach servic row cach hit cach servic row cach request cach servic row cach hit rate cach servic row cach save period tok size cmd option left string tok tok printf token tok public void print releas version print stream println releas version probe releas version public void print network stat final inet address addr print stream printf mode probe oper mode set inet address host addr null probe stream destin hash set inet address add addr host size println send ani stream inet address host host tri list string file probe file destin host file size printf stream host string file file printf file els printf noth stream host catch printf error retriev file data host host addr null probe stream sourc hash set inet address add addr host size println receiv ani stream inet address host host tri list string file probe incom file host file size printf stream host string file file printf file els printf noth stream host catch printf error retriev file data host messag servic bean probe proxi printf pool printf activ printf pend printf complet int pend long complet pend int command pend task valu pend complet long command complet task valu complet printf command pend complet pend int respons pend task valu pend complet long respons complet task valu complet printf respons pend complet public void print compact stat print stream int compact throughput probe compact throughput compact manag bean probe compact manag proxi println pend task pend task compact size printf compact type keyspac column famili complet total unit progress long remain byte map string string compact string percent complet long total decim format format doubl long complet long total printf task type keyspac columnfamili complet total unit percent complet task type equal oper type string remain byte long total long complet long remain time sec compact throughput remain byte remain byte long compact throughput string remain time remain time sec string format remain time sec remain time sec remain time sec printf activ compact remain time remain time public void print column famili stat print stream map string list column famili store bean cfstore map hash map string list column famili store bean list column famili store iter map entri string column famili store bean cfamili probe column famili store bean proxi cfamili entri string column famili store bean entri cfamili string tabl entri key column famili store bean cfs proxi entri valu cfstore map key tabl list column famili store bean column famili array list column famili store bean column famili add cfs proxi cfstore map put tabl column famili els cfstore map tabl add cfs proxi print tabl statist entri string list column famili store bean entri cfstore map entri set string tabl entri key list column famili store bean column famili entri valu long tabl read count long tabl write count int tabl pend task doubl tabl total read time doubl tabl total write time println keyspac tabl column famili store bean cfstore column famili long write count cfstore write count long read count cfstore read count read count tabl read count read count tabl total read time cfstore total read latenc micro write count tabl write count write count tabl total write time cfstore total write latenc micro tabl pend task cfstore pend task doubl tabl read latenc tabl read count tabl total read time tabl read count doubl doubl tabl write latenc tabl write count tabl total write time tabl write count doubl println read count tabl read count println read latenc string format tabl read latenc println write count tabl write count println write latenc string format tabl write latenc println pend task tabl pend task print column famili statist tabl column famili store bean cfstore column famili println column famili cfstore column famili println tabl count cfstore live tabl count int level stabl cfstore tabl count level level stabl null print tabl level int level level level stabl length level int count level stabl level print count long max count level max count long math pow level show max threshold level exceed count max count print max count level level stabl length print els println println space live cfstore live disk space println space total cfstore total disk space println number key estim cfstore estim key println memtabl column count cfstore memtabl column count println memtabl data size cfstore memtabl data size println memtabl switch count cfstore memtabl switch count println read count cfstore read count println read latenc string format cfstore read latenc micro println write count cfstore write count println write latenc string format cfstore write latenc micro println pend task cfstore pend task println bloom filter fals posit cfstore bloom filter fals posit println bloom filter fals ratio string format cfstore bloom filter fals ratio println bloom filter space cfstore bloom filter disk space println compact row minimum size cfstore min row size println compact row maximum size cfstore max row size println compact row size cfstore row size println println public void print remov status print stream println remov status probe remov status privat void print histogram string key space string column famili print stream output column famili store bean store probe cfs proxi key space column famili default offset long offset estim histogram bucket offset long rrlh store read latenc histogram micro long rwlh store write latenc histogram micro long sprh store tabl read histogram long ersh store estim row size histogram long ecch store estim column count histogram output println string format histogram key space column famili output println string format offset tabl write latenc read latenc row size column count int offset length output println string format offset sprh length sprh rwlh length rwlh rrlh length rrlh ersh length ersh ecch length ecch privat void print proxi histogram print stream output storag proxi bean probe proxi long offset estim histogram bucket offset long rrlh read latenc histogram micro long rwlh write latenc histogram micro long rrnglh rang latenc histogram micro output println proxi histogram output println string format offset read latenc write latenc rang latenc int offset length output println string format offset rrlh length rrlh rwlh length rwlh rrnglh length rrnglh privat void print point string key space string string key print stream output list inet address endpoint probe endpoint key space key inet address endpoint endpoint output println endpoint host address privat void print tabl string keyspac string string key print stream output list string sstabl probe tabl keyspac key string sstabl sstabl output println sstabl privat void print thrift server run print stream println probe thrift server run run run public void predict consist integ replic factor integ time write integ num version float percentil latenc print stream output predictor bean predictor bean probe predictor bean int replic factor int replic factor replic factor continu tri predict result result predictor bean predict replic factor time write num version percentil latenc output printf dms write maximum version stale time write num version output printf replic factor output printf probabl consist read result consist probabl output printf averag read latenc fms fth ile dms result averag read latenc result percentil read latenc percentil result percentil read latenc valu output printf averag write latenc fms fth ile dms result averag write latenc result percentil write latenc percentil result percentil write latenc valu catch system println messag print stack trace return public static void main string arg throw interrupt configur pars command line parser parser posix parser tool command line cmd null tri cmd tool command line parser pars option arg catch pars bad messag string host cmd option left cmd option valu left int port string port num cmd option valu left port num null tri port integ pars int port num catch number format throw pars port number string usernam cmd option valu left string password cmd option valu left node probe probe null tri probe usernam null node probe host port node probe host port usernam password catch ioe throwabl find innermost throwabl ioe instanceof connect system err printf fail connect host port messag system exit els instanceof unknown host system err printf resolv unknown host host system exit els err ioe error connect remot agent tri node command command null tri command cmd command catch illeg argument bad messag node cmd node cmd node cmd probe execut request command string argument cmd command argument string tag string column famili null switch command case print usag break case argument length node cmd print ring system argument els node cmd print ring system null break case node cmd print info system cmd break case node cmd print column famili stat system break case node cmd print thread pool stat system break case node cmd print releas version system break case node cmd print compact stat system break case probe stop gossip break case probe start gossip break case probe disabl hint handoff break case probe enabl hint handoff break case probe paus hint deliveri break case probe resum hint deliveri break case probe stop thrift server break case probe start thrift server break case node cmd print thrift server run system break case probe reset local schema break case argument length node cmd print cluster status system argument els node cmd print cluster status system null break case argument length system err println decommiss decommiss node connect doe argument system exit probe decommiss break case tri probe drain catch execut err error occur dure flush break case argument length node cmd print network stat inet address argument system els node cmd print network stat null system break case column famili cmd option valu left case tag cmd option valu left handl snapshot command tag argument column famili probe break case argument length bad token argument move tri probe move argument catch unsupport oper uoerror system err println uoerror messag system exit break case probe join system err println node alreadi join ring system exit probe join ring break case argument length bad valu argument probe set compact throughput integ pars int argument break case argument length bad valu argument probe set stream throughput integ pars int argument break case argument length bad valu argument probe set trace probabl doubl pars doubl argument break case argument length bad mani argument probe rebuild argument length argument null break case system err println warn removetoken deprec pleas removenod case argument length bad argument removenod status forc els argument equal status node cmd print remov status system els argument equal forc node cmd print remov status system probe forc remov complet els probe remov node argument break case probe invalid key cach break case probe invalid row cach break case case case case case case option sand command cmd argument probe break case argument length bad getcompactionthreshold requir arg probe compact threshold system argument argument break case argument length bad cfhistogram requir arg node cmd print histogram argument argument system break case argument length bad setcachecapac requir key cach capac row cach capac arg probe set cach capac integ pars int argument integ pars int argument break case argument length bad setcompactionthreshold requir min max threshold arg int minthreshold integ pars int argument int maxthreshold integ pars int argument minthreshold maxthreshold bad threshold posit integ minthreshold maxthreshold bad min threshold greater max minthreshold maxthreshold bad min threshold probe set compact threshold argument argument minthreshold maxthreshold break case argument length bad getendpoint requir key arg node cmd print point argument argument argument system break case argument length bad proxyhistogram doe argument node cmd print proxi histogram system break case argument length bad getsstabl requir key arg node cmd print tabl argument argument argument system break case argument length bad load sstabl requir arg probe load tabl argument argument break case argument length bad rebuild index requir arg argument length probe rebuild index argument argument argument split els probe rebuild index argument argument break case node cmd print gossip info system break case argument length bad stop requir type probe stop argument upper case break case argument length bad keyspac argument describ node cmd print describ ring argument system break case node cmd print rang key sampl system break case argument length bad requir replic factor time int num version argument length num version integ pars int argument float percentil latenc argument length percentil latenc float pars float argument node cmd predict consist integ pars int argument integ pars int argument num version percentil latenc system break default throw runtim unreach code final probe null tri probe close catch swallow user real system exit privat static throwabl find innermost throwabl throwabl throwabl caus return null find innermost throwabl privat void print describ ring string keyspac print stream println schema version probe schema version println token rang tri string token rang string probe describ ring keyspac println token rang string catch err messag privat void print rang key sampl print stream println rang key sampl list string token string probe sampl key rang string token string token string println token string privat void print gossip info print stream println probe gossip info privat static void bad string str system err println str print usag system exit privat static void err string err str system err println err str print stack trace system exit privat static void complain nonzero arg string arg node command cmd arg length system err println mani argument command cmd string print usag system exit privat static void handl snapshot node command string tag string cmd arg string column famili node probe probe throw interrupt string keyspac array copi rang cmd arg cmd arg length system print request snapshot keyspac length int keyspac length system print keyspac els system print keyspac column famili null system print column famili column famili system println switch case tag null tag equal tag long system current time milli string probe snapshot tag column famili keyspac system println snapshot directori tag break case probe clear snapshot tag keyspac break privat static void option sand node command tool command line cmd string cmd arg node probe probe throw interrupt addit arg keyspac columnfamili list string keyspac cmd arg length probe keyspac array list cmd arg string keyspac keyspac probe keyspac keyspac system err println keyspac keyspac doe exist system exit loop die halfway due invalid keyspac string keyspac keyspac string column famili cmd arg length string array copi rang cmd arg cmd arg length switch case boolean snapshot cmd option left boolean local cmd option left boolean primari rang cmd option left probe forc repair async system keyspac snapshot local primari rang column famili break case tri probe forc tabl flush keyspac column famili catch execut err error occur dure flush break case tri probe forc tabl compact keyspac column famili catch execut err error occur dure compact break case keyspac equal tabl break skip cleanup system cfs tri probe forc tabl cleanup keyspac column famili catch execut err error occur dure cleanup break case tri probe scrub keyspac column famili catch execut err error occur scrub keyspac keyspac break case tri probe upgrad tabl keyspac column famili catch execut err error occur upgrad sstabl keyspac keyspac break default throw runtim unreach code privat static class tool option extend option public void add option pair string string opt boolean argument string descript add option opt argument descript fals public void add option pair string string opt boolean argument string descript boolean requir add option opt left opt argument descript requir public void add option string opt string long opt boolean argument string descript boolean requir option option option opt long opt argument descript option set requir requir add option option privat static class tool command line privat final command line command line public tool command line command line command command line command public option option return command line option public boolean option string opt return command line option opt public string option valu string opt return command line option valu opt public node command command command line arg length throw illeg argument command specifi string command command line arg tri return node command valu command upper case catch illeg argument throw illeg argument unrecogn command command public string command argument list param command line arg list param size command paramet empti return string string return string param size int param size string parm string param whi parm start parm parm substr return parm return return 