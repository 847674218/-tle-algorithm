licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import java nio byte buffer import java util import googl common collect array list multimap import org apach cassandra cql import org apach cassandra config meta data import org apach cassandra cql oper column oper import org apach cassandra cql oper oper import org apach cassandra cql oper set oper import org apach cassandra cql oper prepar oper import org apach cassandra import org apach cassandra marshal import org apach cassandra import org apach cassandra util byte buffer util import org apach cassandra util pair import static org apach cassandra cql queri processor valid key import static org apach cassandra thrift thrift valid valid column famili code code statement pars queri statement public class updat statement extend modif statement privat definit def privat final list pair column identifi oper column privat final list column identifi column privat final list oper column oper privat final list relat claus privat final array list multimap definit oper process column array list multimap creat privat final map column identifi list term process key hash map column identifi list term creat updat statement column famili column map consist level key term param column famili oper param column map column valu pair param claus claus param attr addit attribut statement timestamp time live public updat statement list pair column identifi oper column list relat claus attribut attr super attr column column claus claus column null column oper null creat updat statement column famili consist level key list column valu intend altern updat format code code param column famili oper param column list column param column oper list column set oper correspond param attr addit attribut statement timestamp time live public updat statement attribut attr list column identifi column list oper column oper super attr column column column oper column oper claus null column null protect void valid consist consist level throw invalid request type type valid counter write def cfm els valid write def cfm inherit doc public collect mutat mutat list byte buffer variabl boolean local consist level long throw request execut request valid list byte buffer key build key def process key variabl column builder builder def column builder build column def process key builder variabl true list oper incur read set byte buffer read null map entri definit oper entri process column entri definit entri key oper valu entri valu type instanceof list type continu valu requir read type read null read tree set byte buffer type instanc read add key map byte buffer column group map row read null read row key builder read composit type def cfm compar local null collect mutat mutat link list mutat updat paramet param updat paramet variabl timestamp time live byte buffer key key mutat add mutat key def key builder param row null null row key return mutat return empti compon null static definit build column definit def map column identifi list term process column builder builder list byte buffer variabl boolean requir compon throw invalid request definit empti null definit def column valu list term valu process valu null valu empti empti requir compon def composit def compact throw invalid request string format mandatori part els empti null throw invalid request string format part sinc set empti els assert valu size onli row key builder add valu relat type variabl return empti static list byte buffer build key definit def map column identifi list term process list byte buffer variabl throw invalid request column builder key builder def key builder list byte buffer key array list byte buffer definit def key valu list term valu process valu null valu empti throw invalid request string format mandatori part key builder remain count term valu key add key builder copi add relat type variabl build els valu size throw invalid request onli support column partit key key builder add valu relat type variabl return key comput row mutat singl key return row mutat throw invalid request wrong request privat mutat mutat key definit def byte buffer key column builder builder updat paramet param column group map group consist level throw invalid request valid key key queri processor valid key key row mutat row mutat def cfm key column famili add def cfm insert row marker alway insert marker becaus follow situat int text queri return row null ad marker insert semant correct doe remov row entir def composit def compact byte buffer builder copi add byte buffer util build add column param column byte buffer util def compact builder compon count throw invalid request string format part def column valu iter oper oper def valu null valu defin set empti valu oper column oper set empti els list oper oper process column def valu oper empti throw invalid request string format mandatori column def valu assert oper size oper oper oper execut builder copi def valu null null def valu type param null els map entri definit oper entri process column entri definit entri key oper entri valu execut builder copi add key type param group null requir read type null group collect key return type type counter mutat public pars statement prepar prepar column specif bound throw invalid request deal keyspac overwrit thingi avoid mistak meta data metadata valid column famili keyspac column famili def metadata def type metadata default valid commut type type column null creat type type throw invalid request statement counter tabl column size column oper size throw invalid request unmatch column valu column size throw invalid request column specifi int column size definit def column null throw invalid request string format unknown identifi column oper oper column oper oper add bound bound switch kind case case process key key throw invalid request string format multipl definit part collect accept key column alias oper type oper type oper type oper type throw invalid request string format invalid definit collect type process key put oper valu break case case process column key throw invalid request string format multipl definit column add oper oper break els creat pair column identifi oper entri column definit def entri left null throw invalid request string format unknown identifi entri left oper oper entri switch oper type case type type throw invalid request invalid counter oper counter tabl break case case case type collect throw invalid request appli collect oper column type type fallthrough purpos case type type throw invalid request invalid counter oper counter tabl break case type type prepar oper oper potenti counter oper throw invalid request invalid counter oper counter tabl break switch kind case case throw invalid request string format part part entri left case case oper process column type oper type throw invalid request string format multipl definit column oper add bound bound add oper oper break process key def claus process key bound return pars statement prepar array column specif list bound privat void add oper definit oper oper parser side unabl differenti empti map empti set add set oper fix actual type oper type oper type type instanceof map type oper set oper oper mayb convert empti map oper process column put oper public pars statement prepar prepar throw invalid request column specif column specif bound term return prepar reus delet statement static void process key definit def list relat key map column identifi list term process column specif throw invalid request relat rel key definit def rel entiti null throw invalid request string format unknown key identifi rel entiti switch kind case case list term valu rel oper relat type valu collect singleton list rel valu els kind definit kind rel oper relat type valu rel valu els throw invalid request string format invalid oper key rel oper rel entiti process key throw invalid request string format multipl definit part term valu valu valu bind marker valu bind index process put valu break case case throw invalid request string format part part rel entiti public string string return string format updat statement key column timestamp time live claus column set timestamp timestamp time live 