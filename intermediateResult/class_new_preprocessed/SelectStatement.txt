licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import java import java nio byte buffer import java util import java util concurr execut import googl common collect abstract iter import org slf logger import org slf logger factori import org apach cassandra auth permiss import org apach cassandra cql import org apach cassandra transport messag result messag import org apach cassandra config meta data import org apach cassandra config column definit import org apach cassandra configur import org apach cassandra import org apach cassandra context counter context import org apach cassandra filter import org apach cassandra index secondari index import org apach cassandra index secondari index manag import org apach cassandra marshal import org apach cassandra dht import org apach cassandra import org apach cassandra servic client state import org apach cassandra servic queri state import org apach cassandra servic rang slice verb handler import org apach cassandra servic storag proxi import org apach cassandra servic storag servic import org apach cassandra consist level import org apach cassandra thrift index express import org apach cassandra thrift index oper import org apach cassandra thrift thrift valid import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util pair import org apach cassandra util gen encapsul complet pars queri includ target column famili express result count order claus public class select statement implement statement privat static final logger logger logger factori logger select statement class privat final int bound term public final definit def public final paramet paramet privat final list pair definit selector select array list pair definit selector empti wildcard privat final restrict key restrict privat final restrict column restrict privat final map definit restrict metadata restrict hash map definit restrict privat restrict slice restrict privat boolean revers privat boolean token privat boolean key rang privat boolean key relat privat static enum bound public final int idx bound int idx idx idx public static bound revers bound return public select statement definit def int bound term paramet paramet def def bound term bound term key restrict restrict def key size column restrict restrict def column size paramet paramet public int bound term return bound term public void check access client state state throw invalid request unauthor state column famili access keyspac column famili permiss public void valid client state state throw invalid request noth valid raw statement prepar public result messag row execut consist level queri state state list byte buffer variabl throw request execut request valid null throw invalid request invalid empti consist level valid read keyspac tri list row row key rang storag proxi rang slice rang command variabl storag proxi read slice command variabl return process result row variabl catch throw runtim privat result messag row process result list row row list byte buffer variabl throw request valid count process result group column togeth spars column famili result set rset process row variabl rset paramet count rset count result rset return result messag row rset static list row read local string keyspac list read command cmds throw tabl tabl tabl open keyspac list row row array list cmds size read command cmd cmds row add cmd row tabl return row public result messag row execut intern queri state state throw request execut request valid tri list row row key rang rang slice verb handler execut local rang command collect byte buffer empti list read local keyspac slice command collect byte buffer empti list return process result row collect byte buffer empti list catch throw runtim catch execut throw runtim catch interrupt throw runtim public result set process list row row throw invalid request assert paramet count return process row collect byte buffer empti list public string keyspac return def cfm public string column famili return def cfm privat list read command slice command list byte buffer variabl throw request valid queri path queri path queri path column famili collect byte buffer key key variabl list read command command array list read command key size rang slice column column rang note total limit everi key potenti ineffici veri sensibl choic byte buffer key key queri processor valid key key note share slice filter command due slice queri filter immut due column counter count method fair ugli chang probabl tini refactor clean command add slice read command keyspac key queri path slice queri filter filter variabl list column els command share filter disk atom filter filter filter variabl byte buffer key key queri processor valid key key command add slice read command keyspac key queri path queri filter filter return command privat rang slice command rang command list byte buffer variabl throw request valid disk atom filter filter filter variabl list index express express index express variabl provid user number row return rang slice count number column number key return rang slice command keyspac column famili null filter key bound variabl express limit true fals privat abstract bound row posit key bound list byte buffer variabl throw invalid request partition storag servic partition abstract bound row posit bound token token start token token bound bound variabl token token token bound bound variabl row posit start includ key bound bound start token min key bound start token max key bound row posit includ key bound bound token max key bound token min key bound bound rang row posit start els byte buffer start key byte key bound bound variabl byte buffer finish key byte key bound bound variabl row posit start key row posit key start key byte row posit finish key row posit key finish key byte start key compar finish key finish key minimum preserv order throw invalid request start key sort befor equal finish key partition els throw invalid request start key sort key probabl specifi key random partition includ key bound bound bound includ key bound bound bound row posit start key finish key includ exclud bound row posit start key finish key els bound includ key bound bound rang row posit start key finish key exclud bound row posit start key finish key return bound privat disk atom filter filter list byte buffer variabl throw invalid request column rang spars defin column limit defin column includ row marker account group column sinc doesn work map set list composit group option slice queri filter preserv compat mix version cluster int multipli def compact def metadata size int group def compact def column size column slice slice column slice request bound bound variabl request bound bound variabl slice queri filter filter slice queri filter column slice slice revers limit group multipli queri processor valid slice filter def cfm filter return filter els sort set byte buffer column request column variabl queri processor valid column column return queri filter column true privat int limit intern don support exclus bound slice queri element necessari exclud return slice restrict null slice restrict inclus bound paramet limit integ paramet limit paramet limit privat collect byte buffer key final list byte buffer variabl throw invalid request list byte buffer key array list byte buffer column builder builder def key builder definit def key valu restrict key restrict posit assert null builder remain count term valu key add builder copi add relat type variabl build els valu size throw invalid request onli support column partit key builder add valu relat type variabl return key privat byte buffer key bound bound list byte buffer variabl throw invalid request return build bound def key valu key restrict revers def key builder variabl privat token token bound bound list byte buffer variabl partition throw invalid request assert token restrict key restrict key restrict term key restrict equal key restrict valu key restrict bound null return minimum token type term type token tri string text text token factori valid text return token factori string text catch configur throw invalid request messag assert token column builder builder def key builder key restrict set definit def key valu restrict key restrict posit builder add equal valu bound relat type variabl return token builder build privat boolean includ key bound bound restrict key restrict null return true els equal return inclus equal return true privat boolean column rang static entail column slice def compact def composit return fals howev collect alway entail def collect return true otherwis rang queri column alia relat defin restrict column restrict null equal return true return fals privat boolean wildcard return select empti privat sort set byte buffer request column list byte buffer variabl throw invalid request assert column rang column builder builder def column builder restrict column restrict assert null equal valu size assert def compact onli support column creat column return sort set byte buffer column tree set byte buffer def cfm compar iter term iter valu iter iter term iter column builder iter builder copi builder byte buffer cname add relat type variabl build column add cname return column els builder add valu relat type variabl def compact return util singleton builder build els collect requir slice queri becaus collect set column shouldn assert def collect sort set byte buffer column tree set byte buffer def cfm compar queri select column marker column case row exist column outsid static composit compact don marker queri column def composit marker column add builder copi add byte buffer util build select column pair definit selector expand select column add builder copi add key build els iter column identifi iter def metadata key set iter iter column identifi iter column builder iter builder copi builder byte buffer cname add key build column add cname return column privat static byte buffer build bound bound bound collect definit restrict restrict boolean revers column builder builder list byte buffer variabl throw invalid request compon composit doesn depend compon type revers revers type appli compon compar compon onli depend slice revers bound eoc bound revers bound revers bound bound definit restrict alway bound bound base compar revers slice invers bound give start slice filter actual compar revers invers bound bound revers revers type bound bound revers bound restrict restrict posit null equal bound null wasn ani relat key select record preced compon prefix composit preced compon comput chang compon compon otherwis select onli record builder compon count eoc bound bound return builder build rang els return builder build equal assert valu size builder add valu relat type variabl els term bound assert null return builder add relat eoc bound variabl build relat everyth equal return bound bound builder build rang builder build privat byte buffer request bound bound list byte buffer variabl throw invalid request assert column rang return build bound def column valu column restrict revers def column builder variabl privat list index express index express list byte buffer variabl throw invalid request metadata restrict empti return collect index express empti list list index express express array list index express map entri definit restrict entri metadata restrict entri set definit entri key restrict restrict entri valu restrict equal term restrict valu byte buffer valu byte buffer type variabl valu remain throw invalid request index express valu larger express add index express key index oper valu els bound bound valu restrict bound null byte buffer valu restrict bound byte buffer type variabl valu remain throw invalid request index express valu larger express add index express key restrict index oper valu return express privat list pair definit selector expand select select empti list pair definit selector select array list pair definit selector definit def select add pair definit selector creat return select els return select privat byte buffer valu column return instanceof counter column byte buffer util byte counter context instanc total valu valu privat void add return valu result set cql row selector column null mark delet cql row add column valu null return function switch function case cql row add column valu byte buffer util byte timestamp return case instanceof expir column int ttl expir column local delet time int system current time milli cql row add column valu byte buffer util byte ttl els cql row add column valu null return add return valu cql row valu privat void add return valu result set cql row selector byte buffer valu valu null function switch function case valu date type instanc decompos date gen unix timestamp gen valu break case valu byte buffer util byte gen unix timestamp gen valu break case case throw assert error return timestamp ttl valu cql row add column valu valu privat result set creat result list pair definit selector select list column specif array list column specif select size pair definit selector select add function column specif left left column identifi string true function result type left return result set privat iter column column order final column famili final list byte buffer variabl throw invalid request restrict column alia respect request order restrict column restrict column restrict length null equal return sort column column builder builder def column builder int column restrict length builder add column restrict valu relat type variabl final list byte buffer request array list byte buffer valu size iter term iter valu iter iter term iter column builder iter builder copi builder request add add relat type variabl build return iter column public iter column iter return abstract iter column iter byte buffer iter request iter public column comput iter return data column column column iter return column null comput column privat result set process list row row list byte buffer variabl throw invalid request list pair definit selector select expand select result set cql row creat result select org apach cassandra row row row column match queri skip row null continu byte buffer key compon null def composit key key compon composit type def cfm key valid split row key key els key compon byte buffer row key key def compact cql row column column column order row variabl mark delet continu byte buffer compon null def composit compon composit type def cfm compar split els slice restrict null dynam column request bound filter slice restrict inclus bound equal slice restrict bound bound byte buffer def cfm compar variabl continu slice restrict inclus bound equal slice restrict bound bound byte buffer def cfm compar variabl continu respect select order pair definit selector select definit left selector selector switch kind case add return valu cql row selector key compon posit break case byte buffer val def composit posit compon length compon posit null add return valu cql row selector val break case add return valu cql row selector break case happen compact throw assert error default throw assert error els def composit spars case group column cql row composit prefix equal composit type composit composit type def cfm compar column group map builder builder column group map builder composit def collect column row mark delet continu builder add column group map group builder group handl group select row key key key compon group cql row els row onli tombston continu static case cql row column respect select order pair definit selector select definit left selector selector kind definit kind add return valu cql row selector key compon posit continu column row column key add return valu cql row selector order result select cql row intern call alway return column compar order revers set revers cql row revers trim result respect limit cql row trim paramet limit return cql row order result multipl key select privat void order result list pair definit selector select result set cql row noth result order inform key restrict rang express cql row size paramet order empti key rang key relat return optim onli order condit becaus point composit compar onli order condit paramet order size definit order def paramet order key set iter collect sort cql row row singl column compar column posit select select order order type return build composit type multi column comparison compar order compon pass collect posit inform built composit compar composit compar actual comparison row list abstract type type array list abstract type paramet order size int posit int paramet order size int idx column identifi identifi paramet order key set definit order column def identifi type add order column type posit idx column posit select select order column collect sort cql row row composit compar type posit determin posit column select claus privat int column posit select list pair definit selector select definit column int select size select left equal column return throw illeg argument string format column wasn select claus column spars composit return wheter column belong cql row base full list compon column belong togeth differ onli compon privat static boolean row byte buffer byte buffer cql don insert column doesn compon composit set spars composit someon thrift hit sinc handl correct fail whomev hit someon chang definit dens composit assert length length spars composit partial column int length equal return fals return true privat void handl group list pair definit selector select byte buffer key byte buffer key compon column group map column result set cql row respect request order pair definit selector select definit left selector selector switch kind case add return valu cql row selector key compon posit break case add return valu cql row selector column key compon posit break case happen throw assert error case type collect list pair byte buffer column collect column collect key byte buffer valu collect null null collect type type serial collect add return valu cql row selector valu els column column simpl key add return valu cql row selector break default throw assert error privat static boolean revers type definit return type instanceof revers type privat boolean column filter ident restrict column restrict null return fals return true public static class raw statement extend statement privat final paramet paramet privat final list selector select claus privat final list relat claus public raw statement paramet paramet list selector select claus list relat claus super paramet paramet select claus select claus claus claus null collect relat empti list claus public pars statement prepar prepar throw invalid request meta data cfm thrift valid valid column famili keyspac column famili paramet limit throw invalid request strict posit definit def cfm def select statement stmt select statement def bound term paramet definit definit bound term partition partition storag servic partition select claus paramet count select claus empti throw invalid request onli oper current support els selector select claus definit def null throw invalid request string format undefin select claus function type collect throw invalid request string format function support collect function switch function case case kind definit kind kind definit kind throw invalid request string format function part function break case case type instanceof time type throw invalid request string format function onli timeuuid column function break stmt select add pair creat claus entiti rule relat conflict anyth els includ relat resp relat relat restrict row key conflic anyth els entiti doesn veri valu alia restrict ani don support wide row index valu relat rel claus definit def rel entiti null throw invalid request string format undefin claus rel entiti rel rel oper relat type term valu rel valu valu bind marker valu bind index els term valu rel valu valu bind marker valu bind index switch kind case stmt key restrict posit updat restrict stmt key restrict posit rel break case stmt column restrict posit updat restrict stmt column restrict posit rel break case throw invalid request string format restrict valu compact support case stmt metadata restrict put updat restrict stmt metadata restrict rel break point select statement fulli construct valid compon restrict relat preced compon follow restrict boolean fals definit previous null iter definit iter def column valu iter int stmt column restrict length definit cname iter restrict restrict stmt column restrict restrict null true els throw invalid request string format part restrict preced part restrict relat cname previous els restrict equal true composit slice don support intern differ exclus inclus bound deal manual def composit restrict inclus bound restrict inclus bound stmt slice restrict restrict onli support compact storag extend compact remain els restrict valu size def compact stmt column restrict length throw invalid request string format part restrict relat cname previous cname compon partit key restrict relat preced compon follow restrict fals previous null stmt key relat fals iter def key valu iter int stmt key restrict length definit cname iter restrict restrict stmt key restrict restrict null stmt token throw invalid request token function appli partit key compon order perserv partition onli time restrict key part restrict partition preserv order stmt key restrict null throw invalid request string format partit key part restrict sinc preced part cname stmt key rang true true els throw invalid request string format partit key part restrict preced part restrict relat cname previous els restrict token queri token necessari rang queri key token reject queri don stmt key rang true stmt token true restrict equal restrict valu size throw invalid request select token function don support claus els stmt token throw invalid request string format token function appli partit key compon els restrict equal restrict valu size onli support stmt key restrict length throw invalid request string format partit part restrict relat onli part partit key cname stmt key relat true els partition preserv order throw invalid request onli relat support partit key random partition token function stmt key rang true true previous cname deal index column stmt metadata restrict empti stmt key rang true boolean fals secondari index manag idx manag tabl open keyspac column famili store column famili index manag set byte buffer index hash set byte buffer secondari index index idx manag index column definit cdef index column def index add cdef note idx manag index method becaus don complet column point onli index compon map entri definit restrict entri stmt metadata restrict entri set restrict restrict entri valu restrict equal continu don support index valu basic requir support form restrict valu size throw invalid request oper column part index entri key key true break throw invalid request index column present column claus equal oper index column key claus rang queri relat don handl stmt key relat throw invalid request select index column claus support stmt paramet order empti stmt metadata restrict empti throw invalid request ndari index support stmt key rang throw invalid request onli support partit key restrict order queri manual sort post queri current sort requir queri column sort updat add column sort queri automat remov result set afterward stmt key relat stmt select empti empti wildcard column identifi column stmt paramet order key set definit def column boolean column fals pair definit selector select pair stmt select select pair left equal column true break column throw invalid request column select claus boolean revers map boolean def column size int map entri column identifi boolean entri stmt paramet order entri set column identifi column entri key boolean revers entri valu definit def column null throw invalid request string format order unknown column column kind definit kind throw invalid request string format order current onli support cluster column column posit throw invalid request string format order current onli support order column follow declar order revers map posit revers revers type check boolean revers map set agre boolean revers null boolean revers map column order specifi ani order null continu revers null revers continu revers throw invalid request string format unsupport order relat assert revers null stmt revers revers queri note onli key rang involv filter paramet filter stmt key rang potenti filter data index express index express column filter ident stmt metadata restrict size stmt metadata restrict empti stmt column filter ident throw invalid request execut queri involv data filter unpredict perform execut queri despit perform unpredict return pars statement prepar stmt array column specif list restrict updat restrict definit restrict restrict relat rel throw invalid request rel token kind definit kind throw invalid request string format token function onli support partit key switch rel oper case restrict null throw invalid request string format restrict relat includ equal restrict restrict rel valu rel token break case restrict null throw invalid request string format restrict reation includ restrict restrict rel valu break case case case case restrict null restrict restrict rel token restrict set bound rel oper rel valu break return restrict overrid public string string return string format select raw statement select claus claus count limit select claus claus paramet count paramet limit raw class simplifi valid queri select don public easili bad privat static class restrict equal list term valu null restrict bound bound privat final term bound privat final boolean bound inclus final boolean token restrict list term valu valu valu bound null bound inclus null token fals restrict term valu boolean token collect singleton list valu restrict boolean token valu null bound term bound inclus boolean token token boolean equal return valu null public void set bound bound term bound idx public void set inclus bound bound inclus idx true public term bound bound return bound idx public boolean inclus bound return bound idx null bound inclus idx public relat type relat bound eoc bound bound inclus bound switch eoc bound case return bound inclus inclus bound idx relat type relat type case return bound inclus inclus bound idx relat type relat type throw assert error public index oper index oper bound switch case return bound inclus idx index oper index oper case return bound inclus idx index oper index oper throw assert error public void set bound column identifi relat type type term throw invalid request bound null boolean inclus fals switch type case bound inclus fals break case bound inclus true break case bound inclus fals break case bound inclus true break bound null throw invalid request string format restrict equal inequ relat bound idx null throw invalid request string format invalid restrict bound idx bound inclus idx inclus overrid public string string string valu null string format bound inclus bound bound inclus bound els string format valu return token public static class paramet privat final int limit privat final map column identifi boolean order privat final boolean count privat final boolean filter public paramet int limit map column identifi boolean order boolean count boolean filter limit limit order order count count filter filter order result method singl condit privat static class singl column compar implement compar list byte buffer privat final int index privat final abstract type compar public singl column compar int column index abstract type order index column index compar order public int compar list byte buffer list byte buffer return compar compar index index order result method multipl condit privat static class composit compar implement compar list byte buffer privat final list abstract type order type privat final int posit privat composit compar list abstract type order type int posit order type order type posit posit public int compar list byte buffer list byte buffer int posit length abstract type type order type int column pos posit byte buffer valu column pos byte buffer valu column pos int comparison type compar valu valu comparison return comparison return 