licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra dht import java math big decim import java math big integ import java nio byte buffer import java util hash map import java util iter import java util list import java util map import org apach cassandra decor key import org apach cassandra configur import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util murmur hash class generat big integ token murmur hash public class murmur partition extend abstract partition long token public static final long token long token long public static final long long public decor key convert disk format byte buffer key throw unsupport oper public decor key decor key byte buffer key return decor key token key key public token midpoint token token token token big integ avoid long overflow intermedi oper big integ big integ valu long token token token big integ valu long token token token midpoint compar big integ sum add midpoint sum shift els wrap case big integ max big integ valu big integ min big integ valu token length rang bisect min max add give min max max min midpoint max subtract min add add shift midpoint compar max midpoint min add midpoint subtract max return long token midpoint long valu public long token minimum token return generat token key note ensur generat token strict bigger don correspond ani key becaus rang doesn includ rang select data token smaller public long token token byte buffer key key remain return long hash murmur hash hash key key posit key remain return long token normal hash public long token random token return long token normal util thread local random long privat long normal long exclud valu token return long long public boolean preserv order return fals public map token float describ ownership list token sort token map token float ownership hash map token float iter sort token iter case throw runtim node present cluster call case sort token size ownership put token float case els final big integ big integ valu subtract big integ valu token addit final big decim big decim token start token big integ big integ valu long token start token token valu token big integ tim token valu loop token big integ valu long token token token valu float age big decim subtract tim add mod divid big decim float valu age ownership put age save age tim advanc loop start token rang extend token whi save abov float big decim big integ valu long token start token subtract add mod divid big decim float valu ownership put start return ownership public token token factori long token factori return token factori privat final token token factori long token factori token token factori long public byte buffer byte array token long long token return byte buffer util byte long token token public token long byte array byte buffer byte return long token byte long public string string token long long token return long token token string public void valid string token throw configur tri long long valu token catch number format throw configur messag public token long string string string return long token long valu string 