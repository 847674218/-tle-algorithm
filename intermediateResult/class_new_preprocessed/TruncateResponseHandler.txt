licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java util concurr time unit import java util concurr timeout import java util concurr atom atom integ import org slf logger import org slf logger factori import org apach cassandra config databas descriptor import org apach cassandra net async callback import org apach cassandra net messag import org apach cassandra util simpl condit public class truncat respons handler implement async callback protect static final logger logger logger factori logger truncat respons handler class protect final simpl condit condit simpl condit privat final int respons count protect final atom integ respons atom integ privat final long start time public truncat respons handler int respons count node rang bootstrap time ad write bootstrap finish point longer write assert respons count invalid respons count respons count respons count respons count start time system current time milli public void throw timeout long timeout databas descriptor truncat rpc timeout system current time milli start time boolean success tri success condit await timeout time unit truncat longer timeout catch interrupt throw assert error success throw timeout truncat time receiv onli respons respons public void respons messag messag respons increment respons respons count condit signal public boolean latenc snitch return fals 