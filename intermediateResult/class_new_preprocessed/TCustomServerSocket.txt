licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import java import java net inet socket address import java net server socket import java net socket import java net socket import org slf logger import org slf logger factori import org apach thrift transport server transport import org apach thrift transport transport extend thrift server socket custom desir properti public class custom server socket extend server transport privat static final logger logger logger factori logger custom server socket class serversocket object privat server socket server socket null privat final boolean aliv privat final integ send buffer size privat final integ recv buffer size fine tune server socket includ aliv reus address send receiv buffer size param bind addr param aliv param send buffer size param recv buffer size throw transport public custom server socket inet socket address bind addr boolean aliv integ send buffer size integ recv buffer size throw transport tri server socket server socket server socket prevent delay problem server restart server socket set reus address true bind listen port server socket bind bind addr catch ioe server socket null throw transport creat server socket address bind addr string aliv aliv send buffer size send buffer size recv buffer size recv buffer size public custom server socket server socket socket boolean aliv integ send buffer size integ recv buffer size throw transport server socket socket aliv aliv send buffer size send buffer size recv buffer size recv buffer size overrid protect custom socket accept impl throw transport server socket null throw transport transport server socket custom socket tsocket null socket socket null tri socket server socket accept tsocket custom socket socket tsocket set timeout catch iox throw transport iox tri socket set aliv aliv catch socket logger warn fail set aliv thrift socket send buffer size null tri socket set send buffer size send buffer size int valu catch socket logger warn fail set send buffer size thrift socket recv buffer size null tri socket set receiv buffer size recv buffer size int valu catch socket logger warn fail set receiv buffer size thrift socket return tsocket overrid public void listen throw transport block accept server socket null tri server socket set timeout catch socket logger error set socket timeout overrid public void close server socket null tri server socket close catch iox logger warn close server socket iox server socket null overrid public void interrupt thread safe dubious java document suggest safe differ thread context close 