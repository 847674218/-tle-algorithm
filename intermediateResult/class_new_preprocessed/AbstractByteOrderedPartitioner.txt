licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra dht import java math big integ import java nio byte buffer import java util import org apach cassandra config import org apach cassandra util byte buffer util import org apach common lang array util import org apach cassandra decor key import org apach cassandra configur import org apach cassandra servic storag servic import org apach cassandra util util import org apach cassandra util hex import org apach cassandra util pair public abstract class abstract byte order partition extend abstract partition byte token public static final byte token byte token array util public static final big integ big integ public decor key decor key byte buffer key return decor key token key key public decor key convert disk format byte buffer key return decor key token key key public byte token midpoint token ltoken token rtoken int byte buffer ltoken token instanceof byte byte ltoken token length byte buffer wrap byte ltoken token els byte buffer ltoken token remain byte buffer ltoken token rtoken token instanceof byte byte rtoken token length byte buffer wrap byte rtoken token els byte buffer rtoken token remain byte buffer rtoken token int sigbyt math max big integ left big byte sigbyt big integ big byte sigbyt pair big integ boolean midpair util midpoint left sigbyt return byte token byte big midpair left sigbyt midpair convert byte array signific sigbyt byte repres big endian magnitud big integ privat big integ big byte byte buffer byte int sigbyt byte byte sigbyt byte buffer util array copi byte byte posit byte remain return big integ convert posit big integ byte array repres magnitud remaind true addit byte high order bit enabl ad array privat byte byte big big integ big int sigbyt boolean remaind byte byte byte sigbyt remaind remaind remain bit signific byte byte sigbyt bitmask singl byte int sigbyt int maskpo sigbyt appli bitmask byte valu byte byte big shift left maskpo shift maskpo int valu return byte public byte token minimum token return public byte token random token random random byte buffer byte byte buffer return byte token buffer privat final token token factori byte token factori token token factori byte public byte buffer byte array token byte byte token return byte buffer wrap byte token token public token byte byte array byte buffer byte return byte token byte public string string token byte byte token return hex byte hex byte token token public void valid string token throw configur tri token length token token hex hex byte token catch number format throw configur token token hex digit public token byte string string string string length string string return byte token hex hex byte string public token token factori byte token factori return token factori public boolean preserv order return true public abstract byte token token byte buffer key public map token float describ ownership list token sort token token count return sort rang shorthand token token math map token float token hash map token float list rang token sort rang array list rang token sort token size initi count calc rang order token token sort token sort token size token node sort token token put node float sort rang add rang token token node token node string schema instanc tabl meta data cfmd schema instanc meta data meta data valu rang token sort rang loop everi rang split size add count token put token storag servic instanc split cfmd size sum everi count divid count total fraction ownership float total float float token valu total map entri token float row token entri set token put row key row valu total return token 