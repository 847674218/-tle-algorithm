licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stress util import static googl common base charset import java import java math big integ import java nio byte buffer import java secur messag digest import java util array list import java util list import java util random import googl common base function import googl common collect list import org apach cassandra marshal time type import org apach cassandra stress session import org apach cassandra stress stress import org apach cassandra thrift compress import org apach cassandra thrift cql prepar result import org apach cassandra thrift invalid request import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util hex import org apach cassandra util gen public abstract class oper public final int index protect final session session protect static volatil doubl gaussian null public oper int idx index idx session stress session public oper session client int idx index idx session client run oper param client cassandra thrift client connect throw ani error public abstract void run cassandra client client throw util method protect list byte buffer generat valu session averag size valu return generat random valu list byte buffer valu array list byte buffer int session cardin string hash integ string int time session column size hash length int sum remind session column size hash length string valu multipli string hash time hash substr sum remind valu add byte buffer wrap valu byte return valu generat valu averag size specifi cardin specifi return collect valu protect list byte buffer generat random valu list byte buffer valu array list byte buffer int limit session column size int session cardin byte valu byte stress random int limit stress random byte valu valu add byte buffer wrap valu return valu key generat gauss random algorithm return byte represent key string protect byte generat key return session random generat generat random key generat gauss key random key generat return byte represent key string privat byte generat random key string format session total key length return string format format stress random int stress session num differ key byte gauss key generat return byte represent key string privat byte generat gauss key string format session total key length doubl token gaussian session session sigma token token session num differ key return string format format int token byte gaussian distribut param param sigma standard deviat return gaussian distribut number privat static doubl gaussian int float sigma random random stress random doubl current state gaussian gaussian null current state null doubl random doubl math doubl rad math sqrt math log random doubl current state math cos rad gaussian math sin rad return current state sigma string generat param input string return represent string privat string string input messag digest util thread local digest byte messag digest digest input byte string builder hash string builder big integ messag digest string hash length hash append append hash return hash string equal python rubi time param str string multipl param time multipl time return multipli string privat string multipli string string str int time string builder result string builder int time result append str return result string protect byte buffer column int index boolean time compar return time compar time type instanc decompos gen time byte buffer util byte string format index protect string messag string class class simpl string messag instanceof invalid request invalid request whi messag return messag null class string format class messag protect void error string messag throw session ignor error throw messag els system err println messag protect string quot cql blob string term return quot cql blob term byte protect string quot cql blob byte term return hex byte hex term protect list byte buffer queri param byte buffer list string queri param return list transform queri param function string byte buffer public byte buffer appli string param return byte buffer util byte param construct queri string replac instanc charact correspond paramet param queri base queri string format param parm sequenc string queri paramet return format queri string protect static string format cql queri string queri list string parm int marker posit string builder result string builder marker queri index parm size return queri string parm parm result append queri substr posit marker result append append parm append posit marker marker queri index posit break posit queri length result append queri substr posit return result string protect static integ prepar statement cassandra client client string cql queri throw integ statement client prepar statement cql queri hash code statement null cql prepar result respons client prepar cql queri byte buffer util byte cql queri compress statement respons item client prepar statement put cql queri hash code statement return statement protect string wrap quot requir string string return session cql version start string string 