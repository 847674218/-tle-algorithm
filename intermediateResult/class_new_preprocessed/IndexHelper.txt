licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java import java nio byte buffer import java util array list import java util collect import java util compar import java util list import org apach cassandra type size import org apach cassandra marshal abstract type import org apach cassandra util file data input import org apach cassandra util file mark import org apach cassandra util file util import org apach cassandra util provid helper serial deseri column index public class index helper skip bloom filter param data input bloom filter skip throw public static void skip bloom filter data input throw size bloom filter int size read int skip serial bloom filter instanceof file data input file util skip byte fulli size els skip byte byte skip byte size read fulli skip skip index param data input index skip throw error occur public static void skip index data input throw read onli column index list int column index size read int skip column index data instanceof file data input file util skip byte fulli column index size els skip byte byte skip byte column index size read fulli skip deseri index structur return param input sourc return array list index info list serial index throw error occur public static list index info deseri index file data input throw int column index size read int column index size return collect index info empti list array list index info index list array list index info file mark mark mark byte mark mark column index size index list add index info deseri assert byte mark mark column index size return index list public static filter defreez bloom filter file data input file filter factori type type throw return defreez bloom filter file integ type freez bloom filter param file sourc file param max size saniti check filter claim larger bogus param type bloom filter type return bloom filter summar column inform throw java error occur guarante file current posit bloom filter filter deseri thrown public static filter defreez bloom filter file data input file long max size filter factori type type throw int size file read int size max size size throw bloom filter claim size byte longer entir row size max size byte buffer byte file read byte size data input stream stream data input stream byte buffer util input stream byte return filter factori deseri stream type fals index index info scan start param index param index list list index info object param compar compar type param revers revers return int index public static int index byte buffer list index info index list abstract type compar boolean revers int index remain revers return index list size index index list size return index info target index info exampl unit test index slice slice binari search compar start queri part index slot slot left start revers slice onli start column queri exampl compar part index slot bsearch give slot start subtract extra slot befor int start idx list index info search index list index revers start idx index search index list list index index list size els search index list list index int index collect binari search search target compar compar revers return start idx index index revers index public static compar index info compar final abstract type compar boolean revers return revers compar index revers compar compar index compar public static class index info public final long width public final byte buffer public final byte buffer public final long offset public index info byte buffer byte buffer long offset long width offset offset width width public void serial data output dos throw byte buffer util write short length dos byte buffer util write short length dos dos write long offset dos write long width public int serial size type size type size int size remain int size remain return type size sizeof short size size type size sizeof short size size type size sizeof offset type size sizeof width public static index info deseri data input dis throw return index info byte buffer util read short length dis byte buffer util read short length dis dis read long dis read long 