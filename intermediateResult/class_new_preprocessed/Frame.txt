licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra transport import java import java util enum set import org jboss netti buffer channel buffer import org jboss netti buffer channel buffer import org jboss netti channel import org jboss netti handler codec oneon decod import org jboss netti handler codec oneon encod import org jboss netti handler codec frame import org apach cassandra util byte buffer util public class frame public final header header public final channel buffer bodi public final connect connect wire frame frame defin version flag stream opcod length privat frame header header channel buffer bodi connect connect header header bodi bodi connect connect public static frame creat channel buffer full frame connect connect assert full frame readabl byte header string format frame short byte full frame readabl byte byte buffer util byte hex full frame byte buffer int version full frame read byte int flag full frame read byte int stream full frame read byte int opcod full frame read byte int length full frame read int assert length full frame readabl byte version byte direct frame request respons messag direct direct messag direct extract version version version version header header header version flag stream messag type opcod opcod direct return frame header full frame connect public static frame creat messag type type int stream enum set header flag flag channel buffer bodi connect connect header header header header flag stream type return frame header bodi connect public static class header public static final int public static final int public final int version public final enum set flag flag public final int stream public final messag type type privat header int version int flag int stream messag type type version flag deseri flag stream type privat header int version enum set flag flag int stream messag type type version version flag flag stream stream type type public static enum flag order enum matter public static enum set flag deseri int flag enum set flag set enum set flag class flag valu flag valu int flag set add valu return set public static int serial enum set flag flag int flag flag flag flag ordin return public frame channel buffer bodi return frame header bodi connect public static class decod extend length field base frame decod privat static final int privat final connect connect public decod connect tracker tracker connect factori factori super true connect factori connect tracker overrid public void channel open channel handler context ctx channel state event throw connect regist channel channel overrid protect object decod channel handler context ctx channel channel channel buffer buffer throw tri valid frame version someth support doesn hurt check opcod garbag indenp byte correspond frame length shouldn wait super decod return null buffer readabl byte return null int byte buffer byte messag direct direct messag direct extract version byte int version byte realli onli support current version version header throw protocol invalid unsupport protocol version version valid opcod buffer readabl byte messag type opcod buffer byte direct channel buffer frame channel buffer super decod ctx channel buffer frame null return null return frame creat frame connect catch corrupt frame throw protocol messag catch long frame throw protocol messag public static class encod extend encod public object encod channel handler context ctx channel channel object msg throw assert msg instanceof frame expect frame msg frame frame frame msg channel buffer header channel buffer buffer frame header messag type type frame header type header write byte type direct add version frame header version header write byte header flag serial frame header flag header write byte frame header stream header write byte type opcod header write int frame bodi readabl byte return channel buffer wrap buffer header frame bodi public static class decompressor extend decod public object decod channel handler context ctx channel channel object msg throw assert msg instanceof frame expect frame msg frame frame frame msg frame header flag header flag return frame frame compressor compressor frame connect compressor compressor null return frame return compressor decompress frame public static class compressor extend encod public object encod channel handler context ctx channel channel object msg throw assert msg instanceof frame expect frame msg frame frame frame msg compress messag frame header type messag type frame connect null return frame frame compressor compressor frame connect compressor compressor null return frame frame header flag add header flag return compressor compress frame 