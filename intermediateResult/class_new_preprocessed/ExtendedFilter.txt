licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra filter import java nio byte buffer import java util list import java util sort set import java util tree set import org slf logger import org slf logger factori import org apach cassandra config databas descriptor import org apach cassandra cql column builder import org apach cassandra import org apach cassandra marshal composit type import org apach cassandra columniter disk atom iter import org apach cassandra thrift index express import org apach cassandra thrift index oper import org apach cassandra util byte buffer util extend column filter filter includ number index express public abstract class extend filter privat static final logger logger logger factori logger extend filter class public final column famili store cfs protect final disk atom filter origin filter privat final int max result privat final boolean count row privat final boolean page public static extend filter creat column famili store cfs disk atom filter filter list index express claus int max result boolean count row boolean page claus null claus empti return empti claus filter cfs filter max result count row page els page throw illeg argument cross row page support index claus return cfs compar instanceof composit type filter composit claus cfs filter claus max result count row filter claus cfs filter claus max result count row protect extend filter column famili store cfs disk atom filter filter int max result boolean count row boolean page assert cfs null assert filter null cfs cfs origin filter filter max result max result count row count row page page count row origin filter updat column limit max result page origin filter instanceof slice queri filter slice queri filter origin filter finish remain throw illeg argument cross row page onli support slice queri filter empti finish column public int max row return count row integ max result public int max column return count row max result integ updat filter necessari number column alreadi fetch public void updat filter int current column count call reset start column page page slice queri filter initi filter set start byte buffer util count row return int remain max result current column count initi filter updat column limit remain public int count column famili data initi filter instanceof slice queri filter return slice queri filter initi filter count els return initi filter live count data initi filter slice origin superset public abstract disk atom filter initi filter public disk atom filter origin filter return origin filter public abstract list index express claus return filter queri column claus initi slice filter caught param data data retriev initi filter return filter null ani column initi filter typic queri slice entir row public abstract disk atom filter extra filter column famili data return data prune column origin public abstract column famili prune column famili data return true provid data satisfi express claus filter public abstract boolean satisfi column famili data column builder builder public static boolean satisfi int comparison index oper switch case return comparison case return comparison case return comparison case return comparison case return comparison default throw illeg state privat static class filter claus extend extend filter protect final list index express claus protect final disk atom filter initi filter public filter claus column famili store cfs disk atom filter filter list index express claus int max result boolean count row super cfs filter max result count row fals assert claus null claus claus initi filter comput initi filter set initi filter protect disk atom filter comput initi filter origin filter instanceof slice queri filter high chanc column singl index slice cost otherwis extra filter lazili creat fetch column referenc addit express cfs max row size databas descriptor column index size logger trace expand slice filter entir row cover addit express return slice queri filter byte buffer util byte buffer util slice queri filter origin filter revers integ els logger trace ad column origin filter cover addit express assert origin filter instanceof queri filter claus empti sort set byte buffer column tree set byte buffer cfs compar index express expr claus column add expr column column add queri filter origin filter column return queri filter origin filter updat column column return origin filter public disk atom filter initi filter return initi filter public list index express claus return claus extra queri onli origin slice queri express claus point extra queri origin filter grab row onli extra queri haven express claus privat boolean extra queri column famili data origin filter instanceof slice queri filter return fals slice queri filter filter slice queri filter origin filter check fetch row filter slice length filter start equal byte buffer util filter finish equal byte buffer util filter count integ return fals index express expr claus data column expr column null logger debug ad extra filter cover addit express return true return fals public disk atom filter extra filter column famili data extra queri data return null note counter care add column alreadi avoid overcount whi danc avoid queri ani column alreadi effici sort set byte buffer column tree set byte buffer cfs compar index express expr claus data column expr column null column add expr column assert column empti return queri filter column public column famili prune column famili data initi filter origin filter return data column famili prune data clone shallow disk atom iter iter origin filter memtabl column iter data null origin filter collect reduc column prune queri filter gather tombston prune iter cfs befor return prune public boolean satisfi column famili data column builder builder enforc primari claus becaus read synchron write possibl race index return row doesn primari column actual read index express express claus check column data express byte buffer col builder null express column builder copi add express column build column column data column col column null return fals int data metadata valu valid express column compar column valu express valu satisfi express return fals return true privat static class filter composit claus extend filter claus public filter composit claus column famili store cfs disk atom filter filter list index express claus int max result boolean count row super cfs filter claus max result count row composit index valid column onli compon queri filter part filter claus besid composit searcher doesn realli initi filter expect limit set user creat fake filter onli count inform protect disk atom filter comput initi filter int limit origin filter instanceof slice queri filter slice queri filter origin filter count integ return slice queri filter column slice fals limit privat static class empti claus filter extend extend filter public empti claus filter column famili store cfs disk atom filter filter int max result boolean count row boolean page super cfs filter max result count row page public disk atom filter initi filter return origin filter public list index express claus throw unsupport oper public disk atom filter extra filter column famili data return null public column famili prune column famili data return data public boolean satisfi column famili data column builder builder return true 