licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stream import java data input import java data output import java import java util import org apach cassandra type size import org apach cassandra version serial import org apach cassandra net messag servic import org apach cassandra util serial public class stream header public static final version serial stream header serial stream header serial public final string tabl file initi stream public final pend file file session public final session file add session public final collect pend file pend file public stream header string tabl session pend file file tabl session file collect pend file empti list public stream header string tabl session pend file collect pend file pend file tabl tabl session session file pend file pend file privat static class stream header serial implement version serial stream header public void serial stream header data output dos int version throw dos write tabl serial serial serial session dos messag servic current version pend file serial serial file dos version dos write int pend file size pend file file pend file pend file serial serial file dos version public stream header deseri data input dis int version throw string tabl dis read session serial serial deseri dis messag servic current version pend file file pend file serial deseri dis version int size dis read int list pend file pend file array list pend file size int size pend file add pend file serial deseri dis version return stream header tabl session file pend file public long serial size stream header int version long size type size sizeof tabl size type size sizeof session size pend file serial serial size file version size type size sizeof pend file size pend file file pend file size pend file serial serial size file version return size 