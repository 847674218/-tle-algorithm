licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java net inet address import java util array import java util collect import java util collect import java util concurr atom atom integ import googl common collect iter import org slf logger import org slf logger factori import org apach cassandra tabl import org apach cassandra unavail import org apach cassandra gms failur detector import org apach cassandra net messag import org apach cassandra consist level import org apach cassandra write type handl block write consist level public class write respons handler extend abstract write respons handler protect static final logger logger logger factori logger write respons handler class protect final atom integ respons public write respons handler collect inet address write endpoint collect inet address pend endpoint consist level consist level tabl tabl runnabl callback write type write type super tabl write endpoint pend endpoint consist level callback write type respons atom integ consist level block tabl public write respons handler inet address endpoint write type write type runnabl callback array list endpoint collect inet address empti list consist level null callback write type public write respons handler inet address endpoint write type write type endpoint write type null public void respons messag respons decrement signal protect int ack count return consist level block tabl respons public boolean latenc snitch return fals 