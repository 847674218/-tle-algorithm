licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java file import java filenam filter import java import java net inet address import java util import java util concurr count latch import java util concurr futur import java util concurr time unit import java util concurr timeout import org apach cassandra config config import org apach cassandra configur import org apach cassandra config databas descriptor import org apach cassandra dht partition import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra stream import org apach cassandra util cassandra tabl bulk loader load extern creat sstabl cluster public class tabl loader privat final file directori privat final string keyspac privat final client client privat final output handler output handler static config set load yaml fals public tabl loader file directori client client output handler output handler directori directori keyspac directori parent file client client output handler output handler protect collect tabl reader open tabl final list tabl reader sstabl link list tabl reader directori list filenam filter public boolean accept file dir string pair descriptor compon tabl tri compon filenam dir descriptor desc null null left null equal compon desc temporari return fals file desc filenam compon exist output handler output string format skip file becaus index return fals client valid column famili keyspac desc cfname output handler output string format skip file column famili doesn exist keyspac desc cfname return fals set compon compon hash set compon compon add compon compon add compon file desc filenam compon exist compon add compon file desc filenam compon exist compon add compon tri sstabl add tabl reader open desc compon null client partition catch output handler output string format skip file error open messag return fals return sstabl public loader futur stream throw return stream collect inet address empti set public loader futur stream set inet address ignor throw client init keyspac collect tabl reader sstabl open tabl sstabl empti output handler output sstabl stream return loader futur map inet address collect rang token endpoint rang client endpoint rang map output handler output string format stream revel part sto sstabl endpoint rang key set stream session endpoint loader futur futur loader futur endpoint rang size map entri inet address collect rang token entri endpoint rang entri set inet address remot entri key ignor remot futur latch count continu collect rang token rang entri valu stream session session stream session creat keyspac remot count callback futur remot transfer tabl assum refer acquir tabl reader acquir refer sstabl stream transfer tabl session sstabl rang oper type futur set pend remot session file return futur public static class loader futur implement futur void final count latch latch final map inet address collect pend file pend file privat list inet address fail host array list inet address privat loader futur int request latch count latch request pend file hash map inet address collect pend file privat void set pend inet address remot collect pend file file pend file put remot array list file privat void set fail inet address addr fail host add addr public list inet address fail host return fail host public boolean cancel boolean interrupt run throw unsupport oper cancel support public void throw interrupt latch await return null public void long timeout time unit unit throw interrupt timeout latch await timeout unit return null els throw timeout public boolean cancel cancel support mayb day return fals public boolean return latch count public boolean failur return fail host size public map inet address collect pend file pend file return pend file privat string collect tabl reader sstabl string builder builder string builder tabl reader sstabl sstabl builder append sstabl descriptor filenam compon append return builder string privat class count callback implement stream callback privat final inet address endpoint privat final loader futur futur count callback loader futur futur inet address endpoint futur futur endpoint endpoint public void success futur latch count output handler debug string format stream session complet wait outstand session endpoint futur latch count race stop call futur latch count client stop public void failur output handler output string format stream session fail endpoint futur set fail endpoint futur latch count client stop public static abstract class client privat final map inet address collect rang token endpoint rang hash map inet address collect rang token privat partition partition initi client perform ani step necessari call method partition initi endpoint rang map return correct map method guarante call befor ani method client public abstract void init string keyspac stop client public void stop valid code keyspac exist keyspac code exist column famili public abstract boolean valid column famili string keyspac string public map inet address collect rang token endpoint rang map return endpoint rang protect void set partition string partclass throw configur set partition util partition partclass protect void set partition partition partition throw configur partition partition databas descriptor set partition partition public partition partition return partition protect void add rang endpoint rang token rang inet address endpoint collect rang token rang endpoint rang endpoint rang null rang hash set rang token endpoint rang put endpoint rang rang add rang 