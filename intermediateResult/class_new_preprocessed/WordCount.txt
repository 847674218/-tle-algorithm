licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util import org apach cassandra thrift import org apach cassandra hadoop column famili output format import org slf logger import org slf logger factori import org apach cassandra column import org apach cassandra hadoop column famili input format import org apach cassandra hadoop config helper import org apach cassandra util byte buffer util import org apach hadoop conf configur import org apach hadoop conf configur import org apach hadoop path import org apach hadoop int writabl import org apach hadoop text import org apach hadoop mapreduc job import org apach hadoop mapreduc mapper import org apach hadoop mapreduc reduc import org apach hadoop mapreduc lib output file output format import org apach hadoop util tool import org apach hadoop util tool runner count occurr word column famili standard singl column care text sequenc word word output total number occurr text output cassandra write word count word count column valu pair row key equal sourc column read word public class word count extend configur implement tool privat static final logger logger logger factori logger word count class static final string wordcount static final string input word static final string output reduc static final string output word privat static final string tmp word count privat static final string columnnam public static void main string arg throw tool runner handl generic command line option tool runner run configur word count arg system exit public static class token mapper extend mapper byte buffer sort map byte buffer column text int writabl privat final static int writabl int writabl privat text word text privat byte buffer sourc column protect void setup org apach hadoop mapreduc mapper context context throw interrupt public void map byte buffer key sort map byte buffer column column context context throw interrupt column column column valu string byte buffer util string column string valu null int valu string valu byte buffer util int column valu els valu byte buffer util string column valu logger debug read object byte buffer util string key valu context input split string token itr string token valu itr token word set itr token context write word public static class reduc filesystem extend reduc text int writabl text int writabl public void reduc text key iter int writabl valu context context throw interrupt int sum int writabl val valu sum val context write key int writabl sum public static class reduc cassandra extend reduc text int writabl byte buffer list mutat privat byte buffer output key protect void setup org apach hadoop mapreduc reduc context context throw interrupt output key byte buffer util byte context configur public void reduc text word iter int writabl valu context context throw interrupt int sum int writabl val valu sum val context write output key collect singleton list mutat word sum privat static mutat mutat text word int sum column column set array copi word byte word length set valu byte buffer util byte sum set timestamp system current time milli mutat mutat set column supercolumn column super column column supercolumn set column return public int run string arg throw string output reduc type filesystem arg null arg start string arg split null length output reduc type logger info output reduc type output reduc type smaller page size doesn divid row count exercis page logic config helper set rang batch size conf int word count setup string column text job job job conf wordcount job set jar class word count class job set mapper class token mapper class output reduc type equal ignor case filesystem job set combin class reduc filesystem class job set reduc class reduc filesystem class job set output key class text class job set output valu class int writabl class file output format set output path job path els job set reduc class reduc cassandra class job set map output key class text class job set map output valu class int writabl class job set output key class byte buffer class job set output valu class list class job set output format class column famili output format class config helper set output column famili job configur job configur set sum job set input format class column famili input format class config helper set input rpc port job configur config helper set input initi address job configur localhost config helper set input partition job configur murmur partition config helper set input column famili job configur slice predic predic slice predic set column array list byte buffer util byte column config helper set input slice predic job configur predic index express expr index express byte buffer util byte int index oper byte buffer util byte config helper set input rang job configur array list expr caus predic ignor favor scan everyth wide row config helper set input column famili job configur true config helper set output initi address job configur localhost config helper set output partition job configur murmur partition job wait complet true return 