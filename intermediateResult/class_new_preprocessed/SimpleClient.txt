licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra transport import java import java net inet socket address import java nio byte buffer import java util hash map import java util list import java util map import java util concurr block queue import java util concurr executor import java util concurr synchron queue import javax net ssl context import javax net ssl engin import org slf logger import org slf logger factori import org apach cassandra consist level import org apach cassandra secur factori import org apach cassandra transport messag credenti messag import org apach cassandra transport messag error messag import org apach cassandra transport messag execut messag import org apach cassandra transport messag prepar messag import org apach cassandra transport messag queri messag import org apach cassandra transport messag result messag import org apach cassandra transport messag startup messag import org jboss netti bootstrap client bootstrap import org jboss netti channel channel import org jboss netti channel channel futur import org jboss netti channel channel handler context import org jboss netti channel channel pipelin import org jboss netti channel channel pipelin factori import org jboss netti channel channel state event import org jboss netti channel channel import org jboss netti channel event import org jboss netti channel messag event import org jboss netti channel simpl channel upstream handler import org jboss netti channel socket nio nio client socket channel factori import org jboss netti handler log log handler import org jboss netti handler ssl ssl handler import org jboss netti log intern logger factori import org jboss netti log slf logger factori import static org apach cassandra config encrypt option client encrypt option public class simpl client static intern logger factori set default factori slf logger factori privat static final logger logger logger factori logger simpl client class public final string host public final int port privat final client encrypt option encrypt option protect final respons handler respons handler respons handler protect final connect tracker tracker connect tracker protect final connect connect connect tracker protect client bootstrap bootstrap protect channel channel protect channel futur write futur privat final connect factori connect factori connect factori public connect connect connect tracker tracker return connect public simpl client string host int port client encrypt option encrypt option host host port port encrypt option encrypt option public void connect boolean compress throw establish connect map string string option hash map string string option put startup messag compress option put startup messag snappi connect set compressor frame compressor snappi compressor instanc execut startup messag option protect void establish connect throw configur client bootstrap client bootstrap nio client socket channel factori executor cach thread pool executor cach thread pool bootstrap set option tcp delay true configur pipelin factori encrypt option enabl bootstrap set pipelin factori secur pipelin factori els bootstrap set pipelin factori pipelin factori channel futur futur bootstrap connect inet socket address host port wait connect attempt succeed fail channel futur await uninterrupt channel futur success bootstrap releas extern resourc throw connect error futur caus public void login map string string credenti credenti messag msg credenti messag msg credenti put credenti execut msg public result messag execut string queri consist level consist messag respons msg execut queri messag queri consist assert msg instanceof result messag return result messag msg public result messag prepar prepar string queri messag respons msg execut prepar messag queri assert msg instanceof result messag prepar return result messag prepar msg public result messag execut prepar byte statement list byte buffer valu consist level consist messag respons msg execut execut messag statement valu consist assert msg instanceof result messag return result messag msg public void close wait messag flush befor close channel write futur null write futur await uninterrupt close connect close oper becaus oper asynchron netti channel close await uninterrupt shut thread pool exit bootstrap releas extern resourc protect messag respons execut messag request request tri request attach connect write futur channel write request messag respons msg respons handler respons msg instanceof error messag throw runtim throwabl error messag msg error return msg catch interrupt throw runtim stateless handler privat static final messag protocol decod messag decod messag protocol decod privat static final messag protocol encod messag encod messag protocol encod privat static final frame decompressor frame decompressor frame decompressor privat static final frame compressor frame compressor frame compressor privat static final frame encod frame encod frame encod privat static class connect tracker implement connect tracker public void add connect channel connect connect public void close privat class pipelin factori implement channel pipelin factori public channel pipelin pipelin throw channel pipelin pipelin channel pipelin pipelin add debug log handler pipelin add frame decod frame decod tracker connect factori pipelin add frame encod frame encod pipelin add frame decompressor frame decompressor pipelin add frame compressor frame compressor pipelin add messag decod messag decod pipelin add messag encod messag encod pipelin add handler respons handler return pipelin privat class secur pipelin factori extend pipelin factori privat final context ssl context public secur pipelin factori throw ssl context factori creat context encrypt option true public channel pipelin pipelin throw engin ssl engin ssl context creat engin ssl engin set client mode true ssl engin set enabl cipher suit encrypt option cipher suit channel pipelin pipelin super pipelin pipelin add ssl ssl handler ssl engin return pipelin privat static class respons handler extend simpl channel upstream handler public final block queue messag respons respons synchron queue messag respons true overrid public void messag receiv channel handler context ctx messag event assert messag instanceof messag respons tri respons put messag respons messag catch interrupt throw runtim public void caught channel handler context ctx event throw ctx pipelin logger error respons caus ctx send upstream 