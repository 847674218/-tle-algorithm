licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra transport import java net inet address import java net inet socket address import java net unknown host import java nio byte buffer import java nio charset charact code import java util array list import java util hash map import java util list import java util map import java util import org jboss netti buffer channel buffer import org jboss netti buffer channel buffer import org jboss netti util charset util import org apach cassandra consist level import org apach cassandra util gen channel buffer util method note contrarili byte buffer util method read channel buffer advanc read posit write advanc write posit function provid creat channel buffer avoid copi public abstract class util privat util public static string read string channel buffer tri int length read unsign short return read string length catch index bound throw protocol byte read serial string preced byte length public static string read long string channel buffer tri int length read int return read string length catch index bound throw protocol byte read serial string preced byte length privat static string read string channel buffer int length tri string str string reader index length charset util reader index reader index length return str catch illeg state netti encapsul caus instanceof charact code throw protocol decod string els throw privat static channel buffer byte string str return channel buffer wrap buffer str byte charset util public static channel buffer short int channel buffer channel buffer buffer write short return public static channel buffer int int channel buffer channel buffer buffer write int return public static channel buffer string string str channel buffer byte byte str return channel buffer wrap buffer short byte readabl byte byte public static channel buffer byte byte byte return channel buffer wrap buffer short byte length channel buffer wrap buffer byte public static byte read byte channel buffer tri int length read unsign short byte byte byte length read byte byte return byte catch index bound throw protocol byte read byte array preced byte length public static channel buffer consist level consist level consist return short consist code public static consist level read consist level channel buffer return consist level code read unsign short public static extend enum read enum valu class enum type channel buffer string valu util read string tri return enum valu enum type valu upper case catch illeg argument throw protocol string format invalid valu valu enum type simpl public static extend enum channel buffer enum valu enum valu return string enum valu string public static channel buffer uuid uuid return channel buffer wrap buffer gen decompos uuid public static read uuid channel buffer byte byte byte read byte byte return gen byte buffer wrap byte public static channel buffer long string string str channel buffer byte byte str return channel buffer wrap buffer int byte readabl byte byte public static list string read string list channel buffer int length read unsign short list string array list string length int length add read string return public static void write string list channel buffer list string write short size string str write byte string str public static map string string read string map channel buffer int length read unsign short map string string hash map string string length int length string read string upper case string read string put return public static void write string map channel buffer map string string write short size map entri string string entri entri set write byte string entri key write byte string entri valu public static map string list string read string string list map channel buffer int length read unsign short map string list string hash map string list string length int length string read string upper case list string read string list put return public static void write string string list map channel buffer map string list string write short size map entri string list string entri entri set write byte string entri key write string list entri valu public static byte buffer read valu channel buffer int length read int return length null read slice length byte buffer public static inet socket address read inet channel buffer int addr size read byte byte address byte addr size read byte address int port read int tri return inet socket address inet address address address port catch unknown host throw protocol string format invalid address deseri inet address address address address address public static channel buffer inet inet socket address inet byte address inet address address channel buffer channel buffer buffer address length write byte address length write byte address write int inet port return public static class buffer builder privat final int size privat final channel buffer buffer privat int public buffer builder int simpl buffer int string buffer int valu buffer size simpl buffer string buffer valu buffer buffer channel buffer size public buffer builder add channel buffer buffer return public buffer builder add string string str channel buffer byte byte str add short byte readabl byte return add byte public buffer builder add valu byte buffer add int null remain return add null channel buffer channel buffer wrap buffer public channel buffer build return channel buffer wrap buffer buffer 