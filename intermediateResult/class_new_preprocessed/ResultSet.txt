licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql import java nio byte buffer import java util import org jboss netti buffer channel buffer import org jboss netti buffer channel buffer import org apach cassandra transport import org apach cassandra marshal abstract type import org apach cassandra marshal long type import org apach cassandra marshal revers type import org apach cassandra thrift column import org apach cassandra thrift cql metadata import org apach cassandra thrift cql result import org apach cassandra thrift cql result type import org apach cassandra thrift cql row import org apach cassandra util byte buffer util public class result set public static final codec codec codec privat static final column identifi column identifi count fals public final metadata metadata public final list list byte buffer row public result set list column specif metadata metadata metadata array list list byte buffer privat result set metadata metadata list list byte buffer row metadata metadata row row public int size return row size public void add column valu byte buffer valu row empti row size metadata size row add array list byte buffer metadata size row add valu privat list byte buffer row return row row size public void revers collect revers row public void trim int limit int remov row size limit remov int remov row remov row size public result set count result string metadata string metadata metadata clear metadata add column specif long type instanc long count row size row clear row add collect singleton list byte buffer util byte count return public cql result thrift result string type cql metadata schema cql metadata hash map byte buffer string hash map byte buffer string follow shouldn column specif metadata byte buffer col byte buffer util byte string schema type put col abstract type normal type type instanceof revers type revers type type base type type schema valu type put col normal type string list cql row cql row array list cql row row size list byte buffer row row list column thrift col array list column metadata size int metadata size column col column byte buffer util byte metadata string col set valu row thrift col add col key cql row shoudn cql row add cql row byte buffer util thrift col cql result res cql result cql result type res set row cql row set schema schema return res overrid public string string tri string builder string builder append metadata append list byte buffer row row int row size byte buffer row null append null els append append metadata type string append append return string catch throw runtim public static class codec implement codec result set format metadata row count byte row public result set decod channel buffer bodi metadata metadata codec decod bodi int row count bodi read int result set result set array list list byte buffer row count row int total valu row count size int total valu add column valu util read valu bodi return public channel buffer encod result set util buffer builder builder util buffer builder metadata size row size builder add metadata codec encod metadata builder add util int row size list byte buffer row row byte buffer row builder add valu return builder build public static class metadata public static final codec metadata codec codec public final enum set flag flag public final list column specif public metadata list column specif enum set flag class empti flag add flag privat metadata enum set flag flag list column specif flag flag privat boolean assert empti iter column specif iter iter column specif iter iter column specif iter equal equal return fals return true overrid public string string string builder string builder column specif append append string append append append append append append append type append return string privat static class codec implement codec metadata public metadata decod channel buffer bodi flag column count int iflag bodi read int int column count bodi read int enum set flag flag flag deseri iflag boolean global tabl spec flag flag string global null string global null global tabl spec global util read string bodi global util read string bodi metadata type list column specif array list column specif column count int column count string global tabl spec global util read string bodi string global tabl spec global util read string bodi column identifi col column identifi util read string bodi true abstract type type data type type data type codec decod bodi add column specif col type return metadata flag public channel buffer encod metadata boolean global tabl spec flag flag int string count global tabl spec size size util buffer builder builder util buffer builder size string count channel buffer header channel buffer buffer header write int flag serial flag header write int size builder add header global tabl spec builder add string builder add string column specif global tabl spec builder add string builder add string builder add string string builder add data type codec encod data type type type return builder build public static enum flag order enum matter public static enum set flag deseri int flag enum set flag set enum set flag class flag valu flag valu int flag set add valu return set public static int serial enum set flag flag int flag flag flag flag ordin return 