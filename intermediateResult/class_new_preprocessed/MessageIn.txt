licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra net import java data input import java import java net inet address import java util collect import java util map import googl common collect immut map import org apach cassandra concurr stage import org apach cassandra config databas descriptor import org apach cassandra version serial import org apach cassandra util file util public class messag public final inet address public final payload public final map string byte paramet public final messag servic verb verb public final int version privat messag inet address payload map string byte paramet messag servic verb verb int version payload payload paramet paramet verb verb version version public static messag creat inet address payload map string byte paramet messag servic verb verb int version return messag payload paramet verb version public static messag read data input int version string throw inet address compact endpoint serial helper deseri messag servic verb verb messag servic verb valu read int int paramet count read int map string byte paramet paramet count paramet collect empti map els immut map builder string byte builder immut map builder int paramet count string key read byte valu byte read int read fulli valu builder put key valu paramet builder build int payload size read int version serial serial version serial messag servic verb serial verb serial instanceof messag servic callback determin serial callback info callback messag servic instanc regist callback callback null repli expir callback skip file util skip byte fulli payload size return null serial version serial callback serial payload size serial null return creat null paramet verb version payload serial deseri version return messag creat payload paramet verb version public stage messag type return messag servic verb stage verb public long timeout return databas descriptor timeout verb public string string string builder sbuf string builder sbuf append append append append messag type append append verb return sbuf string 