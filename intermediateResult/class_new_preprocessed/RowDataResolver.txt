licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java import java net inet address import java nio byte buffer import java util array list import java util collect import java util list import googl common collect iter import org apach cassandra import org apach cassandra columniter ident queri filter import org apach cassandra filter disk atom filter import org apach cassandra filter queri filter import org apach cassandra filter queri path import org apach cassandra filter slice queri filter import org apach cassandra net async result import org apach cassandra net messag import org apach cassandra net messag import org apach cassandra net messag servic import org apach cassandra util closeabl iter import org apach cassandra util util import org apach cassandra util filter public class row data resolv extend abstract row resolv privat int max live count public list async result repair result collect empti list privat final disk atom filter filter public row data resolv string tabl byte buffer key disk atom filter filter super key tabl filter filter method handl follow scenario mismatch initi read redid digest request full data read case comput version column send diff date replica public row resolv throw digest mismatch logger debug enabl logger debug resolv repli size respons long start time system current time milli column famili resolv repli size list column famili version array list column famili repli size list inet address endpoint array list inet address repli size messag read respons messag repli read respons respons messag payload column famili respons row assert respons digest queri receiv digest respons repair read messag version add endpoint add messag comput max live count prevent short read https issu apach org jira brows int live count null filter live count live count max live count max live count live count resolv resolv superset version logger debug enabl logger debug version merg send updat ani replica part full row resolv null version doesn null becaus call remov delet resolv super set resolv null repair result schedul repair resolv tabl key version endpoint els resolv repli iter payload row logger debug enabl logger debug resolv system current time milli start time return row key resolv row version compar resolv superset row version anyth send mutat endpoint public static list async result schedul repair column famili resolv string tabl decor key key list column famili version list inet address endpoint list async result result array list async result version size int version size column famili diff column famili diff version resolv diff null repair happen continu creat send row mutat messag base diff row mutat row mutat row mutat tabl key key row mutat add diff messag repair messag separ verb becaus don white glove hint timeout behavior real mutat repair messag row mutat creat messag messag servic verb result add messag servic instanc send repair messag endpoint return result static column famili resolv superset iter column famili version assert iter size version column famili resolv null column famili version null continu resolv null resolv clone shallow els resolv delet resolv null return null mimic collect collat column remov delet path column famili handl remov column subcolumn supress row supercolumn tombston queri filter filter queri filter null queri path resolv metadata ident queri filter list closeabl iter column iter array list closeabl iter column column famili version version version null continu iter add util closeabl iter version iter filter collat column resolv iter integ return column famili store remov delet resolv integ public row data throw return repli iter payload row public boolean data present return repli empti public int max live count return max live count 