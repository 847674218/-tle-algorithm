licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra gms import java import java util map import org slf logger import org slf logger factori import org apach cassandra type size import org apach cassandra version serial import org cliffc high scale lib block hash map abstract repres heart beat state applic state endpoint state instanc ani state endpoint retriev instanc public class endpoint state protect static final logger logger logger factori logger endpoint state class public final static version serial endpoint state serial endpoint state serial privat volatil heart beat state state final map applic state version valu applic state block hash map applic state version valu field serial privat volatil long updat timestamp privat volatil boolean aliv endpoint state heart beat state initi state state initi state updat timestamp system current time milli aliv true heart beat state heart beat state return state void set heart beat state heart beat state state updat timestamp state state public version valu applic state applic state key return applic state key replac oper don expos privat state deprec public map applic state version valu applic state map return applic state void add applic state applic state key version valu valu applic state put key valu getter setter public long updat timestamp return updat timestamp void updat timestamp updat timestamp system current time milli public boolean aliv return aliv void mark aliv aliv true void mark dead aliv fals class endpoint state serial implement version serial endpoint state public void serial endpoint state state data output dos int version throw serial heart beat state heart beat state state state heart beat state heart beat state serial serial state dos version serial map applic state object int size state applic state size dos write int size map entri applic state version valu entri state applic state entri set version valu valu entri valu dos write int entri key ordin version valu serial serial valu dos version public endpoint state deseri data input dis int version throw heart beat state state heart beat state serial deseri dis version endpoint state state endpoint state state int app state size dis read int int app state size int key dis read int version valu valu version valu serial deseri dis version state add applic state gossip key valu return state public long serial size endpoint state state int version long size heart beat state serial serial size state heart beat state version size type size sizeof state applic state size map entri applic state version valu entri state applic state entri set version valu valu entri valu size type size sizeof entri key ordin size version valu serial serial size valu version return size 