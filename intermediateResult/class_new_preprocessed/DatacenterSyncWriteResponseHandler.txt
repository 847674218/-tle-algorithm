licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java net inet address import java util collect import java util hash map import java util map import java util concurr atom atom integ import googl common collect iter import org apach cassandra config databas descriptor import org apach cassandra tabl import org apach cassandra unavail import org apach cassandra gms failur detector import org apach cassandra locat endpoint snitch import org apach cassandra locat network topolog strategi import org apach cassandra net messag import org apach cassandra consist level import org apach cassandra write type import org apach cassandra util util class block quorum respons datacent public class datacent sync write respons handler extend abstract write respons handler privat static final endpoint snitch snitch databas descriptor endpoint snitch privat final network topolog strategi strategi privat final hash map string atom integ respons hash map string atom integ public datacent sync write respons handler collect inet address natur endpoint collect inet address pend endpoint consist level consist level tabl tabl runnabl callback write type write type respons manag map superclass super tabl natur endpoint pend endpoint consist level callback write type assert consist level consist level strategi network topolog strategi tabl replic strategi string strategi datacent int strategi replic factor respons put atom integ public void respons messag messag string data center messag null databas descriptor local data center snitch datacent messag respons data center decrement atom integ respons valu return quorum condit met signal protect int ack count int map entri string atom integ entri respons entri set string entri key atom integ entri valu strategi replic factor return public boolean latenc snitch return fals 