licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stream import java data input import java data output import java import java net inet address import java util array list import java util collect import java util list import java util import googl common collect iter import org apach cassandra column famili import org apach cassandra column famili store import org apach cassandra type size import org apach cassandra tabl import org apach cassandra dht abstract bound import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra version serial import org apach cassandra net compact endpoint serial helper import org apach cassandra net messag import org apach cassandra net messag servic import org apach cassandra util serial class encapsul messag node handoff data messag inform rang transfer target node file specifi rang tabl vice versa hold public class stream request public static final version serial stream request serial stream request serial protect final session protect final inet address target specifi rang tabl protect final pend file file specifi file protect final collect rang token rang protect final string tabl protect final iter column famili store column famili protect final oper type type stream request inet address target collect rang token rang string tabl iter column famili store column famili session oper type type target target rang rang tabl tabl column famili column famili session session type type file null stream request inet address target pend file file session target target file file session session type file type rang null tabl null column famili null public messag stream request creat messag return messag stream request messag servic verb serial public string string string builder string builder file null append tabl append append column famili string append append target append rang token rang rang append rang append append type els append file string return string privat static class stream request serial implement version serial stream request public void serial stream request srm data output dos int version throw serial serial serial srm session dos messag servic current version compact endpoint serial helper serial srm target dos srm file null dos write boolean true pend file serial serial srm file dos version els dos write boolean fals dos write srm tabl dos write int srm rang size rang token rang srm rang abstract bound serial serial rang dos version dos write srm type dos write int iter size srm column famili column famili store cfs srm column famili column famili serial serial cfs metadata dos version public stream request deseri data input dis int version throw session serial serial deseri dis messag servic current version inet address target compact endpoint serial helper deseri dis boolean singl file dis read boolean singl file pend file file pend file serial deseri dis version return stream request target file session els string tabl dis read int size dis read int list rang token rang size null array list rang token size int size rang add rang token abstract bound serial deseri dis version token bound oper type type oper type valu dis read list column famili store store array list column famili store int cfs size dis read int int cfs size store add tabl open tabl column famili store column famili serial deseri dis version return stream request target rang tabl store session type public long serial size stream request int version long size type size sizeof session size compact endpoint serial helper serial size target size type size sizeof true file null return size pend file serial serial size file version size type size sizeof tabl size type size sizeof rang size rang token rang rang size abstract bound serial serial size rang version size type size sizeof type size type size sizeof iter size column famili column famili store cfs column famili size column famili serial serial size cfs metadata type size version return size 