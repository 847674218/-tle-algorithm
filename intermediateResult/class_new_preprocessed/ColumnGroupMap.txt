licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import java nio byte buffer import java util array list import java util hash map import java util list import java util map import org apach cassandra column import org apach cassandra marshal composit type import org apach cassandra util pair public class column group map privat final byte buffer full path privat final map byte buffer valu map hash map byte buffer valu privat column group map byte buffer full path full path full path privat void add byte buffer full int idx column column byte buffer column full idx full length idx collect valu map column null collect map put column assert instanceof collect collect add pair creat full idx column els assert map key column map put column simpl column public byte buffer key compon int pos return full path pos public column simpl byte buffer key valu map key null return null assert instanceof simpl return simpl column public list pair byte buffer column collect byte buffer key valu map key null return null assert instanceof collect return list pair byte buffer column privat interfac valu privat static class simpl implement valu public final column column simpl column column column column privat static class collect extend array list pair byte buffer column implement valu public static class builder privat final composit type composit privat final int idx privat byte buffer previous privat final list column group map group array list column group map privat column group map current group public builder composit type composit boolean collect composit composit idx composit type size collect public void add column mark delet return byte buffer current composit split current group null current group column group map current current group add current idx previous current return group current group add current group current group column group map current current group add current idx previous current spars composit return wheter column belong cql row previous ad base full list compon column belong togeth differ onli compon privat boolean group byte buffer int idx equal previous return fals return true public list column group map group current group null group add current group current group null return group 