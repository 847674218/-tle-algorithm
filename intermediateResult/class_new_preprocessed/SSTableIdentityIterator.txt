licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java import org slf logger import org slf logger factori import org apach cassandra config meta data import org apach cassandra import org apach cassandra columniter countabl column iter import org apach cassandra marshal marshal import org apach cassandra column serial import org apach cassandra util random access reader import org apach cassandra util byte read tracker public class tabl ident iter implement compar tabl ident iter countabl column iter privat static final logger logger logger factori logger tabl ident iter class privat final decor key key privat final data input input privat final long data start public final long data size public final column serial flag flag privat final column famili column famili privat final int column count privat final long column posit privat final disk atom serial atom serial privat final descriptor version data version privat final byte read tracker input tracker track byte read lazili compact row deseri time privat final int expir befor privat final boolean valid column privat final string filenam iter column row param sstabl tabl read ffrom param file read file param key key row param data start data row start pos param data size length row data throw public tabl ident iter tabl reader sstabl random access reader file decor key key long data start long data size sstabl file key data start data size fals iter column row param sstabl tabl read ffrom param file read file param key key row param data start data row start pos param data size length row data param check data true deseri check coher row data public tabl ident iter tabl reader sstabl random access reader file decor key key long data start long data size boolean check data sstabl metadata file file path key data start data size check data sstabl column serial flag onli current file format public tabl ident iter meta data metadata data input file string filenam decor key key long data start long data size column serial flag flag metadata file filenam key data start data size fals null flag sstabl null check data fals null assum data current file format privat tabl ident iter meta data metadata data input input string filenam decor key key long data start long data size boolean check data tabl reader sstabl column serial flag flag assert check data sstabl null input input filenam filenam input tracker byte read tracker input key key data start data start data size data size expir befor int system current time milli flag flag valid column check data data version sstabl null descriptor version sstabl descriptor version tri input instanceof random access reader random access reader file random access reader input file seek data start data start data size file length throw string format data size start larger file length data size data start file path file length check data sstabl descriptor version promot index tri index helper defreez bloom filter file data size sstabl descriptor version filter type catch instanceof throw logger debug invalid bloom filter rebuild sstabl tri freez left file posit readi deseri index index helper deseri index file catch logger debug invalid row summari rebuild sstabl file seek data start input tracker reset sstabl null sstabl descriptor version promot index index helper skip bloom filter input tracker index helper skip index input tracker column famili column famili creat metadata column famili delet delet info serial deseri tabl input tracker data version atom serial column famili disk serial column count input tracker read int column posit data start input tracker byte read catch sstabl null sstabl mark suspect throw corrupt tabl filenam public decor key key return key public column famili column famili return column famili public boolean return input tracker byte read data size public disk atom tri disk atom atom atom serial deseri tabl input tracker flag expir befor data version valid column atom valid field column famili metadata return atom catch throw corrupt tabl filenam catch marshal throw corrupt tabl filenam public void remov throw unsupport oper public void close creator respons close file finish public string path input file return path otherwis stream input instanceof random access reader random access reader file random access reader input return file path els throw unsupport oper public column famili column famili column sort column factori factori throw assert input tracker byte read header size column famili column famili clone shallow factori fals sinc alreadi read column count pass valu continu deseri column famili serial deseri column tabl input tracker column count flag expir befor data version valid column tri valid column field catch marshal throw runtim error valid row key return privat long header size return column posit data start public int compar tabl ident iter return key compar key public void reset input instanceof random access reader throw unsupport oper random access reader file random access reader input file seek column posit input tracker reset header size public int column count return column count 