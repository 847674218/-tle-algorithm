licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java import java nio byte buffer import org apach cassandra column famili import org apach cassandra read respons import org apach cassandra row import org apach cassandra net messag public class row digest resolv extend abstract row resolv public row digest resolv string tabl byte buffer key super key tabl special case resolv read throw digest mismatch foreground public row data throw messag read respons messag repli read respons result messag payload result digest queri return result row throw assert error data invok data present method handl differ scenario handl initi read data closest replica digest rest case check digest throw mismatch otherwis return data row check addit digest arriv minimum handl request consist level asynchron read repair check public row resolv throw digest mismatch logger debug enabl logger debug resolv repli size respons long start time system current time milli valid digest throw immedi mismatch extract data repli ani column famili data null byte buffer digest null messag read respons messag repli read respons respons messag payload respons digest queri digest null digest respons digest els byte buffer digest respons digest digest equal digest throw digest mismatch key digest digest els data respons row compar digest onli sinc threw earlier differ repli data respons mismatch throw read repair happen import note consid possibl multipl data respons onli happen repair post mismatch handl row data resolv digest null byte buffer digest column famili digest data digest equal digest throw digest mismatch key digest digest logger debug enabl logger debug digest verifi logger debug enabl logger debug resolv system current time milli start time return row key data public boolean data present messag read respons messag repli messag payload digest queri return true return fals 