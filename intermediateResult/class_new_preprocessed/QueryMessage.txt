licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra transport messag import java util import googl common collect immut map import org jboss netti buffer channel buffer import org jboss netti buffer channel buffer import org apach cassandra cql queri processor import org apach cassandra consist level import org apach cassandra import org apach cassandra servic queri state import org apach cassandra trace trace import org apach cassandra transport import org apach cassandra util util import org apach cassandra util gen queri public class queri messag extend messag request public static final messag codec queri messag codec messag codec queri messag public queri messag decod channel buffer bodi string queri util read long string bodi consist level consist util read consist level bodi return queri messag queri consist public channel buffer encod queri messag msg return channel buffer wrap buffer util long string msg queri util consist level msg consist public final string queri public final consist level consist public queri messag string queri consist level consist super messag type queri queri consist consist public channel buffer encod return codec encod public messag respons execut queri state state tri trace null trace request trace gen time state prepar trace session trace state trace queri state creat trace session trace instanc execut queri immut map queri queri messag respons respons queri processor process queri consist state trace null respons set trace trace return respons catch instanceof request valid instanceof request execut logger error unexpect error dure queri return error messag final trace instanc stop session overrid public string string return queri 