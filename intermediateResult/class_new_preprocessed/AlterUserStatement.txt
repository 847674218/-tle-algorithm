licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import org apach cassandra auth auth import org apach cassandra auth authent user import org apach cassandra auth authent import org apach cassandra config databas descriptor import org apach cassandra cql user option import org apach cassandra invalid request import org apach cassandra request execut import org apach cassandra unauthor import org apach cassandra servic client state import org apach cassandra transport messag result messag public class alter user statement extend authent statement privat final string usernam privat final user option opt privat final boolean superus public alter user statement string usernam user option opt boolean superus usernam usernam opt opt superus superus public void valid client state state throw invalid request opt valid superus null opt empti throw invalid request empti auth exist user usernam throw invalid request string format user doesn exist usernam public void check access client state state throw unauthor state valid login authent user user state user superus null user equal usernam throw unauthor aren alter superus status superus null user super throw unauthor onli superus alter superus status user super user equal usernam throw unauthor aren alter user user super authent option option opt option key set databas descriptor authent alter option option throw unauthor string format aren alter option option public result messag execut client state state throw invalid request request execut opt empti databas descriptor authent alter usernam opt option superus null auth insert user usernam superus boolean valu return null 