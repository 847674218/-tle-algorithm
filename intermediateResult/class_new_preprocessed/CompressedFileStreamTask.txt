licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stream compress import java import java net inet address import java nio byte buffer import java nio channel file channel import java nio channel socket channel import java util array list import java util list import org slf logger import org slf logger factori import org apach cassandra compress compress metadata import org apach cassandra util file util import org apach cassandra util random access reader import org apach cassandra metric stream metric import org apach cassandra net messag servic import org apach cassandra stream file stream task import org apach cassandra stream stream header import org apach cassandra util byte buffer util import org apach cassandra util pair file stream task compress tabl class send relev part compress file direct nio avail public class compress file stream task extend file stream task privat static final logger logger logger factori logger compress file stream task class chunk public static final int public compress file stream task stream header header inet address super header protect void stream throw assert header file compress info null socket channel socket channel byte transfer buffer null write header byte buffer header buffer messag servic instanc construct stream header header fals messag servic instanc version socket output stream write byte buffer util array header buffer random access reader file random access reader open file header file filenam true file channel file channel stream metric activ stream outbound calcul chunk transfer send continu chunk altogeth list pair long long section transfer section header file compress info chunk tri long total byte transfer stream requir section file pair long long section section length section stream long length section section left track write progress long byte transfer byte transfer length int transfer int math min length byte transfer long write null write transfer section left byte transfer transfer throttl throttl delta write els avail fall normal stream happen inter node encrypt turn transfer buffer null transfer buffer byte file read fulli transfer buffer transfer socket output stream write transfer buffer transfer throttl throttl delta transfer write transfer total byte transfer write byte transfer write header file progress write logger debug byte transfer byte transfer header file size stream metric total outgo byte total byte transfer metric outgo byte total byte transfer receiv repli confirm receiv repli final stream metric activ stream outbound dec matter happen close file file util close quiet file chunk assum sort offset privat list pair long long transfer section compress metadata chunk chunk list pair long long transfer section array list pair long long pair long long section null compress metadata chunk chunk chunk section null chunk offset section extend previous section chunk section pair creat section left chunk offset chunk length byte els transfer section add section section pair creat chunk offset chunk offset chunk length els section pair creat chunk offset chunk offset chunk length section null transfer section add section return transfer section 