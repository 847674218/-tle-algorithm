licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra locat import java input stream import java net inet address import java net unknown host import java util hash map import java util map import java util properti import org slf logger import org slf logger factori import org apach cassandra configur import org apach cassandra util file util import org apach cassandra servic storag servic import org apach cassandra util util import org apach cassandra util resourc watcher import org apach cassandra util wrap runnabl determin datacent rack base properti file follow format default public class properti file snitch extend abstract network topolog snitch privat static final logger logger logger factori logger properti file snitch class public static final string cassandra topolog properti privat static volatil map inet address string endpoint map privat static volatil string default rack privat volatil boolean gossip start public properti file snitch throw configur reload configur tri util resourc file runnabl runnabl wrap runnabl protect void run throw throw configur reload configur resourc watcher watch runnabl catch configur logger debug doe plain file watch chang raw inform point param endpoint endpoint process return array string index data center rack public string endpoint info inet address endpoint string raw endpoint info raw endpoint info endpoint raw endpoint info null throw runtim unknown host endpoint default configur return raw endpoint info privat string raw endpoint info inet address endpoint string valu endpoint map endpoint valu null logger debug find point inform default endpoint return default rack return valu return data center endpoint resid param endpoint endpoint process return string data center public string datacent inet address endpoint string info endpoint info endpoint assert info null locat defin endpoint endpoint return info return rack endpoint resid param endpoint endpoint process return string rack public string rack inet address endpoint string info endpoint info endpoint assert info null locat defin endpoint endpoint return info public void reload configur throw configur hash map inet address string reload map hash map inet address string properti properti properti input stream stream null tri stream class class loader resourc stream properti load stream catch throw configur unabl read final file util close quiet stream map entri object object entri properti entri set string key string entri key string valu string entri valu key equal default string default valu split default length default rack string default default els default rack string default trim default trim els inet address host string host string key replac tri host inet address host string catch unknown host throw configur unknown host host string string token valu split token length token string default default els token string token trim token trim reload map put host token reload map key util broadcast address throw configur string format snitch definit defin locat node broadcast address util broadcast address logger debug load network topolog util string reload map endpoint map reload map storag servic instanc null null check toler circular depend storag servic instanc token metadata invalid cach gossip start storag servic instanc gossip snitch info overrid public void gossip start gossip start true 