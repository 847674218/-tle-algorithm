privat void restor replica count inet address endpoint final inet address notifi endpoint final multimap inet address string fetch sourc hash multimap creat multimap string map entri inet address collect rang token rang fetch hash multimap creat final inet address address util broadcast address string tabl schema instanc system tabl multimap rang token inet address chang rang chang rang leav tabl endpoint set rang token rang hash set rang token map entri rang token inet address entri chang rang entri entri valu equal address rang add entri key multimap inet address rang token sourc rang sourc rang tabl rang map entri inet address collect rang token entri sourc rang map entri set fetch sourc put entri key tabl rang fetch put tabl entri final string tabl rang fetch key set map entri inet address collect rang token entri rang fetch tabl final inet address sourc entri key collect rang token rang entri valu final stream callback callback stream callback public void success synchron fetch sourc fetch sourc remov sourc tabl fetch sourc empti send replic notif notifi endpoint public void failur logger warn stream sourc fail success call success send notif logger debug enabl logger debug request sourc rang string util join rang stream request rang sourc tabl rang callback oper type 