public link hash map inet address float effect ownership string keyspac throw illeg state schema instanc system tabl size throw illeg state couldn find ani system keyspac infer replic topolog keyspac null replic schema instanc system tabl throw illeg state system keyspac doesnt topolog token metadata metadata token metadata clone onli token map keyspac null keyspac schema instanc system tabl collect collect inet address endpoint group array list collect inet address map node sort map dcs sort sort map string collect inet address sort dcs endpoint tree map string collect inet address sort dcs endpoint put metadata topolog datacent endpoint map collect inet address endpoint sort dcs endpoint valu endpoint group add endpoint map token float token ownership partition describ ownership token metadata sort token link hash map inet address float final ownership map link hash map calcul ownership collect inet address endpoint endpoint group calcul ownership replic add endpoint final ownership map inet address endpoint endpoint float ownership rang token rang rang endpoint keyspac endpoint token ownership key rang ownership token ownership rang final ownership put endpoint ownership return final ownership 