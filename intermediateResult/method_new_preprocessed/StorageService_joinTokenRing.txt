privat void join token ring int delay throw configur logger info start server gossip join true seed host endpoint map token metadata updat host system tabl local host util broadcast address start gossip servic befor ani info node necessari bootstrap load info won part storag ring add counter state map applic state version valu app state hash map applic state version valu app state put applic state valu factori network version app state put applic state valu factori host system tabl local host app state put applic state valu factori rpcaddress databas descriptor rpc address databas descriptor replac token size app state put applic state valu factori hibern true app state put applic state valu factori releas version gossip instanc regist gossip instanc regist migrat manag gossip instanc start system tabl increment generat app state node ring gather gossip snitch info local rack gossip snitch info gossip schema empti version forc immedi check schema updat migrat manag mayb schedul schema pull schema instanc updat version announc ensur actual schema prepar updat messag servic instanc listen util local address load broadcast instanc start broadcast hint hand manag instanc start batchlog manag instanc start bootstrap haven success bootstrap befor long seed seed user manual set auto bootstrap fals skip stream data node jump direct ring seed check skip sleep singl node cluster case user test attempt replac schema presenc check meaning sleep schema info gossip defeat purpos gori detail set inet address current hash set inet address collect token token logger debug bootstrap variabl object databas descriptor auto bootstrap system tabl bootstrap progress system tabl bootstrap complet databas descriptor seed util broadcast address databas descriptor auto bootstrap system tabl bootstrap complet databas descriptor seed util broadcast address system tabl bootstrap progress logger warn detect previous bootstrap failur retri els system tabl set bootstrap state system tabl bootstrap state set mode mode wait ring inform true sleep delay peer int delay schema proceed check direct schema instanc version equal schema empti version logger debug schema schema instanc version break tri thread sleep catch interrupt throw assert error schema hasn match sleep doe post don expect necessari veri doesn hurt care migrat manag readi bootstrap set mode mode wait schema inform complet true tri thread sleep catch interrupt throw assert error set mode mode schema complet readi bootstrap true logger debug enabl logger debug ring schema info databas descriptor replac token size token metadata member util broadcast address string node alreadi member token ring bootstrap abort replac dead node remov ring throw unsupport oper set mode mode bootstrap token true token boot strapper bootstrap token token metadata load broadcast instanc load info els tri sleep addit server actual aliv give time gossip aliv thread sleep load broadcast catch interrupt throw assert error token array list token string token databas descriptor replac token token add storag servic partition token factori string token check oper error token token token inet address exist token metadata endpoint token exist null gossip instanc endpoint state endpoint exist updat timestamp system current time milli delay throw unsupport oper cannnot replac token live node current add exist set mode mode replac node token token true bootstrap token assert bootstrap mode bootstrap block finish els token system tabl save token token empti collect string initi token databas descriptor initi token initi token size token boot strapper random token token metadata databas descriptor num token databas descriptor num token logger warn generat random token token random token result unbalanc ring http wiki apach org cassandra oper els logger info generat random token token token els token array list token string token initi token token add partition token factori string token logger info save token token configur els alreadi bootstrap token num token set higher config migrat multi token token size databas descriptor num token wait ring info logger info sleep ring delay delay tri thread sleep delay catch interrupt throw assert error logger info calcul token calcul num token token space rang left token token iter token metadata clone token metadata clone onli token map clone updat normal token util broadcast address token left clone predecessor num token token space token current token int tok tok databas descriptor num token tok token left token iter calcul locat token midpoint num iter number bit mantissa includ implicit lead stop earli termin fraction altern add interpol method partition doubl frac doubl tok doubl databas descriptor num token token midpoint partition midpoint int frac frac bug break els frac midpoint frac els midpoint midpoint partition midpoint token add midpoint logger info split previous rang left token els logger info save token token survey mode start particip ring system tabl set bootstrap state system tabl bootstrap state set token token remov exist info replac node current empti inet address exist current gossip instanc replac endpoint exist logger info startup complet serv read assert token metadata sort token size setup default superus auth setup superus els logger info startup complet write survey mode activ becom activ ring member storag servic join ring final ring join 