public doubl sum doubl doubl sum find point pnext satisfi pnext map entri doubl long pnext bin higher entri pnext null greater ani key histogram count return long valu bin valu sum valu els map entri doubl long bin floor entri null return calcul estim count point doubl weight key pnext key key doubl valu pnext valu valu weight sum valu weight sum valu long valu bin head map key fals valu sum valu return sum 