public long append stream decor key key meta data metadata long data size data input throw long current posit befor append key long data start tri byte buffer util write short length key key data file stream data start data file file pointer write row size data file stream write long data size catch throw write error data file path delet info delet info delet info serial deseri tabl descriptor version int column count read int tri delet info serial serial tabl delet info data file stream data file stream write int column count catch throw write error data file path deseri column obtain max timestamp immedi serial long min timestamp long long max timestamp long stream histogram tombston stream histogram column famili column famili creat metadata array sort column factori delet delet info column index builder column index column index builder key key column count data file stream disk atom serial atom serial disk serial int column count deseri column becaus written data size base data size receiv reseri exact data disk atom atom atom serial deseri tabl column serial flag integ descriptor version atom instanceof counter column atom counter column atom mark delta clear els atom instanceof super column super column super column atom column column column column instanceof counter column column mark counter column column mark delta clear replac column mark int delet time atom local delet time delet time integ tombston updat delet time min timestamp math min min timestamp atom min timestamp max timestamp math max max timestamp atom max timestamp tri column index add atom write atom disk catch throw write error data file path assert data size data file file pointer data start incorrect row data size data size written data file path correct data file file pointer data start sstabl metadata collector updat min timestamp min timestamp sstabl metadata collector updat max timestamp max timestamp sstabl metadata collector add row size data file file pointer current posit sstabl metadata collector add column count column count sstabl metadata collector merg tombston histogram tombston append key current posit delet info column index build return current posit 