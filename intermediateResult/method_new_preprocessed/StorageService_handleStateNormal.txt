privat void handl state normal final inet address endpoint string piec assert piec length pars version valu accord point version version version app state collect token token token token endpoint piec logger debug enabl logger debug node endpoint state normal token token token metadata member endpoint logger info node endpoint state jump normal client mode endpoint lifecycl subscrib subscrib lifecycl subscrib subscrib endpoint els client mode endpoint lifecycl subscrib subscrib lifecycl subscrib subscrib join cluster endpoint order matter updat host call befor updat normal token gossip instanc host endpoint token metadata updat host gossip instanc host endpoint endpoint set token token updat metadata hash set token set token token updat system tabl hash set token set token local token remov hash set token set inet address endpoint remov hash set inet address multimap inet address token token copi token metadata endpoint token map read final token token token don updat node respons token startup time endpoint inet address current owner token metadata endpoint token current owner null logger debug node endpoint token token token updat metadata add token client mode token updat system tabl add token els endpoint equal current owner set state normal sinc node tri leav fail persist token chang token updat metadata add token els token metadata reloc token token metadata reloc rang token equal endpoint token reloc bookkeep offici token updat metadata add token client mode token updat system tabl add token option task schedul runnabl public void run logger info remov state endpoint token token metadata remov reloc token endpoint time unit token token remov system local current owner equal util broadcast address local token remov add token logger info token reloc token endpoint els token metadata reloc token logger info token reloc ignor updat object token token metadata reloc rang token endpoint els gossip instanc compar endpoint startup endpoint current owner token updat metadata add token client mode token updat system tabl add token current owner longer current endpoint track move becaus host longer ani token remov token copi current owner remov token token copi current owner size endpoint remov add current owner logger info string format node token owner endpoint current owner token endpoint logger debug enabl logger debug reloc rang token metadata print reloc rang els logger info string format node token ignor endpoint current owner token endpoint logger debug enabl logger debug reloc rang token metadata print reloc rang token metadata updat normal token token updat metadata endpoint inet address endpoint remov remov endpoint token updat system tabl empti system tabl updat token endpoint token updat system tabl local token remov empti system tabl updat local token collect token empti list local token remov token metadata move endpoint endpoint move token token metadata remov move endpoint client mode endpoint lifecycl subscrib subscrib lifecycl subscrib subscrib move endpoint calcul pend rang 