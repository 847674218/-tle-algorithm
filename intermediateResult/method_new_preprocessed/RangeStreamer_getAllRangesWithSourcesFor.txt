privat multimap rang token inet address rang sourc string tabl collect rang token desir rang abstract replic strategi strat tabl open tabl replic strategi multimap rang token inet address rang address strat rang address metadata clone onli token map multimap rang token inet address rang sourc array list multimap creat rang token desir rang desir rang rang token rang rang address key set rang desir rang list inet address prefer databas descriptor endpoint snitch sort list proxim address rang address rang rang sourc put desir rang prefer break rang sourc key set desir rang throw illeg state sourc desir rang return rang sourc 