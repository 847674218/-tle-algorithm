privat sort set byte buffer request column list byte buffer variabl throw invalid request assert column rang column builder builder def column builder restrict column restrict assert null equal valu size assert def compact onli support column creat column return sort set byte buffer column tree set byte buffer def cfm compar iter term iter valu iter iter term iter column builder iter builder copi builder byte buffer cname add relat type variabl build column add cname return column els builder add valu relat type variabl def compact return util singleton builder build els collect requir slice queri becaus collect set column shouldn assert def collect sort set byte buffer column tree set byte buffer def cfm compar queri select column marker column case row exist column outsid static composit compact don marker queri column def composit marker column add builder copi add byte buffer util build select column pair definit selector expand select column add builder copi add key build els iter column identifi iter def metadata key set iter iter column identifi iter column builder iter builder copi builder byte buffer cname add key build column add cname return column 