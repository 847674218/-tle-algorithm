public futur switch memtabl final boolean write commit log boolean forc switch writelock updat ongo updat memtabl complet tail log start posit log replay recoveri whi tabl switch lock global tabl schedul discard complet segment call order context commitlog posit read flush executor multithread tabl switch lock write lock lock tri final futur replay posit ctx write commit log commit log instanc context futur immedi futur replay posit submit memtabl ani index cfses final list column famili store icc array list column famili store don assum memtabl dirti forc flush bring dure index build column famili store cfs concat index forc switch cfs memtabl thread safe clean icc add cfs final count latch latch count latch icc size column famili store cfs icc memtabl memtabl cfs data switch memtabl forc switch possibl clean memtabl case sinc switch alreadi remov memtabl pend flush memtabl clean cfs replac flush memtabl null latch count els logger info enqueu flush memtabl memtabl flush signal latch ctx metric memtabl switch count count long metric memtabl switch count clear metric memtabl switch count memtabl written includ index mark flush commitlog header executor memtabl flush call order wait flush futur anyth latenc sensit return post flush executor submit wrap runnabl public void run throw throw interrupt execut latch await icc empti onli valid memtabl exist secondari index index index manag index cfs flush ani cfs index logger info flush secondari index index index forc block flush write commit log write commit log replay log mark log header discard anyth written befor context valid commit log instanc discard complet segment metadata ctx final tabl switch lock write lock unlock 