privat void handl legaci version int version throw data input stream data input stream buffer input stream socket input stream receiv messag version whi logger debug version version version messag servic current version save endpoint gossip reconnect gossip instanc add save endpoint logger info receiv messag newer protocol version ignor return int version messag servic instanc set version version logger debug set version version version version logger debug break outbound connect forc version upgrad messag servic instanc connect pool reset newer version version true messag servic valid magic read int int header read int legaci protocol send header messag assert messag servic bit header stream connect chang stream version messag servic bit header logger trace version version receiv messag version 