privat static set string merg keyspac map decor key column famili map decor key column famili updat calcul differ state note entri onli left alway empti map differ decor key column famili diff map differ updat step check ani keyspac ad map entri decor key column famili entri diff entri onli entri set column famili attr entri valu don care nest column famili becaus process separ attr empti add keyspac meta data schema row entri key entri valu collect meta data empti list step check ani keyspac creat context creat previous delet exist level schema empti key map decor key map differ valu differ column famili modifi entri diff entri differ loop modifi entri skip process key time store left process item iter remov alreadi met key list decor key left process array list decor key modifi entri size map entri decor key map differ valu differ column famili entri modifi entri entri set column famili prev valu entri valu left valu column famili valu entri valu valu prev valu empti add keyspac meta data schema row entri key valu collect meta data empti list continu left process add entri key left process size return collect empti set final step updat modifi keyspac save keyspac drop set string keyspac drop hash set string decor key key left process map differ valu differ column famili valu diff modifi entri key column famili state valu diff valu state empti keyspac drop add ascii type instanc string key key els updat keyspac meta data schema row key state collect meta data empti list return keyspac drop 