privat void load boolean recreatebloom throw segment file builder ibuild segment file builder databas descriptor index access mode segment file builder dbuilder compress segment file compress builder segment file builder databas descriptor disk access mode read posit don worri entri span mmap boundari random access reader primari index random access reader open file descriptor filenam compon true tri load summari disk check read primari index becaus creat bloom filter pre load key cach final boolean summari load load summari ibuild dbuilder final boolean read index recreatebloom summari load tri long index size primari index length long histogram count sstabl metadata estim row size count long estim key histogram count sstabl metadata estim row size overflow histogram count estim row index primari index statist suppos option recreatebloom legaci bloom filter filter estim key summari load index summari index summari estim key long index posit read index index posit primari index file pointer index size byte buffer key byte buffer util read short length primari index row index entri index entri row index entri serial deseri primari index descriptor version decor key decor key decod key partition descriptor key null decor key decor key recreatebloom add decor key key summari alreadi read disk don popul primari index summari load index summari mayb add entri decor key index posit ibuild add potenti boundari index posit dbuilder add potenti boundari index entri posit final file util close quiet primari index minim key minim key final load index summari complet final state reader ifil ibuild complet descriptor filenam compon dfile dbuilder complet descriptor filenam compon read index save summari inform disk save summari ibuild dbuilder 