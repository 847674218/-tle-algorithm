privat static stream callback wrap callback final runnabl callback final taskid final boolean local task return stream callback expect callback receiv send privat final atom integ outstand atom integ local task public void success outstand decrement wait call return task remov taskid callback null callback run public void failur 