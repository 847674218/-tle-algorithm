privat void calcul stream collect token token list string tabl inet address local address util broadcast address endpoint snitch snitch databas descriptor endpoint snitch token metadata token meta clone settl token metadata clone settl clone avoid concurr modif calcul natur endpoint token metadata token meta clone token metadata clone onli token map string tabl tabl token token token replic strategi current keyspac aka tabl abstract replic strategi strategi tabl open tabl replic strategi collect current rang keyspac collect rang token current rang rang endpoint tabl local address collect rang node serv move token collect rang token updat rang strategi pend address rang token metadata token local address ring rang endpoint associ determin node ping rang data multimap rang token inet address rang address strategi rang address token meta clone calcul part rang request stream node ring pair set rang token set rang token rang tabl calcul stream fetch rang current rang updat rang loop rang fetch determin node ring respons data interest multimap rang token inet address rang fetch prefer endpoint array list multimap creat rang token fetch rang tabl rang token rang rang address key set rang fetch list inet address endpoint snitch sort list proxim local address rang address rang store rang prefer endpoint set rang fetch prefer endpoint put fetch endpoint calcul endpoint stream current rang situat node handl current rang part rang multimap rang token inet address rang endpoint hash multimap creat rang token stream rang tabl left set inet address current endpoint immut set copi strategi calcul natur endpoint stream token meta clone set inet address endpoint immut set copi strategi calcul natur endpoint stream token meta clone settl logger debug rang stream current endpoint current endpoint endpoint endpoint rang endpoint put stream set differ endpoint current endpoint associ tabl rang endpoint map rang stream tabl put tabl rang endpoint multimap inet address rang token work map rang streamer work map rang fetch prefer endpoint rang fetch put tabl work map logger debug enabl logger debug tabl work map tabl work map 