public synchron void drain throw interrupt execut executor servic mutat stage stage manag stage stage mutat stage termin logger warn drain node alreadi happen return set mode mode start drain process true stop server option task shutdown gossip instanc stop set mode mode shut messag servic fals messag servic instanc shutdown set mode mode wait stream fals messag servic instanc wait stream set mode mode clear mutat stage fals mutat stage shutdown mutat stage await termin time unit storag proxi instanc verifi hint progress set mode mode flush column famili fals count sinc forc flush block flush writer queue slot empti total tabl tabl tabl system total tabl column famili store size remain total flush list futur flush array list futur tabl tabl tabl system column famili store cfs tabl column famili store flush add cfs forc flush wait flush godaw track progress sinc flush parallel long sever short instant wait futur flush util wait futur remain flush system rest case flush modifi ani system state don bother progress track sinc system data tini flush clear tabl tabl tabl system column famili store cfs tabl column famili store flush add cfs forc flush util wait futur flush column famili store post flush executor shutdown column famili store post flush executor await termin time unit commit log instanc shutdown block wait miscellan task sstabl commitlog segment delet task shutdown task await termin time unit logger warn miscellan task executor busi minut proceed shutdown set mode mode true 