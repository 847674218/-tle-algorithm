privat static collect inet address batchlog endpoint string local data center throw unavail includ everi node includ localhost token metadata topolog topolog storag servic instanc token metadata clone onli token map topolog collect inet address local member topolog datacent endpoint local data center special case singl node datacent local member size return local member singl node cluster don count local node local member remov util broadcast address includ onli aliv node list inet address candid array list inet address local member size inet address member local member failur detector instanc aliv member candid add member candid empti throw unavail consist level candid size endpoint snitch snitch databas descriptor endpoint snitch snitch sort proxim util broadcast address candid candid candid list return candid 