overrid public void run tri determin connect type decid buffer data input stream data input stream socket input stream messag servic valid magic read int int header read int boolean stream messag servic bit header int version messag servic bit header logger debug connect version version socket inet address stream handl stream version els version messag servic handl legaci version version els handl modern version version header catch logger trace eof read socket close connect reset throw catch logger debug read socket close final close 