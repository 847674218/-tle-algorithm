public static void calcul pend rang abstract replic strategi strategi string tabl token metadata storag servic instanc token metadata multimap rang token inet address pend rang hash multimap creat multi val map token inet address bootstrap token bootstrap token set inet address leav endpoint leav endpoint bootstrap token empti leav endpoint empti move endpoint empti reloc rang empti logger debug enabl logger debug bootstrap leav move node reloc token empti pend rang tabl set pend rang tabl pend rang return multimap inet address rang token address rang strategi address rang copi metadata reflect situat leav oper finish token metadata left metadata clone left rang affect leav node set rang token affect rang hash set rang token inet address endpoint leav endpoint affect rang add address rang endpoint rang find node respons rang leav node rang token rang affect rang set inet address current endpoint immut set copi strategi calcul natur endpoint rang clone onli token map set inet address endpoint immut set copi strategi calcul natur endpoint rang left metadata pend rang put rang set differ endpoint current endpoint stage pend rang updat accord leav oper continu calcul check bootstrap node bootstrap node simpli add remov left metadata check rang inet address endpoint bootstrap token invers key set collect token token bootstrap token invers endpoint left metadata updat normal token token endpoint rang token rang strategi address rang left metadata endpoint pend rang put rang endpoint left metadata remov endpoint endpoint stage pend rang updat accord leav bootstrap node finish calcul check move reloc node move node bootstrap simpli add remov left metadata check rang pair token inet address move move endpoint inet address endpoint move address move node move left token endpoint left metadata updat normal token move left endpoint rang token rang strategi address rang left metadata endpoint pend rang put rang endpoint left metadata remov endpoint endpoint rang reloc map entri token inet address reloc reloc rang entri set inet address endpoint reloc valu address move node token token reloc key left metadata updat normal token token endpoint rang token rang strategi address rang left metadata endpoint pend rang put rang endpoint left metadata remov endpoint endpoint set pend rang tabl pend rang logger debug enabl logger debug pend rang pend rang empti empti print pend rang 