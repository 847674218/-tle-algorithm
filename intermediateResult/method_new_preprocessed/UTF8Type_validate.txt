static boolean valid byte buffer buf buf buf slice int state state state buf remain buf switch state case ascii state stay start return fals els valid byte byte char xdf byte speical case modifi utf null state state els return fals state state els byte byte xef handl byte differ xbf xbf xef xbf xbf byte state state els state state break els byte fun start byte xbf xbf xbf state state els byte xbf xbf xbf state state els xbf xbf xbf state state break els return fals malform break case valid byte byte char xbf return fals state state break case byte return fals state state break case return fals state state break case expect xbf return fals state state break case expect anoth return fals state state break case expect byte byte sequenc degrad byte seq return fals state state break case expect time degener return fals state state break default return fals invalid state state start underflow error return state state 