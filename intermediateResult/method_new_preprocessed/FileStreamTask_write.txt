protect long write random access reader reader long length long byte transfer throw int transfer int math min length byte transfer reader read fulli transfer buffer transfer compressedoutput write transfer buffer transfer throttl throttl delta transfer return transfer 