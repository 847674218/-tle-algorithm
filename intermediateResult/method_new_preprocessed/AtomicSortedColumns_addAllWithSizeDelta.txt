public long add size delta sort column alloc alloc function column column transform secondari index manag updat index oper atom isol add column copi map cheap snap tree clone atom compar swap everyth ad cours forget updat delet time case ad lot column fail final compar swap expens mitig check haven beaten anoth thread everi column addit bail earli avoid unnecessari work possibl holder current modifi long size delta main loop size delta current ref delet info del info current delet info add delet info modifi holder current map clone del info column column sort column size delta modifi add column transform appli column alloc index bail earli beaten ref current continu main loop ref compar set current modifi return size delta 