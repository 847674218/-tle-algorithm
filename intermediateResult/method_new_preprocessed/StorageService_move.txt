privat void move token token throw token null throw move undefin null token token metadata sort token token throw target token token alreadi anoth node address current node inet address local address util broadcast address doesn ani sens vnode environ token metadata token local address size logger error invalid request move token node token move thusli throw unsupport oper node token move thusli list string tabl process schema instanc system tabl check data move node string tabl tabl process token metadata pend rang tabl local address size throw unsupport oper data current move node unabl leav ring gossip instanc add local applic state applic state valu factori move token set mode mode string format move local address local token iter token true set mode mode string format sleep befor start stream fetch rang true tri thread sleep catch interrupt throw runtim sleep interrupt messag rang reloc reloc rang reloc collect singleton token tabl process reloc stream set mode mode fetch rang stream rang true reloc log stream map move count latch stream latch reloc stream reloc log request map move count latch fetch latch reloc request tri stream latch await fetch latch await catch interrupt throw runtim interrupt latch wait stream fetch rang finish messag els set mode mode rang fetch stream true set token collect singleton token set token everyth settl logger debug enabl logger debug success move token local token iter 