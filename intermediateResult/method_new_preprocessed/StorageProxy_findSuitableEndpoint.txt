privat static inet address find suitabl endpoint string tabl byte buffer key string local data center consist level throw unavail tabl tabl tabl open tabl endpoint snitch snitch databas descriptor endpoint snitch list inet address endpoint storag servic instanc live natur endpoint tabl key endpoint empti comput consist level throw unavail block tabl list inet address local endpoint array list inet address inet address endpoint endpoint snitch datacent endpoint equal local data center local endpoint add endpoint local endpoint empti endpoint local pick closest endpoint accord snitch snitch sort proxim util broadcast address endpoint return endpoint els return local endpoint util thread local random int local endpoint size 