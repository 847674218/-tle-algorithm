privat void updat score expens storag servic instanc initi return regist messag servic instanc null messag servic instanc regist regist true doubl max latenc long max penalti hash map inet address long penalti hash map inet address long map entri inet address exponenti decay sampl entri sampl entri set doubl entri valu snapshot median max latenc max latenc long time penalti receiv key entri key receiv entri key system current time milli time penalti system current time milli time penalti time penalti time penalti time penalti penalti put entri key time penalti time penalti max penalti max penalti time penalti map entri inet address exponenti decay sampl entri sampl entri set doubl score entri valu snapshot median max latenc penalti key entri key score penalti entri key doubl max penalti els score max penalti max penalti score storag servic instanc sever entri key score put entri key score 