public token midpoint token token token token big integ avoid long overflow intermedi oper big integ big integ valu long token token token big integ valu long token token token midpoint compar big integ sum add midpoint sum shift els wrap case big integ max big integ valu big integ min big integ valu token length rang bisect min max add give min max max min midpoint max subtract min add add shift midpoint compar max midpoint min add midpoint subtract max return long token midpoint long valu 