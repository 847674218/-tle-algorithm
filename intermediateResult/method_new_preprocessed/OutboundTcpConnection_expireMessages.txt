privat void expir messag true queu messag backlog peek null timestamp system current time milli messag timeout break queu messag backlog poll send thread switch queue add entri backlog activ queue posit relat entri contend client head backlog lock null activ add break drop increment 