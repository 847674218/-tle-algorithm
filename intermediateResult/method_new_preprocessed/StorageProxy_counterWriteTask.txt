privat static runnabl counter write task final mutat mutat final iter inet address target final abstract write respons handler respons handler final string local data center final consist level consist level return local mutat runnabl public void run throw throw assert mutat instanceof counter mutat final counter mutat counter mutat mutat appli mutat appli respons handler respons null send replica ani final set inet address remot set differ immut set copi target immut set util broadcast address replic write remot empti replic anoth stage becaus involv read replic mutat avoid block stage stage manag stage stage execut droppabl runnabl messag servic verb public void run throw throw overload send mutat replica send hint endpoint replic mutat remot respons handler local data center consist level 