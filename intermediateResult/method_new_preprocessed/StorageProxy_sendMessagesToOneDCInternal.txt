privat static void send messag intern messag messag collect inet address target boolean local abstract write respons handler handler throw iter inet address iter target iter inet address target iter direct write local cassandra version local messag servic instanc version target messag servic loop loop code clunki avoid creat iter sinc alreadi perfect good messag servic instanc send messag target handler iter target iter messag servic instanc send messag target handler return add destin messag entri fast byte array output stream bos fast byte array output stream data output stream dos data output stream bos dos write int target size iter inet address destin iter compact endpoint serial helper serial destin dos string messag servic instanc add callback handler messag destin messag timeout dos write logger trace ad messag destin messag messag paramet row mutat bos byte array send combin messag header string messag servic instanc send messag target handler logger trace send messag target 