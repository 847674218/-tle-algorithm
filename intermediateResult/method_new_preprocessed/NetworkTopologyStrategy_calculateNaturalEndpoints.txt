suppress warn serial public list inet address calcul natur endpoint token search token token metadata token metadata set inet address replica hash set inet address replica map string set inet address replica hash map string set inet address datacent size map entri string integ datacent entri set put key hash set inet address valu topolog topolog token metadata topolog endpoint check exhaust member multimap string inet address endpoint topolog datacent endpoint rack check exhaust rack map string multimap string inet address rack topolog datacent rack assert endpoint empti rack empti awar ani cluster member track rack alreadi place replica map string set string rack hash map string set string datacent size map entri string integ datacent entri set put key hash set string track endpoint skip uniqu rack relax rack uniqu append current result don wind iter map string set inet address skip endpoint hash map string set inet address datacent size map entri string integ datacent entri set put key link hash set inet address iter token token iter token metadata ring iter token metadata sort token search token fals token iter suffici replica replica endpoint token token iter inet address token metadata endpoint string snitch datacent alreadi replica datacent key suffici replica replica endpoint continu skip check rack rack size rack key set size replica add replica add els string rack snitch rack rack rack rack skip endpoint add els replica add replica add rack add rack run distinct rack add host skip alreadi rack size rack key set size iter inet address skip skip endpoint iter skip suffici replica replica endpoint inet address skip skip replica add skip replica add skip return array list inet address replica 