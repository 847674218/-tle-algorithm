protect void run throw throw compact lock read lock lock tri sstabl compact executor don tri compact someth alreadi compact earlier collect tabl reader sstabl array list tabl reader data file size descriptor desc data file ineffici perform sensit path tabl reader sstabl lookup tabl cfs desc sstabl null logger info compact activ sstabl desc els sstabl add sstabl tri sstabl empti logger info file compact user defin compact attempt schedul set els cfs data tracker mark compact sstabl success perform compact tri abstract compact strategi strategi cfs compact strategi abstract compact task task strategi user defin task sstabl befor task execut metric final cfs data tracker unmark compact sstabl els logger info tabl user defin compact alreadi compact final tabl reader releas refer sstabl final compact lock read lock unlock 