privat void cleanup compact column famili store cfs collect tabl reader sstabl node shot renew renew throw assert cfs index tabl tabl cfs tabl collect rang token rang storag servic instanc local rang tabl rang empti logger info cleanup run befor node join ring return boolean commut cfs metadata default valid commut collect byte buffer index column cfs index manag index column tabl reader sstabl sstabl index column empti bound token sstabl token sstabl token intersect rang cfs replac compact tabl array list sstabl collect tabl reader empti list oper type continu compact control control compact control cfs collect singleton list sstabl default befor cfs fals long start time system current time milli long totalkey written int expect bloom filter size math max databas descriptor index interv int tabl reader approxim key count array list sstabl logger debug enabl logger debug expect bloom filter size expect bloom filter size tabl writer writer null tabl reader sstabl null logger info clean sstabl calcul expect compact files long expect rang file size cfs expect compact file size array list sstabl oper type file compact file locat cfs directori directori tabl expect rang file size compact file locat null throw disk full tabl scanner scanner sstabl direct scanner long row read list column index column row null cleanup info cleanup info sstabl scanner executor compact tri scanner stop request throw compact interrupt compact info tabl ident iter row tabl ident iter scanner rang rang row key token rang abstract compact row compact row control compact row row compact row empti continu writer mayb creat writer cfs compact file locat expect bloom filter size writer collect singleton list sstabl writer append compact row totalkey written els cfs invalid cach row row key index column empti commut index column row null index column row clear row column column row column instanceof counter column renew mayb renew counter column column index column column index column row null index column row array list column index column row add column index column row null index column row empti acquir memtabl lock becaus secondari index delet caus race tabl switch lock read lock lock tri cfs index manag delet index row key index column row final tabl switch lock read lock unlock row read control throttl scanner current posit writer null sstabl writer close open reader sstabl max data age catch writer null writer abort throw util uncheck final scanner close executor finish compact list tabl reader result array list tabl reader sstabl null result add sstabl string format clean origin byte key time dms long time system current time milli start time long startsiz sstabl disk length long endsiz sstabl disk length doubl ratio doubl endsiz doubl startsiz logger info string format format writer filenam startsiz endsiz int ratio totalkey written time flush ensur don lose tombston restart sinc commitlog cfs index manag flush index block cfs replac compact tabl array list sstabl result oper type 