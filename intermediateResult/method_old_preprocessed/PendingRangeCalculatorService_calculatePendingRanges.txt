public static void calcul pend rang abstract replic strategi strategi string tabl token metadata storag servic instanc token metadata multimap rang token inet address pend rang hash multimap creat map token inet address bootstrap token bootstrap token set inet address leav endpoint leav endpoint bootstrap token empti leav endpoint empti move endpoint empti logger debug enabl logger debug bootstrap leav move node empti pend rang tabl set pend rang tabl pend rang return multimap inet address rang token address rang strategi address rang copi metadata reflect situat leav oper finish token metadata left metadata clone left rang affect leav node set rang token affect rang hash set rang token inet address endpoint leav endpoint affect rang add address rang endpoint rang find node respons rang leav node rang token rang affect rang set inet address current endpoint immut set copi strategi calcul natur endpoint rang set inet address endpoint immut set copi strategi calcul natur endpoint rang left metadata pend rang put rang set differ endpoint current endpoint stage pend rang updat accord leav oper continu calcul check bootstrap node bootstrap node simpli add remov left metadata check rang synchron bootstrap token bootstrap token link hash map token inet address bootstrap token map entri token inet address entri bootstrap token entri set inet address endpoint entri valu left metadata updat normal token entri key endpoint rang token rang strategi address rang left metadata endpoint pend rang put rang endpoint left metadata remov endpoint endpoint stage pend rang updat accord leav bootstrap node finish calcul check move node move node bootstrap simpli add remov left metadata check rang pair token inet address move move endpoint inet address endpoint move address move node move left token endpoint left metadata updat normal token move left endpoint rang token rang strategi address rang left metadata endpoint pend rang put rang endpoint left metadata remov endpoint endpoint set pend rang tabl pend rang logger debug enabl logger debug pend rang pend rang empti empti print pend rang 