public void recycl segment final file file check avoid recycl odd size empti segment version unit test cap exceed file length databas descriptor commit log segment size don decreas manag size sinc live segment tri logger debug unopen segment longer delet file file util delet confirm file catch throw error return logger debug recycl file wasn previous live segment add manag size live size add databas descriptor commit log segment size queue add runnabl public void run commit log segment segment commit log segment file path intern add readi segment segment 