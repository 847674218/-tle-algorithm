privat static extend ring posit set rang intersect wrap rang rang set rang intersect hash set rang compar left intersect add rang left partition intersect add rang left partition return collect unmodifi set intersect 