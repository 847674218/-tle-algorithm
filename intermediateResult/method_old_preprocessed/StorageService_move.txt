privat void move token token throw token null throw move undefin null token token metadata sort token token throw target token token alreadi anoth node address current node inet address local address util broadcast address list string tabl process schema instanc system tabl pend rang calcul servic instanc block finish check data move node string tabl tabl process token metadata pend rang tabl local address size throw unsupport oper data current move node unabl leav ring gossip instanc add local applic state applic state valu factori move token set mode mode string format move local address local token token true endpoint snitch snitch databas descriptor endpoint snitch map string multimap inet address rang token rang fetch hash map string multimap inet address rang token map string multimap rang token inet address rang stream tabl hash map string multimap rang token inet address token metadata token meta clone token metadata clone settl system tabl calcul rang current node handl move token string tabl tabl process replic strategi current keyspac aka tabl abstract replic strategi strategi tabl open tabl replic strategi collect current rang keyspac collect rang token current rang rang endpoint tabl local address collect rang node serv move token collect rang token updat rang strategi pend address rang token metadata token local address ring rang endpoint associ determin node ping rang data multimap rang token inet address rang address strategi rang address token metadata calcul part rang request stream node ring pair set rang token set rang token rang tabl calcul stream fetch rang current rang updat rang loop rang fetch determin node ring respons data interest multimap rang token inet address rang fetch prefer endpoint array list multimap creat rang token fetch rang tabl rang token rang rang address key set rang fetch list inet address endpoint snitch sort list proxim local address rang address rang store rang prefer endpoint set rang fetch prefer endpoint put fetch endpoint calcul endpoint stream current rang situat node handl current rang part rang multimap rang token inet address rang endpoint hash multimap creat rang token stream rang tabl left set inet address current endpoint immut set copi strategi calcul natur endpoint stream token metadata set inet address endpoint immut set copi strategi calcul natur endpoint stream token meta clone rang endpoint put stream set differ endpoint current endpoint associ tabl rang endpoint map rang stream tabl put tabl rang endpoint multimap inet address rang token work map rang streamer work map rang fetch prefer endpoint rang fetch put tabl work map logger debug enabl logger debug tabl work map tabl work map rang stream tabl empti rang fetch empti set mode mode string format sleep befor start stream fetch rang true tri thread sleep catch interrupt throw runtim sleep interrupt messag set mode mode fetch rang stream rang true logger debug enabl logger debug move work map rang stream tabl count latch stream latch stream rang rang stream tabl logger debug enabl logger debug move work map rang fetch count latch fetch latch request rang rang fetch tri stream latch await fetch latch await catch interrupt throw runtim interrupt latch wait stream fetch rang finish messag set token token set token everyth settl logger debug enabl logger debug success move token local token 