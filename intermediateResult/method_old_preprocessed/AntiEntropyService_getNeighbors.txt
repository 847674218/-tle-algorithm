static set inet address neighbor string tabl rang token repair storag servic storag servic instanc map rang token list inet address replica set rang address map tabl rang token rang super set null rang token rang local rang tabl rang repair rang super set rang break els rang intersect repair throw illeg argument request rang intersect local rang fulli lead imprecis repair rang super set null replica set key rang super set return collect empti set set inet address neighbor hash set inet address replica set rang super set neighbor remov util broadcast address exclud node version sinc don creat correct merkl tree build full rang iter inet address iter neighbor iter iter inet address endpoint iter gossip instanc version endpoint messag servic logger info exclud endpoint repair becaus version sooner consid updat node befor run repair iter remov return neighbor 