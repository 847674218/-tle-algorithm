privat static void send messag string local data center map string multimap messag inet address messag write respons handler handler throw map entri string multimap messag inet address entri messag entri set string data center entri key send messag correspond datacent map entri messag collect inet address messag entri valu map entri set messag messag messag key singl messag object unhint write clean ani previous loop iter messag messag header remov row mutat iter inet address iter messag valu iter inet address target iter direct write local cassadra version data center equal local data center gossip instanc version target messag servic loop loop code clunki avoid creat iter sinc alreadi perfect good messag servic instanc send messag target handler iter target iter messag servic instanc send messag target handler continu add destin messag entri fast byte array output stream bos fast byte array output stream data output stream dos data output stream bos dos write int messag valu size iter inet address destin iter compact endpoint serial helper serial destin dos string messag servic instanc add callback handler messag destin dos write logger debug enabl logger debug ad messag destin messag messag header ad row mutat bos byte array send combin messag header string messag servic instanc send messag target handler logger debug enabl logger debug send messag target 