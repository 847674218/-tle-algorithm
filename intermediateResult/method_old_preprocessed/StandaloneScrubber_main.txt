public static void main string arg throw option option option pars arg arg tri migrat sstabl pre correct locat directori sstabl migrat directori migrat tabl load keyspac descript databas descriptor load schema schema instanc meta data option tabl option null throw illeg argument string format unknown keyspac column famili option tabl option load sstabl sinc broken tabl tabl tabl open tabl option tabl column famili store cfs tabl column famili store option string snapshot pre scrub system current time milli output handler handler output handler system output option verbos option debug directori tabl lister lister cfs directori sstabl lister skip compact true skip temporari true list tabl reader sstabl array list tabl reader scrub sstabl map entri descriptor set compon entri lister list entri set set compon compon entri valu compon compon compon compon continu tri tabl reader sstabl tabl reader open valid entri key compon cfs metadata sstabl add sstabl file snapshot directori directori snapshot directori sstabl descriptor snapshot sstabl creat link snapshot directori path catch system err println string format error load entri key messag option debug print stack trace system err system println string format pre scrub sstabl snapshot snapshot snapshot level load manifest level manifest manifest null cfs directori tri level manifest null cfs directori snapshot level manifest snapshot system println string format level manifest snapshot snapshot snapshot int max size int cfs compact strategi max tabl size manifest level manifest creat cfs max size sstabl option manifest check onli tabl reader sstabl sstabl tri scrubber scrubber scrubber cfs sstabl handler true tri scrubber scrub final scrubber close manifest null scrubber order tabl null manifest add scrubber order tabl list tabl reader ad scrubber tabl null collect tabl reader empti list collect singleton list scrubber tabl manifest replac collect singleton list sstabl ad remov sstabl copi scrub snapshot sstabl mark compact sstabl releas refer catch system err println string format error scrub sstabl messag option debug print stack trace system err check repair manifest manifest null check manifest manifest tabl delet task wait delet system exit stop daemon thread catch system err println messag option debug print stack trace system err system exit 