privat void stream throw byte buffer header buffer messag servic instanc construct stream header header fals gossip instanc version write header compress compat messag output write byte buffer util array header buffer header file null return raw random access file sinc manag buffer random access reader file header file sstabl compress tri skip kernel page cach possibl compress random access reader open header file filenam header file sstabl compress metadata true random access reader open file header file filenam true set data compress stream compressedoutput output stream output messag servic instanc increment activ stream outbound tri stream requir section file pair long long section header file section seek section file seek section left length section stream long length section section left track write progress long byte transfer byte transfer length long write write file length byte transfer byte transfer write store stream progress header file progress write current section send compressedoutput flush logger debug enabl logger debug byte transfer byte transfer header file size receiv repli confirm receiv repli final messag servic instanc decrement activ stream outbound matter happen close file file util close quiet file 