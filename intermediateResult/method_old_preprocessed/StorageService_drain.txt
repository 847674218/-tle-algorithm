public synchron void drain throw interrupt execut executor servic mutat stage stage manag stage stage mutat stage termin logger warn drain node alreadi happen return set mode mode start drain process true stop server option task shutdown gossip instanc stop set mode mode shut messag servic fals messag servic instanc shutdown set mode mode wait stream fals messag servic instanc wait stream set mode mode clear mutat stage fals mutat stage shutdown mutat stage await termin time unit storag proxi instanc verifi hint progress set mode mode flush column famili fals list column famili store cfses array list column famili store string tabl schema instanc system tabl tabl tabl tabl open tabl cfses add tabl column famili store total remain cfses size column famili store cfs cfses cfs forc block flush remain column famili store post flush executor shutdown column famili store post flush executor await termin time unit commit log instanc shutdown block wait miscellan task sstabl commitlog segment delet task shutdown task await termin time unit logger warn miscellan task executor busi minut proceed shutdown set mode mode true 