privat static runnabl counter write task final mutat mutat final collect inet address target final write respons handler respons handler final string local data center final consist level consist level return droppabl runnabl storag servic verb public void run throw throw assert mutat instanceof counter mutat final counter mutat counter mutat mutat appli mutat appli respons handler respons null send replica ani target remov util broadcast address replic write target empti replic anoth stage becaus involv read replic mutat avoid block stage stage manag stage stage execut droppabl runnabl storag servic verb public void run throw throw timeout send mutat replica send hint endpoint replic mutat target respons handler local data center consist level 