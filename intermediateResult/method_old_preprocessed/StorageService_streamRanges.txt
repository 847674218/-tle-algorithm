privat count latch stream rang final map string multimap rang token inet address rang stream tabl final count latch latch count latch rang stream tabl key set size map entri string multimap rang token inet address entri rang stream tabl entri set multimap rang token inet address rang endpoint entri valu rang endpoint empti latch count continu final string tabl entri key final set map entri rang token inet address pend hash set map entri rang token inet address rang endpoint entri final map entri rang token inet address point entri rang endpoint entri final rang token rang point entri key final inet address endpoint point entri valu final stream callback callback stream callback public void success synchron pend pend remov point entri pend empti latch count public void failur logger warn stream point entri fail success call success latch countdown stage manag stage stage execut runnabl public void run call transfer rang flush potenti lot wast stream transfer rang endpoint tabl open tabl array list rang callback oper type return latch 