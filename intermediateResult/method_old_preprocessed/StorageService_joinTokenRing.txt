privat void join token ring int delay throw org apach cassandra config configur logger info start server gossip join true start gossip servic befor ani info node necessari bootstrap load info won part storag ring add node state gossip instanc regist gossip instanc regist migrat manag gossip instanc start system tabl increment generat node ring gather gossip schema empti version forc immedi check schema updat migrat manag mayb schedul schema pull schema instanc updat version announc ensur actual schema prepar updat add rpc listen info gossip instanc add local applic state applic state valu factori rpcaddress databas descriptor rpc address null databas descriptor replac token gossip instanc add local applic state applic state valu factori hibern true messag servic instanc listen util local address load broadcast instanc start broadcast gossip instanc add local applic state applic state valu factori releas version hint hand manag instanc start bootstrap haven success bootstrap befor long seed seed user manual set auto bootstrap fals skip stream data node jump direct ring seed check skip sleep singl node cluster case user test attempt replac schema presenc check meaning sleep schema info gossip defeat purpos gori detail token token inet address current null logger debug bootstrap variabl object databas descriptor auto bootstrap system tabl bootstrap progress system tabl bootstrap complet databas descriptor seed util broadcast address databas descriptor auto bootstrap system tabl bootstrap complet databas descriptor seed util broadcast address system tabl bootstrap progress logger warn detect previous bootstrap failur retri els system tabl set bootstrap state system tabl bootstrap state set mode mode wait ring inform true sleep delay peer int delay schema proceed check direct schema instanc version equal schema empti version logger debug schema schema instanc version break tri thread sleep catch interrupt throw assert error schema hasn match sleep doe post don expect necessari veri doesn hurt care migrat manag readi bootstrap set mode mode wait schema inform complet true tri thread sleep catch interrupt throw assert error set mode mode schema complet true set mode mode wait pend rang calcul true pend rang calcul servic instanc block finish set mode mode calcul complet readi bootstrap true logger debug enabl logger debug ring schema info databas descriptor replac token null token metadata member util broadcast address string node alreadi member token ring bootstrap abort replac dead node remov ring throw unsupport oper set mode mode bootstrap token true token boot strapper bootstrap token token metadata load broadcast instanc load info els tri sleep addit server actual aliv give time gossip aliv thread sleep load broadcast catch interrupt throw assert error token storag servic partition token factori string databas descriptor replac token check oper error current token metadata endpoint token null current gossip instanc endpoint state endpoint current updat timestamp system current time milli delay throw unsupport oper cannnot replac token live node set mode mode replac node token token true bootstrap token assert bootstrap mode bootstrap block finish els token system tabl save token token null string initi token databas descriptor initi token initi token null token partition random token logger warn generat random token token random token result unbalanc ring http wiki apach org cassandra oper els token partition token factori string initi token logger info save token token configur els logger info save token token survey mode start particip ring system tabl set bootstrap state system tabl bootstrap state set token token remov exist info replac node current null gossip instanc replac endpoint current logger info bootstrap replac move complet serv read assert token metadata sort token size els logger info bootstrap complet write survey mode activ becom activ ring member storag servic join ring final ring join 