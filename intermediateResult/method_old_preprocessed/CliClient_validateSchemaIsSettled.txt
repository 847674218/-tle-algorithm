privat void valid schema settl string current version session state println wait schema agreement map string list string version null long limit system current time milli session state schema mwt boolean agreement fals outer limit system current time milli agreement tri version thrift client describ schema version schema version node ring catch session state err println instanceof invalid request invalid request whi messag continu string version version key set version equal current version version equal storag proxi continu outer agreement true version key storag proxi session state err printf warn unreach node joiner join version storag proxi agreement session state err printf schema settl migrat ill advis doe version session state schema mwt util string version system exit session state println schema agre cluster 