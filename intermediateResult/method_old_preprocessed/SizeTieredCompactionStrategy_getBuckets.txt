static list list bucket collect pair long file long min tabl size sort list order determinist result dure group list pair long sort file array list pair long file collect sort sort file compar pair long public int compar pair long pair long return compar map long list bucket hash map long list outer pair long pair sort file long size pair bucket similar size file group bucket averag bucket file bucket consid small min tabl size entri long list entri bucket entri set list bucket entri valu long averag size entri key size averag size size averag size size min tabl size averag size min tabl size remov add averag size bucket remov averag size long total size bucket size averag size long averag size total size size bucket size bucket add pair left bucket put averag size bucket continu outer similar bucket put array list bucket array list bucket add pair left bucket put size bucket return array list list bucket valu 