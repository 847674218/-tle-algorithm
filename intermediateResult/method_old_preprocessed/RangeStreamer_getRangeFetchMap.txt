privat static multimap inet address rang token rang fetch map multimap rang token inet address rang sourc collect sourc filter sourc filter multimap inet address rang token rang fetch map map hash multimap creat rang token rang rang sourc key set boolean sourc fals outer inet address address rang sourc rang address equal util broadcast address localhost sourc don add map avoid stream local sourc true continu sourc filter filter sourc filter filter includ address continu outer rang fetch map map put address rang sourc true break ensur onli stream node rang sourc throw illeg state unabl find suffici sourc stream rang rang return rang fetch map map 