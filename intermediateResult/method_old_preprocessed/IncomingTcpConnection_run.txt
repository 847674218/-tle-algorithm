overrid public void run data input stream input boolean stream int version tri determin connect type decid buffer input data input stream socket input stream messag servic valid magic input read int int header input read int stream messag servic bit header version messag servic bit header logger debug version version stream version messag servic version int size input read int byte header byte byte size input read fulli header byte stream stream header serial deseri data input stream fast byte array input stream header byte version input els stream connect session fix version anyth wrong version stream connect drop logger error receiv stream protocol version version termin connect version messag servic version connect return buffer input data input stream buffer input stream socket input stream receiv messag set version receiv messag input version whi version messag servic version save endpoint gossip reconnect gossip instanc add save endpoint logger info receiv stream stream connect newer protocol version ignor return gossip instanc set version version logger debug set version version loop messag true prepar read messag messag servic valid magic input read int header input read int assert stream messag servic bit header connect chang type stream version messag servic bit header logger trace version version receiv messag input version catch logger trace eof read socket close connect reset throw catch logger debug error read socket close final close 