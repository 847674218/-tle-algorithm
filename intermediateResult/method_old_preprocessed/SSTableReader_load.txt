privat void load boolean recreatebloom set decor key key load cach throw boolean cach load key load cach empti cach load key cach null key cach cach servic instanc key cach segment file builder ibuild segment file builder databas descriptor index access mode segment file builder dbuilder compress segment file compress builder segment file builder databas descriptor disk access mode read posit don worri entri span mmap boundari random access reader input random access reader open file descriptor filenam compon true decor key left null null tri long index size input length long histogram count sstabl metadata estim row size count long estim key histogram count sstabl metadata estim row size overflow histogram count tabl estim row index input statist suppos option index summari index summari estim key recreatebloom legaci bloom filter filter estim key true long index posit input file pointer index posit index size break decor key decor key null int len byte buffer util read short length input boolean key left null boolean key index posit constant short size len constant long size index size boolean add entri index summari add entri add entri cach load recreatebloom key key decor key decod key partition descriptor byte buffer util read input len key left decor key key decor key els file util skip byte fulli input len long data posit input read long decor key null recreatebloom add decor key key add entri index summari add entri decor key index posit key cach key alreadi pre load cach load key load cach decor key cach key decor key data posit index summari increment rowid ibuild add potenti boundari index posit dbuilder add potenti boundari data posit index summari complet final file util close quiet input minim key left minim key final state reader ifil ibuild complet descriptor filenam compon dfile dbuilder complet descriptor filenam compon 