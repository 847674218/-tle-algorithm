public list inet address calcul natur endpoint token token token metadata metadata int replica replic factor list inet address endpoint array list inet address replica array list token token metadata sort token token empti return endpoint iter token iter token metadata ring iter token token fals token primari token iter endpoint add metadata endpoint primari token boolean data center fals boolean rack fals endpoint size replica iter tri find differ data center token iter snitch datacent metadata endpoint primari token equal snitch datacent metadata endpoint alreadi someth diff datacent find anoth data center endpoint add metadata endpoint data center true continu tri find differ rack snitch rack metadata endpoint primari token equal snitch rack metadata endpoint snitch datacent metadata endpoint primari token equal snitch datacent metadata endpoint alreadi someth diff rack find anoth rack endpoint add metadata endpoint rack true number node good loop wil exit otherwis loop list add node endpoint size replica iter token metadata ring iter token token fals endpoint size replica iter token iter endpoint metadata endpoint endpoint add metadata endpoint return endpoint 