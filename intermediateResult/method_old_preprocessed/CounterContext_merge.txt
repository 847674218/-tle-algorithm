public byte buffer merg byte buffer left byte buffer alloc alloc context state left state context state left header length left context state state context state header length comput size result int merg header length int merg bodi length left state remain state remain int cmp left state compar state cmp merg bodi length left state delta state delta merg header length left state move state move els cmp merg bodi length state delta merg header length state move els cmp merg bodi length left state delta merg header length left state move merg header length left state remain header length state remain header length merg bodi length left state remain bodi length state remain bodi length actual merg byte buffer merg alloc alloc merg header length merg bodi length merg put short merg posit short merg header length context state merg state context state merg merg header length left state reset state reset left state remain state remain int cmp left state compar state cmp left state delta state delta local delta left state delta state delta delta sum long clock left state clock state clock long count left state count state count merg state write element left state node clock count true els onli delta left state delta left state state copi merg state els long left clock left state clock long clock state clock left clock clock delta shard clock differ count howev heal problem determinist select shard log occurr oper someth wrong long left count left state count long count state count left count count compact manag compact manag logger warn invalid counter shard detect differ onli count pick highest heal compact object left state node left clock left count state node clock count left count count left state copi merg state els state copi merg state els left clock clock left clock clock left clock clock left clock clock left state copi merg state els state copi merg state state move left state move els cmp state copi merg state state move els cmp left state copi merg state left state move left state remain left state copi merg state left state move state remain state copi merg state state move return merg 