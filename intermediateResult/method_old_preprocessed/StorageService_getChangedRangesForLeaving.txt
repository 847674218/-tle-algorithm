privat multimap rang token inet address chang rang leav string tabl inet address endpoint rang leav endpoint respons collect rang token rang rang endpoint tabl endpoint logger debug enabl logger debug node endpoint rang string util join rang map rang token list inet address current replica endpoint hash map rang token list inet address find rang node store replica rang rang token rang rang current replica endpoint put rang tabl open tabl replic strategi calcul natur endpoint rang token metadata token metadata temp token metadata clone left endpoint leav leav removetoken command present temp remov temp member endpoint temp remov endpoint endpoint multimap rang token inet address chang rang hash multimap creat rang rang check store replica rang leav endpoint present replica endpoint list current replica endpoint list rang rang token rang rang collect inet address replica endpoint tabl open tabl replic strategi calcul natur endpoint rang temp replica endpoint remov current replica endpoint rang logger debug enabl replica endpoint empti logger debug rang rang alreadi replica els logger debug rang rang respons string util join replica endpoint chang rang put rang replica endpoint return chang rang 