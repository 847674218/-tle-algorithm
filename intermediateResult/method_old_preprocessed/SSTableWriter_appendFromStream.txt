public long append stream decor key key meta data metadata long data size data input throw long current posit befor append key byte buffer util write short length key key data file stream long data start data file file pointer write row size data file stream write long data size write int size read int data file stream write int size int size data file stream write byte read byte write index int index size read int data file stream write int index size int index size data file stream write byte read byte data data file stream write int read int data file stream write long read long column size int column count read int data file stream write int column count deseri column obtain max timestamp immedi serial long max timestamp long column famili column famili creat metadata array sort column factori int column count deseri column becaus written data size base data size receiv reseri exact data column column column serial deseri column serial flag integ column instanceof counter column column counter column column mark delta clear els column instanceof super column super column super column column column column column column instanceof counter column column mark counter column column mark delta clear replac column mark max timestamp math max max timestamp column max timestamp column serial serial column data file stream assert data size data file file pointer data start incorrect row data size data size written data file path correct data file file pointer data start sstabl metadata collector updat max timestamp max timestamp sstabl metadata collector add row size data file file pointer current posit sstabl metadata collector add column count column count append key current posit return current posit 