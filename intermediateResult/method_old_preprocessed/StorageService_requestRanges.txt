privat count latch request rang final map string multimap inet address rang token rang final count latch latch count latch rang key set size map entri string multimap inet address rang token entri rang entri set multimap inet address rang token endpoint rang entri valu endpoint rang empti latch count continu final string tabl entri key final set inet address pend hash set inet address endpoint rang key set send messag respect folk stream data final inet address sourc endpoint rang key set collect rang token fetch endpoint rang sourc final stream callback callback stream callback public void success pend remov sourc pend empti latch count public void failur logger warn stream sourc fail success call success latch countdown logger debug enabl logger debug request sourc rang string util join fetch send actual request stream request rang sourc tabl fetch callback oper type return latch 