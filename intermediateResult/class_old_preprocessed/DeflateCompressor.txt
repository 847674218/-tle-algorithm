licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra compress import java import java util collect import java util map import java util set import java util zip data format import java util zip deflat import java util zip inflat public class deflat compressor implement compressor public static final deflat compressor instanc deflat compressor privat final thread local deflat deflat privat final thread local inflat inflat public static deflat compressor creat map string string compress option specif option support return instanc privat deflat compressor deflat thread local deflat overrid protect deflat initi valu return deflat inflat thread local inflat overrid protect inflat initi valu return inflat public set string support option return collect empti set public int initi compress buffer length int chunk length return chunk length public int compress byte input int input offset int input length compressor wrap array output int output offset throw deflat def deflat def reset def set input input input offset input length def finish def input return int output offset true def deflat output buffer output buffer length def finish return output offset els output small increas continu byte buffer byte output buffer length system arraycopi output buffer buffer output buffer buffer public int uncompress byte input int input offset int input length byte output int output offset throw inflat inf inflat inf reset inf set input input input offset input length inf input return assum output big tri return inf inflat output output offset output length output offset catch data format throw 