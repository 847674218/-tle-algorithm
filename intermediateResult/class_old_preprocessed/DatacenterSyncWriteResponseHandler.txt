packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java net inet address import java util collect import java util hash map import java util map import java util concurr atom atom integ import org apach cassandra config databas descriptor import org apach cassandra tabl import org apach cassandra gms failur detector import org apach cassandra locat endpoint snitch import org apach cassandra locat network topolog strategi import org apach cassandra net messag import org apach cassandra thrift consist level import org apach cassandra thrift unavail import org apach cassandra util util class block quorum respons datacent public class datacent sync write respons handler extend abstract write respons handler privat static final endpoint snitch snitch databas descriptor endpoint snitch privat static final string localdc static localdc snitch datacent util broadcast address privat final network topolog strategi strategi privat hash map string atom integ respons hash map string atom integ protect datacent sync write respons handler collect inet address write endpoint consist level consist level string tabl runnabl callback respons manag map superclass super write endpoint consist level callback assert consist level consist level strategi network topolog strategi tabl open tabl replic strategi string strategi datacent int strategi replic factor respons put atom integ public static write respons handler creat collect inet address write endpoint consist level consist level string tabl runnabl callback return datacent sync write respons handler write endpoint consist level tabl callback public void respons messag messag string data center messag null localdc snitch datacent messag respons data center decrement atom integ respons valu return quorum condit met signal public void assur suffici live node throw unavail map string atom integ endpoint hash map string atom integ string strategi datacent endpoint put atom integ inet address destin write endpoint failur detector instanc aliv destin figur destin string destin snitch datacent destin endpoint destin increment throw ani doesn livenod accept write string strategi datacent endpoint respons throw unavail public boolean latenc snitch return fals 