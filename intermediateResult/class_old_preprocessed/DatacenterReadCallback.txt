packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java net inet address import java util collect import java util compar import java util list import org apach cassandra read respons import org apach cassandra tabl import org apach cassandra locat network topolog strategi import org apach cassandra net messag import org apach cassandra thrift consist level import org apach cassandra thrift unavail datacent quorum respons handler block quorum respons local public class datacent read callback extend read callback privat static final compar inet address local compar compar inet address public int compar inet address endpoint inet address endpoint boolean local localdc equal snitch datacent endpoint boolean local localdc equal snitch datacent endpoint local local return local local return return public datacent read callback respons resolv resolv consist level consist level read command command list inet address endpoint super resolv consist level command endpoint overrid protect void sort consist level list inet address endpoint collect sort endpoint local compar overrid protect boolean wait messag messag return localdc equal snitch datacent messag overrid protect boolean wait read respons respons cheat leverag knowledg local read onli read respons version method call return true overrid public int determin block consist level consist level string tabl network topolog strategi stategi network topolog strategi tabl open tabl replic strategi return stategi replic factor localdc overrid public void assur suffici live node throw unavail int local endpoint inet address endpoint endpoint localdc equal snitch datacent endpoint local endpoint local endpoint blockfor logger debug enabl string builder builder string builder local replica inet address endpoint endpoint localdc equal snitch datacent endpoint builder append endpoint append builder append insuffici satisfi requir append blockfor append live node append localdc append logger debug builder string throw unavail 