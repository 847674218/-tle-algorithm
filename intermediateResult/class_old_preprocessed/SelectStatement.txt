licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import java import java nio byte buffer import java util import java util concurr timeout import googl common collect abstract iter import org slf logger import org slf logger factori import org apach cassandra auth permiss import org apach cassandra cql import org apach cassandra config meta data import org apach cassandra import org apach cassandra context counter context import org apach cassandra filter queri path import org apach cassandra marshal abstract type import org apach cassandra marshal composit type import org apach cassandra marshal int type import org apach cassandra marshal long type import org apach cassandra marshal revers type import org apach cassandra marshal type parser import org apach cassandra dht import org apach cassandra servic client state import org apach cassandra servic storag proxi import org apach cassandra servic storag servic import org apach cassandra thrift column import org apach cassandra thrift consist level import org apach cassandra thrift cql metadata import org apach cassandra thrift cql result import org apach cassandra thrift cql result type import org apach cassandra thrift cql row import org apach cassandra thrift index express import org apach cassandra thrift index oper import org apach cassandra thrift invalid request import org apach cassandra thrift request type import org apach cassandra thrift slice predic import org apach cassandra thrift slice rang import org apach cassandra thrift thrift valid import org apach cassandra thrift time import org apach cassandra thrift unavail import org apach cassandra util byte buffer util import org apach cassandra util pair encapsul complet pars queri includ target column famili express result count order claus public class select statement implement statement privat static final logger logger logger factori logger select statement class privat final static byte buffer count column byte buffer util byte count privat final int bound term public final definit def public final paramet paramet privat final list pair definit selector select array list pair definit selector empti wildcard privat restrict key restrict privat final restrict column restrict privat final map definit restrict metadata restrict hash map definit restrict privat restrict slice restrict privat boolean revers privat static enum bound public final int idx bound int idx idx idx public static bound revers bound return public select statement definit def int bound term paramet paramet def def bound term bound term column restrict restrict def column size paramet paramet public int bound term return bound term public void check access client state state throw invalid request state column famili access keyspac column famili permiss public void valid client state state throw invalid request noth valid raw statement prepar public cql result execut client state state list byte buffer variabl throw invalid request unavail time list row row key rang row multi rang slice variabl els row slice variabl cql result result cql result result type cql result type count process result group column togeth spars column famili cql metadata schema creat schema list cql row cql row process row schema variabl count resultset singl column count paramet count result schema cql metadata collect byte buffer string empti map collect byte buffer string empti map ascii type long type list column column collect singleton list column count column set valu byte buffer util byte long cql row size result row collect singleton list cql row count column column return result els otherwis creat resultset queri result result schema schema result row cql row return result public list cql row process list row row throw invalid request assert paramet count return process row creat schema collect byte buffer empti list public static string short type abstract type type type instanceof revers type type revers type type base type return type parser short type privat cql metadata creat schema return cql metadata hash map byte buffer string hash map byte buffer string short type def cfm compar short type def cfm default valid public string keyspac return def cfm public string column famili return def cfm privat list row slice list byte buffer variabl throw invalid request time unavail queri path queri path queri path column famili collect byte buffer key key variabl list read command command array list read command key size rang slice column column rang byte buffer start request bound bound variabl byte buffer finish request bound bound variabl note total limit everi key potenti ineffici veri sensibl choic byte buffer key key queri processor valid key key queri processor valid slice rang def cfm start finish revers command add slice read command keyspac key queri path start finish revers limit list column els collect byte buffer column request column variabl queri processor valid column column byte buffer key key queri processor valid key key command add slice read command keyspac key queri path column tri return storag proxi read command paramet consist level catch timeout throw time catch throw runtim privat list row multi rang slice list byte buffer variabl throw invalid request time unavail list row row thrift struct intern sad slice predic thrift slice predic slice predic variabl queri processor valid slice predic def cfm thrift slice predic list index express express index express variabl tri row storag proxi rang slice rang slice command keyspac column famili null thrift slice predic key bound variabl express limit true limit column key fals paramet consist level catch throw runtim catch timeout throw time return row privat abstract bound row posit key bound list byte buffer variabl throw invalid request partition storag servic partition abstract bound row posit bound key restrict null key restrict token token start token token bound bound variabl token token token bound bound variabl row posit start includ key bound bound start token min key bound start token max key bound row posit includ key bound bound token max key bound token min key bound bound rang row posit start els byte buffer start key byte key bound bound variabl byte buffer finish key byte key bound bound variabl row posit start key row posit key start key byte row posit finish key row posit key finish key byte start key compar finish key finish key minimum instanceof random partition throw invalid request start key sort key probabl specifi key random partition els throw invalid request start key sort befor equal finish key partition includ key bound bound bound includ key bound bound bound row posit start key finish key includ exclud bound row posit start key finish key els bound includ key bound bound rang row posit start key finish key exclud bound row posit start key finish key return bound privat slice predic slice predic list byte buffer variabl throw invalid request slice predic thrift slice predic slice predic column rang slice rang slice rang slice rang slice rang start request bound bound variabl slice rang finish request bound bound variabl slice rang revers revers slice rang count rang slice count ignor favor global column count thrift slice predic slice rang slice rang els thrift slice predic column request column variabl return thrift slice predic privat int limit intern don support exclus bound slice queri element necessari exclud int limit slice restrict null slice restrict inclus bound paramet limit paramet limit spars merg defin colum cql row queri defin column limit column trim queri return def compact limit def metadata size limit privat boolean key rang index column token rang alway rang slice metadata restrict empti return true return key restrict null key restrict equal key restrict token privat collect byte buffer key final list byte buffer variabl throw invalid request assert key restrict null key restrict equal list byte buffer key array list byte buffer key restrict valu size term key restrict valu key add byte buffer def key type variabl return key privat byte buffer key bound bound list byte buffer variabl throw invalid request key restrict null return byte buffer util els key restrict equal assert key restrict valu size return key restrict valu byte buffer def key type variabl els term bound key restrict bound return bound null byte buffer util bound byte buffer def key type variabl privat token token bound bound list byte buffer variabl partition throw invalid request assert key restrict null key restrict equal assert key restrict valu size return key restrict valu token def key type variabl els term bound key restrict bound return bound null minimum token bound token def key type variabl privat boolean includ key bound bound key restrict null key restrict equal return true els return key restrict inclus privat boolean column rang static entail column slice def compact def composit return fals otherwis rang queri column alia relat defin restrict column restrict null equal return true return fals privat boolean wildcard return select empti privat list byte buffer request column list byte buffer variabl throw invalid request assert column rang column builder builder def column builder restrict column restrict assert null equal valu size onli support column creat column return list byte buffer column array list byte buffer valu size iter term iter valu iter iter term iter column builder iter builder copi builder byte buffer cname add relat type variabl build column add cname return column els builder add valu relat type variabl def compact return collect singleton list builder build els add column user select column queri column row exist note queri select request null onli queri list byte buffer column array list byte buffer def column size iter column identifi iter def metadata key set iter iter column identifi iter column builder iter builder copi builder byte buffer cname add key build column add cname return column privat byte buffer request bound bound bound list byte buffer variabl throw invalid request assert column rang compon composit doesn depend compon type revers revers type appli compon compar compon onli depend slice revers bound eoc bound revers bound revers bound bound column builder builder def column builder definit def column valu restrict alway bound bound base compar revers slice invers bound give start slice filter actual compar revers invers bound bound revers revers type bound bound revers bound restrict column restrict posit null equal bound null wasn ani relat key select record preced compon prefix composit preced compon comput chang compon compon otherwis select onli record builder compon count eoc bound bound return builder build rang els return builder build equal assert valu size builder add valu relat type variabl els term bound assert null return builder add relat eoc bound variabl build relat everyth equal return builder build privat list index express index express list byte buffer variabl throw invalid request metadata restrict empti return collect index express empti list list index express express array list index express map entri definit restrict entri metadata restrict entri set definit entri key restrict restrict entri valu restrict equal term restrict valu byte buffer valu byte buffer type variabl express add index express key index oper valu els bound bound valu restrict bound null byte buffer valu restrict bound byte buffer type variabl express add index express key restrict index oper valu return express privat list pair definit selector expand select select empti list pair definit selector select array list pair definit selector definit def select add pair definit selector creat return select els return select privat byte buffer valu column return instanceof counter column byte buffer util byte counter context instanc total valu valu privat column return column selector column column cql col function cql col column byte buffer util byte string null mark delet return cql col switch function case cql col set valu byte buffer util byte timestamp break case instanceof expir column int ttl expir column local delet time int system current time milli cql col set valu byte buffer util byte ttl break els cql col column key null mark delet return cql col cql col set valu valu set timestamp timestamp return cql col privat void add schema cql metadata schema pair definit selector function byte buffer request byte buffer util byte string schema type put request short type def definit type switch function case schema valu type put request short type long type instanc break case schema valu type put request short type int type instanc break els byte buffer request key schema type put request short type def compar result set left schema valu type put request short type left type privat iter column column order final column famili final list byte buffer variabl throw invalid request restrict column alia respect request order restrict column restrict column restrict length null equal return sort column column builder builder def column builder int column restrict length builder add column restrict valu relat type variabl final list byte buffer request array list byte buffer valu size iter term iter valu iter iter term iter column builder iter builder copi builder request add add relat type variabl build return iter column public iter column iter return abstract iter column iter byte buffer iter request iter public column comput iter return data column column column iter return column null comput column privat list cql row process list row row cql metadata schema list byte buffer variabl throw invalid request list cql row cql row array list cql row list pair definit selector select expand select list column thrift column null add schema onli onc pair definit selector select add schema schema org apach cassandra row row row column match queri skip row null continu def compact cql row column column column order row variabl mark delet continu thrift column array list column select size byte buffer compon null def composit compon composit type def cfm compar split els slice restrict null dynam column request bound filter slice restrict inclus bound equal slice restrict bound bound byte buffer def cfm compar variabl continu slice restrict inclus bound equal slice restrict bound bound byte buffer def cfm compar variabl continu respect select order pair definit selector select definit left selector selector add schema schema column col switch kind case col column selector key col set valu row key key set timestamp break case col column selector key col set timestamp timestamp def composit posit compon length col set valu compon posit els col set valu byte buffer util els col set valu break case col return column selector break case happen compact throw assert error default throw assert error thrift column add col cql row add cql row row key key thrift column els def composit spars case group column cql row composit prefix equal composit type composit composit type def cfm compar int composit type size byte buffer previous null map byte buffer column group hash map byte buffer column column row mark delet continu byte buffer current composit split current differ previous finish group previous null row previous current cql row add handl group select row key key previous group schema group hash map byte buffer column accumul current column group put current previous current handl group previous null cql row add handl group select row key key previous group schema els row live column count continu static case cql row column thrift column array list column select size respect select order pair definit selector select definit left selector selector kind definit kind thrift column add column selector key set valu row key key set timestamp continu column row column key thrift column add return column selector cql row add cql row row key key thrift column order result select cql row intern call alway return column compar order revers set revers collect revers cql row trim result respect limit cql row cql row size paramet limit cql row list paramet limit cql row return cql row order result multipl key select privat void order result list pair definit selector select list cql row cql row noth result order inform key restrict wasn express cql row empti paramet order empti key restrict null key restrict valu size return optim onli order condit becaus point composit compar onli order condit paramet order size definit order def paramet order key set iter collect sort cql row singl column compar column posit select select order order type return build composit type multi column comparison compar order compon pass collect posit inform built composit compar composit compar actual comparison row list abstract type type array list abstract type paramet order size int posit int paramet order size int idx column identifi identifi paramet order key set definit order column def identifi type add order column type posit idx column posit select select order column collect sort cql row composit compar type posit determin posit column select claus privat int column posit select list pair definit selector select definit column int select size select left equal column return throw illeg argument string format column wasn select claus column spars composit return wheter column belong cql row base full list compon column belong togeth differ onli compon privat static boolean row byte buffer byte buffer cql don insert column doesn compon composit set spars composit someon thrift hit sinc handl correct fail whomev hit someon chang definit dens composit assert length length spars composit partial column int length equal return fals return true privat cql row handl group list pair definit selector select byte buffer key byte buffer compon map byte buffer column column cql metadata schema list column thrift column array list column select size respect request order pair definit selector select definit left selector selector column col switch kind case col column selector key col set valu key set timestamp break case col column selector key col set valu compon posit col set timestamp break case happen throw assert error case column column key col return column selector break default throw assert error thrift column add col return cql row key thrift column privat static boolean revers type definit return type instanceof revers type public static class raw statement extend statement privat final paramet paramet privat final list selector select claus privat final list relat claus public raw statement paramet paramet list selector select claus list relat claus super paramet paramet select claus select claus claus claus null collect relat empti list claus public pars statement prepar prepar throw invalid request meta data cfm thrift valid valid column famili keyspac column famili thrift valid valid consist level keyspac paramet consist level request type paramet limit throw invalid request strict posit definit def cfm def select statement stmt select statement def bound term paramet definit definit bound term select claus paramet count select claus empti throw invalid request onli oper current support els selector select claus definit def null throw invalid request string format undefin select claus function kind definit kind kind definit kind throw invalid request string format function part function stmt select add pair creat claus entiti rule relat conflict anyth els includ relat resp relat relat restrict row key conflic anyth els entiti doesn veri valu alia restrict ani don support wide row index valu relat rel claus definit def rel entiti null throw invalid request string format undefin claus rel entiti rel rel oper relat type term valu rel valu valu bind marker valu bind index els term valu rel valu valu bind marker valu bind index switch kind case rel oper relat type rel oper relat type rel token storag servic partition preserv order throw invalid request onli relat support compon random partition token function stmt key restrict updat restrict stmt key restrict rel break case stmt column restrict posit updat restrict stmt column restrict posit rel break case throw invalid request string format restrict valu compact support case stmt metadata restrict put updat restrict stmt metadata restrict rel break boolean key relat stmt key restrict null stmt key restrict equal stmt key restrict valu size point select statement fulli construct valid compon restrict relat preced compon follow restrict boolean fals definit previous null iter definit iter def column valu iter int stmt column restrict length definit cname iter restrict restrict stmt column restrict restrict null true els throw invalid request string format part restrict preced part restrict relat cname previous els restrict equal true composit slice don support intern differ exclus inclus bound deal manual def composit restrict inclus bound restrict inclus bound stmt slice restrict restrict onli support els restrict valu size stmt column restrict length throw invalid request string format part restrict relat onli part cname previous cname deal index column stmt metadata restrict empti boolean fals set byte buffer index tabl open keyspac column famili store column famili index manag index column map entri definit restrict entri stmt metadata restrict entri set restrict restrict entri valu restrict equal continu don support index valu basic requir support form restrict valu size throw invalid request oper column part index entri key key true break throw invalid request index column present column claus equal oper index column key claus rang queri relat don handl stmt key restrict null stmt key restrict equal stmt key restrict valu size throw invalid request select index column claus support stmt paramet order empti stmt metadata restrict empti throw invalid request ndari index support stmt key rang throw invalid request onli support partit key restrict order queri manual sort post queri current sort requir queri column sort updat add column sort queri automat remov result set afterward key relat stmt select empti empti wildcard column identifi column stmt paramet order key set definit def column boolean column fals pair definit selector select pair stmt select select pair left equal column true break column throw invalid request column select claus boolean revers map boolean def column size int map entri column identifi boolean entri stmt paramet order entri set column identifi column entri key boolean revers entri valu definit def column null throw invalid request string format order unknown column column kind definit kind throw invalid request string format order current onli support cluster column column posit throw invalid request string format order current onli support order column follow declar order revers map posit revers revers type check boolean revers map set agre boolean revers null boolean revers map column order specifi ani order null continu revers null revers continu revers throw invalid request string format unsupport order relat assert revers null stmt revers revers queri token necessari rang queri key token reject queri don stmt key restrict null stmt key restrict token stmt key restrict equal stmt key restrict valu size throw invalid request select token function don support claus return pars statement prepar stmt array definit list restrict updat restrict definit restrict restrict relat rel throw invalid request rel token kind definit kind throw invalid request string format token function onli support partit key switch rel oper case restrict null throw invalid request string format restrict relat includ equal restrict restrict rel valu rel token break case restrict null throw invalid request string format restrict reation includ restrict restrict rel valu break case case case case restrict null restrict restrict rel token restrict set bound rel oper rel valu break return restrict overrid public string string return string format select raw statement select claus claus count level limit select claus claus paramet count paramet consist level paramet limit raw class simplifi valid queri select don public easili bad privat static class restrict equal list term valu null restrict bound bound privat final term bound privat final boolean bound inclus final boolean token restrict list term valu valu valu bound null bound inclus null token fals restrict term valu boolean token collect singleton list valu restrict boolean token valu null bound term bound inclus boolean token token boolean equal return valu null public void set bound bound term bound idx public void set inclus bound bound inclus idx true public term bound bound return bound idx public boolean inclus bound return bound idx null bound inclus idx public relat type relat bound eoc bound bound inclus bound switch eoc bound case return bound inclus inclus bound idx relat type relat type case return bound inclus inclus bound idx relat type relat type throw assert error public index oper index oper bound switch case return bound inclus idx index oper index oper case return bound inclus idx index oper index oper throw assert error public void set bound column identifi relat type type term throw invalid request bound null boolean inclus fals switch type case bound inclus fals break case bound inclus true break case bound inclus fals break case bound inclus true break bound null throw invalid request string format restrict equal inequ relat bound idx null throw invalid request string format invalid restrict bound idx bound inclus idx inclus overrid public string string string valu null string format bound inclus bound bound inclus bound els string format valu return token public static class paramet privat final int limit privat final consist level consist level privat final map column identifi boolean order privat final boolean count public paramet consist level consist int limit map column identifi boolean order boolean count consist level consist limit limit order order count count order result method singl condit privat static class singl column compar implement compar cql row privat final int index privat final abstract type compar public singl column compar int column index abstract type order index column index compar order public int compar cql row cql row column column column index column column column index return compar compar column buffer valu column buffer valu order result method multipl condit privat static class composit compar implement compar cql row privat final list abstract type order type privat final int posit privat composit compar list abstract type order type int posit order type order type posit posit public int compar cql row cql row int posit length abstract type type order type int column pos posit byte buffer valu column column pos buffer valu byte buffer valu column column pos buffer valu int comparison type compar valu valu comparison return comparison return 