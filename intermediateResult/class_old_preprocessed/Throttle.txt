licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import org slf logger import org slf logger factori encapsul time state requir throttl caller target throughput byte millisecond period pass absolut count byte public class throttl privat static logger logger logger factori logger throttl class privat final string privat final throughput function fun byte handl time delay throttl time millisecond throttl privat long byte delay privat long time delay current target byte throughput millisecond privat int target byte public throttl string throughput function fun fun fun param current byte byte throughput sinc task public void throttl long current byte throttl delta current byte byte delay param byte delta byte throughput sinc call throttl public void throttl delta long byte delta int target byte fun target throughput target byte throttl disabl return target byte target byte restart throttl base target avoid bogus answer base compar rate throttl desir rate rate higher doesn matter rate result long sleep bring averag logger debug target throughput byte target byte target byte target byte byte delay byte delta time delay system current time milli return time pass sinc delay long sinc system current time milli time delay excess byte period long excess byte byte delta sinc target byte time delay recap deficit long time delay excess byte math max target byte time delay logger trace enabl logger trace string format actual throughput byte throttl byte delta sinc time delay tri thread sleep time delay catch interrupt throw assert error byte delay byte delta time delay system current time milli overrid public string string return throttl public interfac throughput function return instantan target throughput byte millisecond target equal disabl throttl public int target throughput 