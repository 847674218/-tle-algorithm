licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cli import java buffer reader import java file import java file reader import java import java nio charset charact code import java util import jline consol reader import jline histori import org apach cassandra auth authent import org apach cassandra thrift import org apach thrift import org apach thrift protocol binari protocol import org apach thrift transport frame transport import org apach thrift transport socket import org apach thrift transport transport cassandra command line interfac main public class cli main public final static string cassandra histori privat static transport transport null privat static cassandra client thrift client null public static cli session state session state cli session state privat static cli client cli client privat static cli complet complet cli complet privat static int line number establish thrift connect cassandra instanc param server hostnam server param port thrift port number public static void connect string server int port socket socket socket server port transport null transport close session state frame transport frame transport socket els transport socket binari protocol binari protocol binari protocol transport true true cassandra client cassandra client cassandra client binari protocol tri transport open catch print stack trace session state err string error caus null messag caus messag throw runtim connect server port reason error thrift client cassandra client cli client cli client session state thrift client session state usernam null session state password null authent map string string credenti hash map string string credenti put authent session state usernam credenti put authent session state password authent request auth request authent request credenti tri thrift client login auth request cli client set usernam session state usernam catch authent thrift client null session state err println dure authent cassandra node verifi keyspac exist correct credenti return catch author thrift client null session state err println author keyspac session state keyspac return catch thrift client null session state err println login failur specifi keyspac usernam password return session state keyspac null tri session state keyspac cli compil key space session state keyspac thrift client describ keyspac thrift client set keyspac session state keyspac cli client set key space session state keyspac updat completor cli util key space cli client meta data session state keyspac catch invalid request session state err println keyspac session state keyspac return catch session state err println specifi keyspac return catch session state err println keyspac session state keyspac return lookup cluster clear cluster user connect string cluster tri cluster thrift client describ cluster catch session state err println retriev inform cassandra node check connect thrift port print stack trace session state err return session state printf connect cluster server port disconnect thrift connect cassandra instanc public static void disconnect transport null transport close transport null check thrift client connect return boolean true connect fals otherwis public static boolean connect thrift client null session state println connect cassandra instanc return fals return true public static void updat completor set string candid set string action hash set string string candid string cmd complet keyspac command action add string format cmd string strs array copi action array action array length string class complet set candid string strs public static void process statement string queri throw charact code class time schema disagr invalid request field unavail illeg access instanti cli client execut statement queri public static void process statement interact string queri tri cli client execut statement queri catch string error templat session state file mode line line number throwabl caus null caus string messag instanceof invalid request invalid request whi messag session state err println error templat messag instanceof runtim print stack trace session state err session state batch session state file mode system exit final line number public static void main string arg throw process command line argument cli option cli option cli option cli option process arg session state arg connect cassandra server host argument specifi session state host null tri connect session state host session state thrift port catch runtim session state err println messag cli client null connect paramet invalid present user connect explicit connect statement cli client cli client session state null load statement file process session state file mode file reader file reader tri file reader file reader session state filenam catch session state err println messag return evalu file statement buffer reader file reader return consol reader reader consol reader session state batch reader add completor complet reader set bell enabl fals string histori file system properti user home file separ tri histori histori histori file histori file reader set histori histori catch exp session state err printf unabl open write histori file els session state verbos batch mode verbos flag session state close cli client print banner string prompt string line string current statement boolean compound statement fals line null prompt compound statement prompt cli client tri line reader read line prompt catch retri line null return line line trim skip empti comment line line empti line start continu current statement line line line equal process statement interact current statement current statement compound statement fals els current statement readi line compound statement true privat static void evalu file statement buffer reader reader throw string line string current statement boolean comment block fals line reader read line null line line trim skip empti comment line line empti line start continu line start comment block true line start line comment block fals continu comment block skip comment line continu current statement line line process statement interact current statement current statement els current statement readi line return prompt current connect param client current connect client return string prompt usernam keyspac ani privat static string prompt cli client client return client usernam client key space 