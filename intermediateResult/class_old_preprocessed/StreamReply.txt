packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import org apach cassandra version serial import org apach cassandra util fast byte array output stream import org apach cassandra net messag import org apach cassandra net messag produc import org apach cassandra servic storag servic import org apach cassandra util util class stream repli implement messag produc static enum status public static final version serial stream repli serial file status serial public final long session public final string file public final status action public stream repli string file long session status action file file action action session session public messag messag integ version throw fast byte array output stream bos fast byte array output stream data output stream dos data output stream bos serial serial dos version return messag util broadcast address storag servic verb bos byte array version overrid public string string return stream repli session session file file action action privat static class file status serial implement version serial stream repli public void serial stream repli repli data output dos int version throw dos write long repli session dos write repli file dos write int repli action ordin public stream repli deseri data input dis int version throw long session dis read long string target file dis read status action status valu dis read int return stream repli target file session action public long serial size stream repli stream repli int version throw unsupport oper 