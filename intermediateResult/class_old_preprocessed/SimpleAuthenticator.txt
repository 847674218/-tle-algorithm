packag org apach cassandra auth licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java buffer input stream import java file input stream import java import java input stream import java secur messag digest import java util map import java util properti import org apach cassandra config configur import org apach cassandra util file util import org apach cassandra thrift authent import org apach cassandra util util import org apach cassandra util hex public class simpl authent implement authent public final static string passwd properti public final static string passwd mode public static final string usernam public static final string password public enum password mode public authent user default user user log return null public authent user authent map extend char sequenc extend char sequenc credenti throw authent string pmode plain system properti password mode mode password mode null pmode plain tri mode password mode valu pmode plain catch worth string buffer string mode valu password mode password mode valu mode valu mode valu leav unspecifi throw authent request password check mode pmode plain valid mode possibl valu mode valu string pfilenam system properti string usernam null char sequenc user credenti null user throw authent authent request requir key els usernam user string string password null char sequenc pass credenti null pass throw authent authent request requir key els password pass string boolean authent fals input stream null tri buffer input stream file input stream pfilenam properti prop properti prop load note messag wrong password exact prevent attack guess user valid null prop properti usernam throw authent authent error messag mode usernam switch mode case authent password equal prop properti usernam break case authent messag digest equal util thread local digest digest password byte hex hex byte prop properti usernam break default throw runtim unknown password mode mode catch throw runtim authent tabl file properti open messag catch throw runtim unexpect authent problem final file util close quiet authent throw authent authent error messag mode usernam return authent user usernam public void valid configur throw configur string pfilenam system properti simpl authent pfilenam null throw configur class canon simpl authent properti defin static string authent error messag password mode mode string usernam return string format password password mode valid user mode usernam 