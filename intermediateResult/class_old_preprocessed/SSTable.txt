licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java file import java import java util import googl common collect order import googl common collect set import org apach cassandra decor key import org slf logger import org slf logger factori import org apach cassandra config meta data import org apach cassandra dht partition import org apach cassandra util file util import org apach cassandra util random access reader import org apach cassandra util byte buffer util import org apach cassandra util heap alloc import org apach cassandra util pair class built top sequenc file store data disk sort fashion howev sort upto applic class expect key hand sort order separ index file maintain tabl key offset tabl everi index interv key read memori tabl open final bloom filter file key tabl public abstract class tabl static final logger logger logger factori logger tabl class replac compon object public static final string compon type repr public static final string compon type repr public static final string compon type repr public static final string compon type repr public static final string compon type repr public static final string tmp public static final compar tabl reader max timestamp compar compar tabl reader public int compar tabl reader tabl reader long max timestamp long max timestamp return public final descriptor descriptor protect final set compon compon public final meta data metadata public final partition partition public final boolean compress public decor key public decor key protect tabl descriptor descriptor meta data metadata partition partition descriptor hash set compon metadata partition protect tabl descriptor descriptor set compon compon meta data metadata partition partition case metadata shouldn null null creat function tabl full schema definit tabl loader abil assert descriptor null assert compon null assert partition null descriptor descriptor set compon data compon hash set compon compon compon compon compon assert compon type compon type compress data compon compon compon collect unmodifi set data compon metadata metadata partition partition public static final compar tabl reader sstabl compar compar tabl reader public int compar tabl reader tabl reader return compar public static final order tabl reader sstabl order order sstabl compar refer queue manag delet file compact tabl refer exist guarante run file becaus semant write marker compact filenam file compact marker exist startup file remov method remov tabl mark temporari return true file delet public static boolean delet descriptor desc set compon compon throw remov compon exist compon compon file util delet confirm desc filenam compon compon compon compon compon equal compon compon equal compon continu file util delet confirm desc filenam compon remov compon exist note newli creat sstabl marker don leav older marker file util delet desc filenam compon logger debug delet desc return true param key occupi onli part larger buffer alloc buffer onli larg necessari public static decor key minim key decor key key return key key posit key key remain decor key key token heap alloc instanc clone key key key public string filenam return descriptor filenam public string column famili return descriptor cfname public string tabl return descriptor ksname return descriptor compon pair null valid sstabl compon public static pair descriptor compon tri compon filenam file dir string tri return compon filenam dir catch snapshot equal backup equal json logger warn invalid file data directori dir return null discov exist compon descriptor slow onli intend outsid critic path static set compon compon final descriptor desc set compon compon set hash set expect size compon size compon type compon type compon compon compon compon compon type file desc filenam compon exist compon add compon return compon return estim number key index file static long estim row index random access reader ifil throw collect size key megabyt data final int int math min ifil length int key ifil file pointer key byte buffer util skip short length ifil file util skip byte fulli ifil key assert key ifil file pointer ifil length unexpect empti index file ifil long estim row ifil length ifil file pointer key ifil seek return estim row public static long total byte iter tabl reader sstabl long sum tabl reader sstabl sstabl sum sstabl disk length return sum public long byte disk long byte compon compon compon byte file descriptor filenam compon length return byte overrid public string string return class simpl path filenam 