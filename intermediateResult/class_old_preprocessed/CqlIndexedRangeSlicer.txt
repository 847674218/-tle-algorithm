packag org apach cassandra stress oper licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util collect import java util list import org apach cassandra column famili type import org apach cassandra stress session import org apach cassandra stress util cassandra client import org apach cassandra stress util oper import org apach cassandra thrift compress import org apach cassandra thrift cql result import org apach cassandra thrift cql row import org apach cassandra util byte buffer util public class cql index rang slicer extend oper privat static list byte buffer valu null privat static string cql queri null public cql index rang slicer session client int idx super client idx public void run cassandra client client throw session column famili type column famili type super throw runtim super column implement valu null valu generat valu cql queri null string builder queri string builder append session column key append standard append session consist level append append quot cql blob valu array append append session key call cql queri queri string string format session total key length string start offset string format format int expect valu session num key valu size receiv receiv expect valu long start system current time milli boolean success fals string messag null cql result result null string format queri null list string queri parm collect singleton list quot cql blob start offset int session retri time success break tri session prepar statement integ stmnt prepar statement client cql queri result client execut prepar cql queri stmnt queri param byte buffer queri parm els format queri null format queri format cql queri cql queri queri parm result client execut cql queri byte buffer wrap format queri byte compress success result row size catch messag messag success fals success error string format oper retri time error execut index rang queri offset index session retri time start offset messag null messag receiv result row size convert max key integ increment start offset string format format max key result row session oper increment session key add result row size session latenc add system current time milli start maximum key cql row list param row list cql row object return maximum key valu list privat int max key list cql row row int max key byte buffer util int row key cql row row row int current key byte buffer util int row key current key max key max key current key return max key 