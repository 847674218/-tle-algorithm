packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util array list import java util list import org apach cassandra version serial import org apach cassandra sstabl descriptor import org apach cassandra sstabl tabl reader import org apach cassandra net messag servic import org apach cassandra util pair repres portion file stream node public class pend file privat static pend file serial serial pend file serial public static pend file serial serial return serial refer abl releas acquir refer complet public final tabl reader sstabl public final descriptor desc public final string compon public final list pair long long section public final oper type type public final long size public final long estim key public long progress public pend file descriptor desc pend file null desc compon section type estim key public pend file tabl reader sstabl descriptor desc string compon list pair long long section oper type type sstabl desc compon section type public pend file tabl reader sstabl descriptor desc string compon list pair long long section oper type type long estim key sstabl sstabl desc desc compon compon section section type type long temp size pair long long section section temp size section section left size temp size estim key estim key public string filenam return desc filenam compon public boolean equal object instanceof pend file return fals pend file rhs pend file return filenam equal rhs filenam public int hash code return filenam hash code public string string return filenam section section size progress progress size progress size public static class pend file serial implement version serial pend file public void serial pend file data output dos int version throw null dos write return dos write desc filenam compon dos write compon dos write int section size pair long long section section dos write long section left dos write long section version messag servic dos write type version messag servic dos write long estim key public pend file deseri data input dis int version throw string filenam dis read filenam empti return null descriptor desc descriptor filenam filenam string compon dis read int count dis read int list pair long long section array list pair long long count int count section add pair long long long valu dis read long long valu dis read long control index rebuilt stream oper type type oper type version messag servic type oper type valu dis read long estim key version messag servic estim key dis read long return pend file null desc compon section type estim key public long serial size pend file pend file int version throw unsupport oper 