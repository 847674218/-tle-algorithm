packag org apach cassandra util licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java file import java util concurr time unit import org slf logger import org slf logger factori import org apach cassandra servic storag servic public class resourc watcher public static void watch string resourc runnabl callback int period storag servic schedul task schedul fix delay watch resourc resourc callback period period time unit public static class watch resourc implement runnabl privat static logger logger logger factori logger watch resourc class privat string resourc privat runnabl callback privat long load public watch resourc string resourc runnabl callback resourc resourc callback callback load public void run tri string filenam util resourc file resourc long modifi file filenam modifi modifi load callback run load modifi catch throwabl logger error string format time run fail callback class 