licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra dht import java math big decim import java math big integ import java nio byte buffer import java nio charset charact code import java util import org apach cassandra config configur import org apach cassandra decor key import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util guid generat import org apach cassandra util pair class generat big integ token hash public class random partition extend abstract partition big integ token public static final big integ big integ public static final big integ token big integ token public static final big integ big integ pow privat static final byte byte public decor key big integ token decor key byte buffer key return decor key big integ token token key key public decor key big integ token convert disk format byte buffer fromdisk find delimit posit int split point int fromdisk posit fromdisk limit fromdisk split point break assert split point decod token key string token null tri token byte buffer util string fromdisk fromdisk posit split point fromdisk posit catch charact code throw runtim byte buffer key fromdisk duplic key posit split point return decor key big integ token big integ token token key public token midpoint token ltoken token rtoken symbol token act empti bit array big integ left ltoken equal big integ token ltoken token big integ rtoken equal big integ token rtoken token pair big integ boolean midpair util midpoint left discard remaind return big integ token midpair left public big integ token minimum token return public big integ token random token big integ token util hash big integ guid generat guid byte token signum token token multipli big integ valu return big integ token token privat final token token factori big integ token factori token token factori big integ public byte buffer byte array token big integ big integ token return byte buffer wrap big integ token token byte array public token big integ byte array byte buffer byte return big integ token big integ byte buffer util array byte public string string token big integ big integ token return big integ token token string public void valid string token throw configur tri big integ big integ token compar throw configur token compar throw configur token catch number format throw configur messag public token big integ string string string return big integ token big integ string public token token factori big integ token factori return token factori public boolean preserv order return fals public big integ token token byte buffer key key remain return return big integ token util hash big integ key public map token float describ ownership list token sort token map token float ownership hash map token float iter sort token iter case throw runtim node present cluster node finish start case sort token size ownership put token float case els divis place big decim modulo oper place big integ final big integ addit final big decim big decim entir rang token start token big integ big integ token start token token valu token big integ tim token valu loop token big integ token token token valu float big decim subtract tim add mod divid float valu age ownership put save age tim advanc loop start token rang extend token whi save abov float big decim big integ token start token subtract add mod divid float valu ownership put start return ownership 