licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stress import org apach common cli option import java import java net socket import java net socket import java util random public final class stress public static enum oper public static session session public static random random random privat static volatil boolean stop fals public static void main string argument throw tri session session argument catch illeg argument print messag return print stream stream session output stream session send daemon null socket socket socket session send daemon object output stream object output stream socket output stream buffer reader inp buffer reader input stream reader socket input stream runtim runtim add shutdown hook shut socket write object session string line tri socket close line inp read line null line equal line equal write int break stream println line catch socket stop print stack trace close inp close socket close els stress action stress action stress action session stream stress action start stress action join system exit stress action return code print messag public static void print messag system println usag bin cassandra stress option option object session avail option option option option option string upper case option long opt upper case system println string format option opt option arg upper case option long opt option arg upper case option descript privat static class shut extend thread privat final socket socket privat final object output stream public shut socket socket object output stream socket socket public void run tri socket close system println control caught cancel run action shut write int close stop true catch print stack trace 