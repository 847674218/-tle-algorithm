packag org apach cassandra columniter licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java error import java import java nio byte buffer import java util import org apach cassandra column famili serial import org slf logger import org slf logger factori import org apach cassandra config meta data import org apach cassandra config databas descriptor import org apach cassandra column famili import org apach cassandra decor key import org apach cassandra column import org apach cassandra marshal abstract type import org apach cassandra sstabl index helper import org apach cassandra sstabl tabl reader import org apach cassandra util file data input import org apach cassandra util file mark import org apach cassandra util file util import org apach cassandra util byte buffer util import org apach cassandra util filter public class tabl iter extend simpl abstract column iter implement tabl column iter privat static logger logger logger factori logger tabl iter class privat column famili privat iter column iter public final sort set byte buffer column public final decor key key privat final tabl reader sstabl public tabl iter tabl reader sstabl decor key key sort set byte buffer column sstabl sstabl assert column null column column key key file data input file sstabl file data input key file null return tri decor key key disk tabl reader decod key sstabl partition sstabl descriptor byte buffer util read short length file assert key disk equal key string format key disk key file path tabl reader read row size file sstabl descriptor read sstabl file catch sstabl mark suspect throw error final file util close quiet file public tabl iter tabl reader sstabl file data input file decor key key sort set byte buffer column sstabl sstabl assert column null column column key key tri read sstabl file catch ioe sstabl mark suspect throw error ioe public tabl reader stabl return sstabl privat void read tabl reader sstabl file data input file throw filter index helper defreez bloom filter file sstabl descriptor bloom filter list index helper index info index list index helper deseri index file stop earli bloom filter column actual exist stop befor initi abov case relev tombston column famili serial serial column famili serial tri serial deseri tabl column column famili creat sstabl metadata file catch throw serial fail deseri sstabl column famili sstabl metadata file list byte buffer filter column array list byte buffer column size byte buffer column present filter column add filter column empti return index list null read simpl column file column filter column els read index column sstabl metadata file column filter column index list creat iter view column read iter iter privat void read simpl column file data input file sort set byte buffer column list byte buffer filter column throw int column file read int int int column column column column serial deseri file column column add column column filter column size break privat void read index column meta data metadata file data input file sort set byte buffer column list byte buffer filter column list index helper index info index list throw file read int column count column rang read abstract type compar metadata compar sort set index helper index info rang tree set index helper index info index helper compar compar fals byte buffer filter column int index index helper index index list compar fals index index list size continu index helper index info index info index list index compar compar index info continu rang add index info file mark mark file mark index helper index info index info rang file reset mark file util skip byte fulli file index info offset onli complet deseri column interest file byte mark mark index info offset index info width column column column serial deseri file check origin set filter list effici column column add column column public decor key key return key public column famili column famili return protect column comput iter null iter return data return iter 