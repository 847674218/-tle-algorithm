packag org apach cassandra commitlog licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java data input import java data output import java import java util compar import googl common base function import googl common collect iter import googl common collect order import org apach cassandra serial import org apach cassandra sstabl tabl reader public class replay posit implement compar replay posit public static final replay posit serial serial replay posit serial tabl stream node relationship local commitlog valu satisfi critera real commitlog segment sort befor ani real replayposit effect ignor replay posit public static final replay posit replay posit conveni method comput replay posit group tabl param sstabl return highest replay posit public static replay posit replay posit iter extend tabl reader sstabl iter empti sstabl return function tabl reader replay posit function tabl reader replay posit public replay posit appli tabl reader sstabl return sstabl replay posit order replay posit order order replay posit compar return order max iter transform sstabl public final long segment public final int posit public static final compar replay posit compar compar replay posit public int compar replay posit replay posit segment segment return long valu segment compar segment return integ valu posit compar posit public replay posit long segment int posit segment segment assert posit posit posit public int compar replay posit return compar compar overrid public boolean equal object return true null class class return fals replay posit replay posit posit posit return fals return segment segment overrid public int hash code int result int segment segment result result posit return result overrid public string string return replay posit segment segment posit posit public static class replay posit serial implement serial replay posit public void serial replay posit data output dos throw dos write long segment dos write int posit public replay posit deseri data input dis throw return replay posit dis read long dis read int public long serial size replay posit object throw unsupport oper 