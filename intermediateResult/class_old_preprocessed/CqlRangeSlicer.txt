packag org apach cassandra stress oper licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util collect import org apach cassandra util byte buffer util import org apach cassandra column famili type import org apach cassandra stress session import org apach cassandra stress util cassandra client import org apach cassandra stress util oper import org apach cassandra thrift compress import org apach cassandra thrift cql result public class cql rang slicer extend oper privat static string cql queri null public cql rang slicer session client int idx super client idx public void run cassandra client client throw session column famili type column famili type super throw runtim super column implement cql queri null string builder queri string builder append session column key append standard append session consist level string append cql queri queri string string key string format session total key length index string format queri null long start time system current time milli boolean success fals string messag null int row count int session retri time success break tri cql result result null session prepar statement integ stmnt prepar statement client cql queri result client execut prepar cql queri stmnt collect singleton list byte buffer util byte quot cql blob key els format queri null format queri format cql queri cql queri collect singleton list quot cql blob key result client execut cql queri byte buffer wrap format queri byte compress row count result row size success row count catch system err println messag messag success fals success error string format oper retri time error execut rang slice offset index session retri time key messag null messag session oper increment session key add row count session latenc add system current time milli start time 