licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra locat import org apach cassandra config configur import org apach cassandra gms applic state import org apach cassandra gms endpoint state import org apach cassandra gms gossip import org apach cassandra util file util import org apach cassandra servic storag servic import org slf logger import org slf logger factori import java input stream import java net inet address import java util map import java util properti public class gossip properti file snitch extend abstract network topolog snitch privat static final logger logger logger factori logger gossip properti file snitch class privat properti file snitch psnitch privat string privat string rack public gossip properti file snitch throw configur snitch properti null rack snitch properti rack null null rack null throw configur rack snitch properti plz check configur snitch properti tri psnitch properti file snitch logger info load properti file snitch compat catch configur logger info unabl load properti file snitch compat mode disabl return data center endpoint resid param endpoint endpoint process return string data center public string datacent inet address endpoint endpoint state state gossip instanc endpoint state endpoint endpoint state null state applic state applic state null psnitch null throw runtim retriev endpoint gossip compat disabl els return psnitch datacent endpoint return state applic state applic state valu return rack endpoint resid param endpoint endpoint process return string rack public string rack inet address endpoint endpoint state state gossip instanc endpoint state endpoint endpoint state null state applic state applic state null psnitch null throw runtim retriev rack endpoint gossip compat disabl els return psnitch rack endpoint return state applic state applic state valu overrid public void gossip start share info gossip logger info ad applic state rack rack gossip instanc add local applic state applic state storag servic instanc valu factori datacent gossip instanc add local applic state applic state storag servic instanc valu factori rack rack 