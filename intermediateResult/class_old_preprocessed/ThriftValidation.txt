packag org apach cassandra thrift licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java nio byte buffer import java util import org slf logger import org slf logger factori import org apach cassandra config import org apach cassandra import org apach cassandra marshal abstract type import org apach cassandra marshal marshal import org apach cassandra dht partition import org apach cassandra dht random partition import org apach cassandra dht token import org apach cassandra locat import org apach cassandra servic storag servic import org apach cassandra util byte buffer util import org apach cassandra util util lot build block cassandra server call valid input ensur column conform declar compar instanc method tri part valid combin differ supercolumn regular rang slice batch singl column valid column path main includ tabl valid public class thrift valid privat static logger logger logger factori logger thrift valid class public static void valid key meta data metadata byte buffer key throw invalid request key null key remain throw invalid request key empti check key handl util write short byte array key remain util throw invalid request key length key remain longer maximum util tri metadata key valid valid key catch marshal throw invalid request messag public static void valid tabl string tablenam throw keyspac defin schema instanc tabl tablenam throw keyspac defin keyspac tablenam doe exist don check tabl exist valid tabl valid column famili call public static void valid consist level string tabl consist level request type request type throw invalid request switch case request type request type throw invalid request consist level onli support write break case requir network topolog strategi tabl break case requir network topolog strategi tabl request type request type throw invalid request consist level onli support write break privat static void requir network topolog strategi string tabl consist level throw invalid request abstract replic strategi strategi tabl open tabl replic strategi strategi instanceof network topolog strategi throw invalid request string format consist level compat replic strategi strategi class public static meta data valid column famili string tablenam string boolean commut throw invalid request meta data metadata valid column famili tablenam commut metadata default valid commut throw invalid request invalid oper commut columnfamili els metadata default valid commut throw invalid request invalid oper commut columnfamili return metadata oper author counter public static meta data valid column famili string tablenam string throw invalid request valid tabl tablenam empti throw invalid request empti columnfamili requir meta data metadata schema instanc meta data tablenam metadata null throw invalid request unconfigur columnfamili return metadata valid part path column includ column public static void valid column path meta data metadata column path column path throw invalid request metadata type column famili type standard column path super column null throw invalid request supercolumn paramet invalid standard metadata column path column null throw invalid request column paramet option standard metadata els column path super column null throw invalid request supercolumn paramet option super metadata column path column null valid column metadata column path super column array list column path column column path super column null valid column metadata byte buffer null array list column path super column public static void valid column parent meta data metadata column parent column parent throw invalid request metadata type column famili type standard column parent super column null throw invalid request columnfamili alon requir standard metadata column parent super column null valid column metadata byte buffer null array list column parent super column column path parent column path remov column option standard static void valid column path parent meta data metadata column path column path parent throw invalid request metadata type column famili type standard column path parent super column null throw invalid request supercolumn specifi standard metadata metadata type column famili type super column path parent super column null column path parent column null throw invalid request column specifi specifi super column remov super metadata column path parent column null valid column metadata column path parent super column array list column path parent column column path parent super column null valid column metadata byte buffer null array list column path parent super column valid column parent path data privat static void valid column meta data metadata byte buffer super column iter byte buffer column throw invalid request super column null super column remain column throw invalid request supercolumn length greater column super column remain throw invalid request supercolumn empti metadata type column famili type standard throw invalid request supercolumn specifi column famili metadata normal column abstract type compar metadata compar super column byte buffer column remain column throw invalid request column length greater column remain throw invalid request column empti tri compar valid catch marshal throw invalid request messag public static void valid column meta data metadata column parent column parent iter byte buffer column throw invalid request valid column metadata column parent super column column public static void valid rang meta data metadata column parent column parent slice rang rang throw invalid request abstract type compar metadata compar column parent super column tri compar valid rang start compar valid rang finish catch marshal throw invalid request messag rang count throw invalid request slice requir negat count compar byte buffer order compar rang revers compar revers compar compar rang start remain rang finish remain order compar compar rang start rang finish throw invalid request rang finish start order travers public static void valid column super column meta data metadata column super column cosc throw invalid request boolean commut metadata default valid commut int null cosc column null null cosc super column null null cosc counter column null null cosc counter super column null null null throw invalid request column super column onli column super column counter counter super column cosc column null commut throw invalid request invalid oper commut columnfamili metadata valid ttl cosc column valid column path metadata column path metadata set super column byte buffer null set column cosc column valid column data metadata cosc column fals cosc super column null commut throw invalid request invalid oper commut columnfamili metadata column cosc super column column valid column path metadata column path metadata set super column cosc super column set column valid column data metadata true cosc counter column null commut throw invalid request invalid oper commut columnfamili metadata valid column path metadata column path metadata set super column byte buffer null set column cosc counter column cosc counter super column null commut throw invalid request invalid oper commut columnfamili metadata counter column cosc counter super column column valid column path metadata column path metadata set super column cosc counter super column set column privat static void valid ttl column column throw invalid request column set ttl column ttl throw invalid request ttl posit column ttl expir column throw invalid request string format ttl larg request maximum column ttl expir column els set check thrift doesn chang contract assert column ttl public static void valid mutat meta data metadata mutat mut throw invalid request column super column cosc mut column supercolumn delet del mut delet int null cosc null null del null null null throw invalid request mutat onli column supercolumn delet cosc null valid column super column metadata cosc els valid delet metadata del public static void valid delet meta data metadata delet del throw invalid request del super column null valid column metadata byte buffer null array list del super column del predic null valid slice predic metadata del super column del predic del predic slice rang null throw invalid request delet doe support slice rang predic metadata type column famili type standard del super column null string msg string format delet super column possibl standard column famili key space column famili delet metadata metadata del throw invalid request msg metadata default valid commut forc server timestamp timestamp set coher counter oper del timestamp system current time milli els del set timestamp throw invalid request delet timestamp option commut column famili metadata public static void valid slice predic meta data metadata byte buffer slice predic predic throw invalid request predic column null predic slice rang null throw invalid request slice predic list column slice rang predic slice rang null valid rang metadata column parent metadata set super column predic slice rang predic column null valid column metadata predic column valid data part column everyth column object assum valid public static void valid column data meta data metadata column column boolean column throw invalid request valid ttl column column set valu throw invalid request column valu requir column set timestamp throw invalid request column timestamp requir column definit column def metadata column definit column tri abstract type valid metadata valu valid column def valid null valid valid column valu catch marshal logger debug enabl logger debug reject invalid valu byte buffer util byte hex summar column valu throw invalid request string format fail valid messag metadata metadata column metadata subcolumn compar metadata compar string column index column valu larger detail tabl open metadata column famili store metadata index manag valid column throw invalid request string format index column valu size index column valu remain column def index metadata metadata return buffer avoid veri larg column valu log entireti privat static byte buffer summar byte buffer buffer int short buffer remain return buffer return byte buffer buffer slice limit buffer posit public static void valid predic meta data metadata column parent column parent slice predic predic throw invalid request predic column null predic slice rang null throw invalid request predic column slice rang null predic column null predic slice rang null throw invalid request predic column slice rang present predic slice rang null valid rang metadata column parent predic slice rang els valid column metadata column parent predic column public static void valid key rang meta data metadata byte buffer super column key rang rang throw invalid request rang start key null rang start token null rang key null rang token null throw invalid request exact start key start token key token specifi key token support wide row token key rang start token null rang key null throw invalid request start token key support key rang partition storag servic partition rang start key null rang key null token start token token rang start key token token token rang key start token compar token token minimum preserv order throw invalid request start key sort befor equal finish key partition els throw invalid request start key sort key probabl specifi key random partition els rang start key null rang token null start token token wrap key token row posit stop token factori string rang token max key bound row posit key rang start key compar stop stop minimum throw invalid request start key token sort token valid filter claus metadata rang row filter empti rang row filter super column null throw invalid request super column support index rang count throw invalid request max row posit privat static boolean empti list index express claus return claus null claus empti public static void valid index claus meta data metadata index claus index claus throw invalid request index claus express empti throw invalid request index claus list empti valid filter claus metadata index claus express throw invalid request index column present index claus oper return true index claus index column oper public static boolean valid filter claus meta data metadata list index express index claus throw invalid request empti index claus filter appli return fals set byte buffer index column tabl open metadata column famili store metadata index manag index column abstract type valid column famili compar metadata metadata null boolean index fals index express express index claus tri valid valid express column catch marshal throw invalid request string format fail valid byte buffer util byte hex express column byte buffer util byte hex express valu messag abstract type valu valid schema instanc valu valid metadata metadata express column tri valu valid valid express valu catch marshal throw invalid request string format fail valu valid byte buffer util byte hex express column byte buffer util byte hex express valu messag index express index oper index column express column return index public static void valid commut write meta data metadata consist level consist throw invalid request consist consist level throw invalid request consist level support counter columnfamili metadata els metadata replic write consist consist level throw invalid request achiev replic write columnfamili metadata public static void valid keyspac exist string throw invalid request keyspac uniqu case insensit becaus keyspac becom directori store sstabl differ onli case caus problem case insensit filesystem instal string schema instanc tabl equal ignor case throw invalid request string format keyspac case insensit uniqu conflict public static void valid keyspac system string modifi keyspac throw invalid request modifi keyspac equal ignor case tabl throw invalid request system keyspac user modifi 