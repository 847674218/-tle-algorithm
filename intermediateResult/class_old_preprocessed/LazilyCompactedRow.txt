packag org apach cassandra compact licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java data output import java error import java import java secur messag digest import java util iter import java util list import googl common base predic import googl common collect iter import org slf logger import org slf logger factori import org apach cassandra import org apach cassandra columniter column iter import org apach cassandra columniter countabl column iter import org apach cassandra marshal abstract type import org apach cassandra util data output buffer import org apach cassandra util iter column import org apach cassandra util merg iter lazili compact row onli comput row bloom filter column index memori construct time doe read column time row compact merg doe memori time bloom filter index column pre compact row write updat call pass pre compact row write merg column updat hash column row deseri time public class lazili compact row extend abstract compact row implement iter column privat static logger logger logger factori logger lazili compact row class privat final list extend countabl column iter row privat final compact control control privat final boolean purg privat final data output buffer header buffer privat column famili empti column famili privat reduc reduc privat int column count privat long max timestamp privat long column serial size privat boolean close public lazili compact row compact control control list extend countabl column iter row super row key row row control control purg control purg key column iter row row column famili row column famili empti column famili null empti column famili els empti column famili delet initi row header empti call header buffer data output buffer column index serial header buffer reach reduc dure iter column count size max column timestamp howev column iter call column index reduc null column count reduc null reduc size column serial size reduc null reduc serial size long row tombston empti column famili mark delet max timestamp reduc null row tombston math max row tombston reduc max timestamp reduc null public long write data output throw assert close data output buffer clock data output buffer column famili serial serial info empti column famili clock long data size header buffer length clock length column serial size logger debug enabl logger debug string format header clock column size header buffer length clock length column serial size assert data size write long data size write header buffer data header buffer length write clock data clock length write int column count iter column iter iter iter column column iter empti column famili column serial serial column long pass column size reduc null reduc serial size assert pass column size column serial size origin calcul column size column serial size pass column size close return data size public void updat messag digest digest assert close special case row size actual skip byte blind updat everyth wouldn correct data output buffer data output buffer tri column famili serial serial info empti column famili write int column count digest updat data length catch throw error iter column iter iter iter iter updat digest digest close public boolean empti boolean irrelev purg column famili store remov delet empti column famili control befor null empti column famili mark delet tombston relev return irrelev column count public int estim column count int countabl column iter row row row column count return public abstract type compar return empti column famili compar public iter column iter countabl column iter row row row reset reduc reduc iter column iter merg iter row compar column compar reduc return iter filter iter predic null public int column count return column count public long max timestamp return max timestamp public void close column iter row row tri row close catch throw error close true privat class reduc extend merg iter reduc column column column famili empti column famili clone shallow long serial size int column count int size long max timestamp long public void reduc column current add column current protect column reduc column famili purg precompact row remov delet shard key purg control purg null purg iter clear return null column reduc purg iter clear serial size reduc serial size size max timestamp math max max timestamp reduc max timestamp return reduc 