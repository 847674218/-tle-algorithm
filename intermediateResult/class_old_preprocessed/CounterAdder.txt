licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stress oper import org apach cassandra stress session import org apach cassandra stress util cassandra client import org apach cassandra stress util oper import org apach cassandra column famili type import org apach cassandra thrift import org apach cassandra util byte buffer util import java import java nio byte buffer import java util array list import java util hash map import java util list import java util map public class counter adder extend oper public counter adder session client int index super client index public void run cassandra client client throw list counter column column array list counter column list counter super column super column array list counter super column format key string format session total key length int session column key string column integ string column add counter column byte buffer util byte column session column famili type column famili type super super super column str column xrang super key int session super column string super column integ string super column add counter super column byte buffer wrap super column byte column string raw key string format format index map byte buffer map string list mutat record hash map byte buffer map string list mutat record put byte buffer util byte raw key session column famili type column famili type super super column mutat map super column column mutat map column long start system current time milli boolean success fals string messag null int session retri time success break tri client batch mutat record session consist level success true catch messag messag success fals success error string format oper retri time error increment key index session retri time raw key messag null messag session oper increment session key increment session latenc add system current time milli start privat map string list mutat super column mutat map list counter super column super column list mutat mutat array list mutat map string list mutat mutat map hash map string list mutat counter super column super column column super column cosc column super column set counter super column mutat add mutat set column supercolumn cosc mutat map put super counter mutat return mutat map privat map string list mutat column mutat map list counter column column list mutat mutat array list mutat map string list mutat mutat map hash map string list mutat counter column column column super column cosc column super column set counter column mutat add mutat set column supercolumn cosc mutat map put counter mutat return mutat map 