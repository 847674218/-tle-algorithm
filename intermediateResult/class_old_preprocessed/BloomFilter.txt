licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java nio byte buffer import org slf logger import org slf logger factori import org apach cassandra util ob open bit set public class bloom filter extend filter privat static final logger logger logger factori logger bloom filter class privat static final int static bloom filter serial serial bloom filter serial public open bit set bitset bloom filter int hash open bit set hash count hash bitset public static bloom filter empti filter return bloom filter bucket public static bloom filter serial serial return serial privat static open bit set bucket long num element int bucket return open bit set num element bucket return bloom filter lowest practic fals posit probabl number element public static bloom filter filter long num element int target bucket elem int max bucket element math max bloom calcul max bucket element num element int bucket element math min target bucket elem max bucket element bucket element target bucket elem logger warn string format provid optim bloom filter element bucket element num element bucket element target bucket elem bloom calcul bloom specif spec bloom calcul comput bloom spec bucket element logger trace enabl logger trace creat bloom filter element spec num element spec return bloom filter spec bucket num element spec bucket element return smallest bloom filter provid fals posit probabl rate number element assert probabl satisfi filter public static bloom filter filter long num element doubl max fals pos probabl assert max fals pos probabl invalid probabl int bucket element bloom calcul max bucket element num element bloom calcul bloom specif spec bloom calcul comput bloom spec bucket element max fals pos probabl return bloom filter spec bucket num element spec bucket element privat long hash bucket byte buffer key return bloom filter hash bucket key hash count bitset size murmur faster base approach provid good collis resist combinatori generat approach describ http www eec harvard kirsch pub bbbf esa pdf doe prove work actual test obvious faster perform iter murmur static long hash bucket byte buffer int hash count long max long result long hash count long hash murmur hash hash posit remain long hash murmur hash hash posit remain hash int hash count result math ab hash long hash max return result public void add byte buffer key long bucket index hash bucket key bitset set bucket index public boolean present byte buffer key long bucket index hash bucket key bitset bucket index return fals return true public void clear bitset clear bitset size public long serial size return serial serial size 