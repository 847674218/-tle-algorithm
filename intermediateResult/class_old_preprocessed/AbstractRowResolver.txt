packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java data input stream import java error import java import java nio byte buffer import java util concurr concurr map import org apach common lang array util import org slf logger import org slf logger factori import org apach cassandra decor key import org apach cassandra read respons import org apach cassandra row import org apach cassandra util fast byte array input stream import org apach cassandra net messag import org apach cassandra util util import org cliffc high scale lib block hash map public abstract class abstract row resolv implement respons resolv row protect static logger logger logger factori logger abstract row resolv class privat static final messag messag util broadcast address storag servic verb array util protect final string tabl protect final concurr map messag read respons repli block hash map messag read respons protect final decor key key public abstract row resolv byte buffer key string tabl key storag servic partition decor key key tabl tabl public void preprocess messag messag byte bodi messag messag bodi fast byte array input stream buf fast byte array input stream bodi tri read respons result read respons serial deseri data input stream buf messag version logger debug enabl logger debug preprocess respons result digest queri digest data repli put messag result catch throw error hack local read don forc serial extra real messag public void inject pre process read respons result assert repli null onli local repli repli put result public iter messag messag return repli key set public int max live column throw unsupport oper 