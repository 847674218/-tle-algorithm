licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra net import java import java net inet address import java util collect import java util hashtabl import java util map import org apach cassandra version serial import org apach cassandra servic storag servic import org apach cassandra util util import googl common collect immut map import googl common collect map public class header privat static version serial header serial static serial header serial public static version serial header serial return serial ultim origin request coordin multi setup necessarili node request storag proxi send messag row mutat verb handler local node privat final inet address privat final storag servic verb verb protect final map string byte detail header inet address storag servic verb verb verb collect string byte empti map header inet address storag servic verb verb map string byte detail assert null assert verb null verb verb detail immut map copi detail inet address return storag servic verb verb return verb byte detail string key return detail key header detail ad string key byte valu map string byte detail copi map hash map detail detail copi put key valu return header verb detail copi header detail remov string key detail key key return map string byte detail copi map hash map detail detail copi remov key return header verb detail copi public int serial size int size size compact endpoint serial helper serial size size size string key detail key set size util encod length key byte valu detail key size valu length return size class header serial implement version serial header public void serial header data output dos int version throw compact endpoint serial helper serial dos dos write int verb ordin dos write int detail size string key detail key set dos write key byte valu detail key dos write int valu length dos write valu public header deseri data input dis int version throw inet address compact endpoint serial helper deseri dis int verb ordin dis read int int size dis read int map string byte detail hashtabl string byte size int size string key dis read int length dis read int byte byte byte length dis read fulli byte detail put key byte return header storag servic verb ordin detail public long serial size header header int version throw unsupport oper 