licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java import java util concurr timeout import org slf logger import org slf logger factori import org apach cassandra config databas descriptor import org apach cassandra util fast byte array input stream import org apach cassandra net import org apach cassandra util util import org apach cassandra servic storag proxi import org apach cassandra thrift unavail public class counter mutat verb handler implement verb handler privat static logger logger logger factori logger counter mutat verb handler class public void verb final messag messag final string byte byte messag messag bodi fast byte array input stream buffer fast byte array input stream byte tri data input stream data input stream buffer final counter mutat counter mutat serial deseri messag version logger debug enabl logger debug appli string local data center databas descriptor endpoint snitch datacent util broadcast address wait result write thread otherwis distribut deadlock replica run verb handler callback send respons note callback call request timeout becaus coordin counter mutat timeout case storag proxi appli counter mutat leader local data center runnabl public void run tri write respons respons write respons tabl key true messag respons messag write respons write respons messag messag respons messag servic instanc send repli respons messag messag catch logger error error write respons counter mutat catch unavail check unavail coordin henc reason coordin timeout veri unlik case arriv catch timeout coordin timeout ignor catch logger error error counter mutat 