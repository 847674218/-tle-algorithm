packag org apach cassandra filter licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java nio byte buffer import java util import org slf logger import org slf logger factori import org apach cassandra import org apach cassandra columniter column iter import org apach cassandra columniter tabl column iter import org apach cassandra columniter ident queri filter import org apach cassandra marshal abstract type import org apach cassandra sstabl tabl reader import org apach cassandra util file data input import org apach cassandra thrift slice predic import org apach cassandra thrift slice rang import org apach cassandra util closeabl iter import org apach cassandra util merg iter public class queri filter privat static final logger logger logger factori logger queri filter class public final decor key key public final queri path path public final filter filter privat final filter super filter public queri filter decor key key queri path path filter filter key key path path filter filter super filter path super column null null queri filter path super column public column iter memtabl column iter memtabl memtabl column famili memtabl column famili key null return null return memtabl column iter key public column iter memtabl column iter column famili decor key key assert null path super column null return filter memtabl column iter key return super filter memtabl column iter key move befor field public tabl column iter tabl column iter tabl reader sstabl path super column null return filter tabl column iter sstabl key return super filter tabl column iter sstabl key public tabl column iter tabl column iter tabl reader sstabl file data input file decor key key path super column null return filter tabl column iter sstabl file key return super filter tabl column iter sstabl file key move befor field public void collat column final column famili return list extend closeabl iter column collat final int befor filter top level filter super filter null filter super filter compar column fcomp top level filter column compar return compar defin reduc iter merg column great simplifi comput live column presenc tombston merg iter reduc column column reduc merg iter reduc column column column famili cur return clone shallow public void reduc column current cur super cur empti super column add clone sinc super column modifi otherwis alias memtabl somewher don care consum result instanc column famili call remov delet result remov column shouldn origin super column assert current instanceof super column cur add column super column current clone els cur add column current protect column reduc column cur iter super filter null filter super column onli immedi parent supercolumn determin subcolumn live shadow parent tombston bump temporarili tombston time greater long delet mark delet return mark delet delet super column delet local delet time return mark delet filter filter super column super column befor super column delet local delet time delet reset tombston time cur clear return iter column reduc merg iter collat fcomp reduc top level filter collect reduc column return reduc befor public string column famili return path column famili public static boolean relev column column column int befor column abl live relev tombston live subcolumn delet column chang tombston sinc otherwis onli repair care tombston long max chang column cabl chang befor return column local delet time befor max chang column mark delet mark delet max chang mark delet return queri filter object satisfi slice criteria param key row slice param path path level slice super column param start column start slice inclus empti column param finish column stop slice inclus empti column param revers true start largest column determin configur sort order smallest param limit maximum number delet column return public static queri filter slice filter decor key key queri path path byte buffer start byte buffer finish boolean revers int limit return queri filter key path slice queri filter start finish revers limit return queri filter object includ everi column row danger larg row avoid test code public static queri filter ident filter decor key key queri path path return queri filter key path ident queri filter return queri filter object return column match param key row slice param path path level slice super column param column column restrict result sort compar order public static queri filter filter decor key key queri path path sort set byte buffer column return queri filter key path queri filter column public static filter filter slice predic predic abstract type compar predic column null final sort set byte buffer column set tree set byte buffer compar column set add predic column return queri filter column set slice rang rang predic slice rang return slice queri filter rang start rang finish rang revers rang count conveni method creat filter match singl column public static queri filter filter decor key key queri path path byte buffer column return queri filter key path queri filter column overrid public string string return class simpl key key path path filter null filter filter super filter null super filter super filter 