licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java data output import java error import java import java util array list import java util collect import java util list import org apach cassandra config databas descriptor import org apach cassandra sstabl index helper import org apach cassandra util data output buffer import org apach cassandra util iter column import org apach cassandra util bloom filter creat index column famili base size column public class column index column famili function creat memori structur repres column index column famili subsequ write disk param column column famili creat index param dos data output stream public static void serial iter column column data output dos tri write index serial column dos catch throw error public static void serial row header index info data output dos tri write index index info dos catch throw error serial index memori structur requir compon bloom filter index block size index info list param column column famili creat index return inform index bloom filter block size index info list public static row header serial iter column column int column count column estim column count bloom filter bloom filter filter column count column count return row header collect index helper index info empti list updat bloom filter creat list index info object mark column block column index size list index helper index info index list array list index helper index info long posit start posit column column null column null column column column add column column null column column start posit posit posit column serial size hit column index size index index posit start posit databas descriptor column index size index helper index info index info index helper index info column column start posit posit start posit index list add index info column null column column column column null return row header collect index helper index info empti list column fallen index boundari alreadi index explicit index list empti column compar compar index list index list size column index helper index info index info index helper index info column column start posit posit start posit index list add index info alway comput index block onli write assert index list size return row header index list privat static void write index row header index info data output dos throw assert index info null write bloom filter write bloom filter dos index info bloom filter dos write int index info entri size index info index entri size index helper index info index info index info index entri index info serial dos write bloom filter file param dos file serial bloom filter param bloom filter throw ani error privat static void write bloom filter data output dos bloom filter throw data output buffer buf data output buffer bloom filter serial serial buf dos write int buf length dos write buf data buf length buf flush hold inform serial index bloom filter public static class row header public final bloom filter bloom filter public final list index helper index info index entri public final int entri size public row header bloom filter list index helper index info index assert null assert index null bloom filter index entri index int entri size index entri size index helper index info info index entri entri size info serial size entri size entri size public long serial size return constant int size length bloom filter bloom filter serial size data constant int size length index block entri size index block 