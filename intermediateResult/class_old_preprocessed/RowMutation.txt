licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java data input import java data input stream import java data output import java import java nio byte buffer import java util import org apach common lang string util import org apach cassandra config meta data import org apach cassandra config meta data import org apach cassandra config schema import org apach cassandra filter queri path import org apach cassandra column serial import org apach cassandra version serial import org apach cassandra util fast byte array input stream import org apach cassandra net messag import org apach cassandra net messag produc import org apach cassandra net messag servic import org apach cassandra servic storag servic import org apach cassandra thrift column super column import org apach cassandra thrift delet import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util gen public class row mutat implement mutat messag produc privat static row mutat serial serial row mutat serial public static final string public static row mutat serial serial return serial privat string tabl privat byte buffer key map column famili mutat column famili protect map integ column famili modif hash map integ column famili privat map integ byte preseri buffer hash map integ byte public row mutat string tabl byte buffer key tabl tabl key key public row mutat string tabl row row tabl tabl key row key key add row protect row mutat string tabl byte buffer key map integ column famili modif tabl tabl key key modif modif public string tabl return tabl public collect integ column famili id return modif key set public byte buffer key return key public collect column famili column famili return modif valu public column famili column famili integ return modif return mutat repres hint code address code becom avail format follow hint column famili dest token key uuid super column tabl tabl column key key mutat mutat version version public static row mutat hint row mutat mutat byte buffer token throw row mutat row mutat tabl token byte buffer hint byte buffer wrap gen time byte determin row mutat set smallest grace ani ensur delet aren undon deliveri hint int ttl integ column famili mutat column famili ttl math min ttl metadata grace serial row mutat queri path path queri path hint hand manag hint byte buffer util byte mutat add path byte buffer wrap mutat serial buffer messag servic version system current time milli ttl serial version path queri path hint hand manag hint byte buffer util byte version add path byte buffer util byte messag servic version system current time milli ttl tabl path queri path hint hand manag hint byte buffer util byte tabl add path byte buffer util byte mutat tabl system current time milli ttl key path queri path hint hand manag hint byte buffer util byte key add path mutat key system current time milli ttl return specifi column famili correspond column famili object param column famili param column famili column famili public void add column famili column famili assert column famili null column famili prev modif put column famili column famili prev null develop error throw illeg argument column famili column famili alreadi modif mutat prev return column famili row mutat correspond param creat empti necessari public column famili add string meta data cfm schema instanc meta data tabl column famili modif cfm null column famili creat cfm modif put cfm return public boolean empti return modif empti specifi column correspond valu column column specifi column famili column result column famili associ column famili column column column broken super column columnnam case super column param column column famili column param valu valu associ column param timestamp timestamp associ data param time live ttl column standard expir column deprec tend perform hash lookup instanti pair caller tend instanti object call add column famili overload public void add queri path path byte buffer valu long timestamp int time live integ schema instanc tabl path column famili column famili column famili modif column famili null column famili column famili creat tabl path column famili modif put column famili column famili add column path valu timestamp time live public void add counter queri path path long valu integ schema instanc tabl path column famili column famili column famili modif column famili null column famili column famili creat tabl path column famili modif put column famili column famili add counter path valu public void add queri path path byte buffer valu long timestamp add path valu timestamp public void delet queri path path long timestamp integ schema instanc tabl path column famili int local delet time int system current time milli column famili column famili modif column famili null column famili column famili creat tabl path column famili modif put column famili path super column null path column null column famili delet local delet time timestamp els path column null super column super column path super column column famili compar delet local delet time timestamp column famili add column els column famili add tombston path local delet time timestamp public void add mutat instanceof row mutat throw illeg argument row mutat row mutat tabl equal tabl key equal key throw illeg argument map entri integ column famili entri modif entri set slighti faster assum key wasn present fix case wasn inde column famili modif put entri key entri valu null entri valu resolv equival call commit appli chang tabl obtain call tabl open public void appli throw meta data ksm schema instanc tabl definit tabl tabl open tabl appli ksm durabl write public void appli unsaf throw tabl open tabl appli fals public messag messag integ version throw return messag storag servic verb version public messag messag storag servic verb verb int version throw return messag util broadcast address verb serial buffer version version public synchron byte serial buffer int version throw byte byte preseri buffer version byte null byte util serial serial version preseri buffer put version byte return byte public string string return string fals public string string boolean shallow string builder buff string builder row mutat buff append keyspac append tabl append buff append key append byte buffer util byte hex key append buff append modif shallow list string cfname array list string modif size integ cfid modif key set meta data cfm schema instanc meta data cfid cfname add cfm null drop cfm buff append string util join cfname els buff append string util join modif valu return buff append string public void add column super column string column super column cosc cosc super column null org apach cassandra thrift column column cosc super column column add queri path cosc super column column column valu column timestamp column ttl els cosc column null add queri path null cosc column cosc column valu cosc column timestamp cosc column ttl els cosc counter super column null org apach cassandra thrift counter column column cosc counter super column column add counter queri path cosc counter super column column column valu els cosc counter column null add counter queri path null cosc counter column cosc counter column valu public void delet column super column string delet del del predic null del predic column null byte buffer del predic column del super column null schema instanc column famili type tabl column famili type super delet queri path del timestamp els delet queri path del super column del timestamp els delet queri path del super column del timestamp public static row mutat byte byte raw int version throw row mutat serial deseri data input stream fast byte array input stream raw version boolean counter fals map entri integ column famili entri modif entri set entri valu metadata default valid commut counter true break deseri onc counter cleanup delta counter version messag servic version preseri buffer put version raw return public static class row mutat serial implement version serial row mutat public void serial row mutat data output dos int version throw dos write tabl byte buffer util write short length key dos serial modif mutat int size modif size dos write int size assert size map entri integ column famili entri modif entri set dos write int entri key column famili serial serial entri valu dos public row mutat deseri data input dis int version column serial flag flag throw string tabl dis read byte buffer key byte buffer util read short length dis map integ column famili modif hash map integ column famili int size dis read int int size integ cfid integ valu dis read int column famili column famili serial deseri dis flag tree map sort column factori modif put cfid return row mutat tabl key modif public row mutat deseri data input dis int version throw return deseri dis version column serial flag public long serial size row mutat int version int size constant short size util encod length tabl size constant short size key remain size constant int size map entri integ column famili entri modif entri set size constant int size size entri valu serial size return size 