licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra client import java import java net inet address import java net unknown host import java nio byte buffer import java util list import org apach cassandra dht partition import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra hadoop config helper import org apach cassandra thrift cassandra import org apach cassandra thrift invalid request import org apach cassandra thrift token rang import org apach hadoop conf configur import org apach thrift import org slf logger import org slf logger factori import googl common collect array list multimap import googl common collect multimap class cach ring map client usag exampl test unit org apach cassandra client test ring cach java naiv linear search token map public class ring cach final privat static logger logger logger factori logger ring cach class privat final partition partition privat final configur conf privat multimap rang token inet address rang map public ring cach configur conf throw conf conf partition config helper output partition conf refresh endpoint map public void refresh endpoint map tri cassandra client client config helper client output address list conf list token rang ring client describ ring config helper output keyspac conf rang map array list multimap creat token rang rang ring token left partition token factori string rang start token token partition token factori string rang token rang token rang token left partition string host rang endpoint tri rang map put inet address host catch unknown host throw assert error host string catch invalid request throw runtim catch throw runtim catch logger debug error contact seed list config helper output initi address conf messag list multimap promis return list public list inet address endpoint rang token rang return list inet address rang map rang public list inet address endpoint byte buffer key return endpoint rang key public rang token rang byte buffer key naiv linear search token map token partition token key rang token rang rang map key set rang return rang throw runtim invalid token inform return describ ring rang map 