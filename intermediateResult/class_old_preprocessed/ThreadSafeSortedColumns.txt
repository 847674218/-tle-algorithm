licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java nio byte buffer import java util collect import java util iter import java util sort map import java util sort set import java util concurr concurr skip list map import googl common base function import org apach cassandra marshal abstract type import org apach cassandra util alloc public class thread safe sort column extend abstract thread unsaf sort column implement sort column privat final concurr skip list map byte buffer column map public static final sort column factori factori factori public sort column creat abstract type compar boolean insert revers return thread safe sort column compar public sort column sort sort map byte buffer column sort map boolean insert revers return thread safe sort column sort map public static sort column factori factori return factori public abstract type compar return abstract type map compar privat thread safe sort column abstract type compar map concurr skip list map byte buffer column compar privat thread safe sort column sort map byte buffer column column map concurr skip list map byte buffer column column public sort column factori factori return factori public sort column clone return thread safe sort column map public boolean insert revers return fals find column resolv els add column public void add column column column alloc alloc add column intern column alloc privat long add column intern column column alloc alloc byte buffer column true column column map put absent column column null return column serial size column instanceof super column assert column instanceof super column long previous size column serial size super column column put column super column column alloc return column serial size previous size els calcul reconcil col exist col col column reconcil column column reconcil column alloc map replac column reconcil column return reconcil column serial size column serial size fail replac column due concurr updat concurr remov tri current concurr remov happen onli updat support column column resolv befor ad public void add sort column alloc alloc function column column transform add size delta alloc transform overrid public long add size delta sort column alloc alloc function column column transform delet delet info long size delta column column sort column size delta add column intern transform appli column alloc return size delta public boolean replac column column column column column equal column throw illeg argument return map replac column column column public column column byte buffer return map public void remov column byte buffer map remov public void clear map clear public int size return map size public collect column sort column return map valu public collect column revers sort column return map descend map valu public sort set byte buffer column return map navig key set public iter column iter return map valu iter public iter column revers iter return revers sort column iter public iter column iter byte buffer start return map tail map start valu iter public iter column revers iter byte buffer start return map descend map tail map start valu iter 