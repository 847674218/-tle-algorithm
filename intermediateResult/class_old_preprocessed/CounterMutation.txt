licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java import java nio byte buffer import java util collect import java util list import java util link list import org slf logger import org slf logger factori import org apach cassandra filter queri path import org apach cassandra version serial import org apach cassandra net messag import org apach cassandra servic storag servic import org apach cassandra util byte buffer util import org apach cassandra util heap alloc import org apach cassandra util util import org apach cassandra thrift consist level public class counter mutat implement mutat privat static final logger logger logger factori logger counter mutat class privat static final counter mutat serial serial counter mutat serial privat final row mutat row mutat privat final consist level consist public counter mutat row mutat row mutat consist level consist row mutat row mutat consist consist public string tabl return row mutat tabl public collect integ column famili id return row mutat column famili id public byte buffer key return row mutat key public row mutat row mutat return row mutat public consist level consist return consist public static counter mutat serial serial return serial public row mutat replic mutat throw list read command read command link list read command column famili column famili row mutat column famili column famili metadata replic write continu add read command column famili row mutat tabl row mutat key column famili read command creat replic row mutat row mutat replic mutat row mutat row mutat tabl row mutat key read command read command read command tabl tabl tabl open read command tabl row row read command row tabl row null row null continu column famili row super retain row mutat column famili metadata replic mutat add return replic mutat privat void add read command column famili string tabl byte buffer key column famili column famili list read command command queri path queri path queri path column famili metadata command add slice read command tabl key queri path column famili column public messag mutat messag int version throw byte byte util serial serial version return messag util broadcast address storag servic verb byte version public boolean replic write column famili row mutat column famili metadata replic write return true return fals public void appli throw transform counter updat column counter column accomplish local copi row mutat row mutat row mutat tabl byte buffer util clone row mutat key tabl tabl tabl open tabl column famili row mutat column famili column famili clone shallow column famili store cfs tabl column famili store column column add column column local copi cfs heap alloc instanc add appli public void add mutat instanceof counter mutat throw illeg argument counter mutat counter mutat row mutat add row mutat overrid public string string return string fals public string string boolean shallow string builder buff string builder counter mutat buff append row mutat string shallow buff append append consist string return buff append string class counter mutat serial implement version serial counter mutat public void serial counter mutat data output dos int version throw row mutat serial serial row mutat dos version dos write consist public counter mutat deseri data input dis int version throw row mutat row mutat serial deseri dis version consist level consist enum valu consist level class dis read return counter mutat consist public long serial size counter mutat int version return row mutat serial serial size row mutat version constant short size util encod length consist 