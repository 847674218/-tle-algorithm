packag org apach cassandra schedul licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java util concurr synchron queue import java util concurr timeout import java util concurr time unit import java lang manag manag factori import javax manag bean server import javax manag object import org apach cassandra util latenc tracker class weight queue implement weight queue bean privat final latenc tracker stat latenc tracker public final string key public final int weight privat final synchron queue entri queue public weight queue string key int weight key key weight weight queue synchron queue entri true public void regist expos monitor data bean server mbs manag factori platform bean server tri mbs regist bean object org apach cassandra schedul type weight queue queue key catch throw runtim public void put thread long timeout throw interrupt timeout queue offer weight queue entri timeout time unit throw timeout fail acquir request schedul slot key public thread poll entri queue poll null return null stat add nano system nano time creation time return thread overrid public string string return robin schedul weight queue key key weight weight privat final static class entri public final long creation time system nano time public final thread thread public entri thread thread thread thread bean relat method public long oper return stat count public long total latenc micro return stat total latenc micro public doubl latenc micro return stat latenc micro public long total latenc histogram micro return stat total latenc histogram micro public long latenc histogram micro return stat latenc histogram micro 