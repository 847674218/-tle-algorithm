licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java import java nio byte buffer import java util map import org apach cassandra column famili import org apach cassandra read respons import org apach cassandra row import org apach cassandra net messag public class row digest resolv extend abstract row resolv public row digest resolv string tabl byte buffer key super key tabl special case resolv read throw digest mismatch foreground public row data throw map entri messag read respons entri repli entri set read respons result entri valu result digest queri return result row throw assert error data invok data present method handl differ scenario handl initi read data closest replica digest rest case check digest throw mismatch otherwis return data row check addit digest arriv minimum handl request consist level asynchron read repair check public row resolv throw digest mismatch logger debug enabl logger debug resolv repli size respons long start time system current time milli valid digest throw immedi mismatch extract data repli ani column famili data null byte buffer digest null map entri messag read respons entri repli entri set read respons respons entri valu respons digest queri digest null digest respons digest els byte buffer digest respons digest digest equal digest throw digest mismatch key digest digest els data respons row compar digest onli sinc threw earlier differ repli data respons mismatch throw read repair happen import note consid possibl multipl data respons onli happen repair post mismatch handl row repair resolv digest null byte buffer digest column famili digest data digest equal digest throw digest mismatch key digest digest logger debug enabl logger debug digest verifi logger debug enabl logger debug resolv system current time milli start time return row key data public boolean data present read respons result repli valu result digest queri return true return fals 