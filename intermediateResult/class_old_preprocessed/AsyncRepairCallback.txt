packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util concurr atom atom integ import org apach cassandra concurr stage import org apach cassandra concurr stage manag import org apach cassandra net async callback import org apach cassandra net messag import org apach cassandra util wrap runnabl public class async repair callback implement async callback privat final row repair resolv repair resolv privat final int blockfor protect final atom integ receiv atom integ public async repair callback row repair resolv repair resolv int blockfor repair resolv repair resolv blockfor blockfor public void respons messag messag repair resolv preprocess messag receiv increment blockfor stage manag stage stage execut wrap runnabl protect void run throw throw digest mismatch repair resolv resolv public boolean latenc snitch return true 