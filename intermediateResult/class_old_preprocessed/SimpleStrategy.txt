licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra locat import java net inet address import java util array list import java util array import java util iter import java util list import java util map import org apach cassandra config configur import org apach cassandra dht token class return node respons key doe respect rack awar basic return node lie ring public class simpl strategi extend abstract replic strategi public simpl strategi string tabl token metadata token metadata endpoint snitch snitch map string string config option super tabl token metadata snitch config option public list inet address calcul natur endpoint token token token metadata metadata int replica replic factor array list token token metadata sort token list inet address endpoint array list inet address replica token empti return endpoint add token index default iter token iter token metadata ring iter token token fals endpoint size replica iter endpoint add metadata endpoint iter return endpoint public int replic factor return integ pars int config option replic factor public void valid option throw configur config option null config option replic factor null throw configur simpl strategi requir replic factor strategi option warn unexpect option array string list replic factor valid replic factor config option replic factor 