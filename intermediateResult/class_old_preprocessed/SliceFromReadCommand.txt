licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java import java nio byte buffer import java util collect import java util hash set import java util iter import org apach cassandra filter queri filter import org apach cassandra filter queri path import org apach cassandra version serial import org apach cassandra servic repair callback import org apach cassandra servic storag servic import org apach cassandra thrift column parent import org apach cassandra util byte buffer util import org apach cassandra util util import org slf logger import org slf logger factori public class slice read command extend read command static final logger logger logger factori logger slice read command class public final byte buffer start finish public final boolean revers public final int count public slice read command string tabl byte buffer key column parent column parent byte buffer start byte buffer finish boolean revers int count tabl key queri path column parent start finish revers count public slice read command string tabl byte buffer key queri path path byte buffer start byte buffer finish boolean revers int count super tabl key path start start finish finish revers revers count count public read command copi read command read command slice read command tabl key queri path start finish revers count read command set digest queri digest queri return read command public row row tabl tabl throw decor key storag servic partition decor key key return tabl row queri filter slice filter queri path start finish revers count overrid public read command mayb generat retri command repair callback handler row row int max live column handler max live column int live column row row null row live column count generat retri node repli count live column merg total number column interest count retri max live column count live column row origin request count count live column live column row estim row request column onli live reconcili column int retri count live column row count count count live column row return retri slice read command tabl key queri path start finish revers origin request count retri count return null overrid public void mayb trim row row row null row null return int live column row row live column count live column row origin request count int column trim live column row origin request count logger debug trim live column origin request row live column count origin request count collect column column revers column row sort column els column row revers sort column collect byte buffer remov hash set byte buffer iter column column iter column iter column iter remov size column trim column column column iter column live remov add column byte buffer column remov row remov column origin number column request user differ count slice command retri retri slice read command protect int origin request count return count overrid public string string return slice read command tabl tabl key byte buffer util byte hex key column parent queri path start compar string start finish compar string finish revers revers count count class slice read command serial implement version serial read command public void serial read command data output dos int version throw slice read command real slice read command dos write boolean real digest queri dos write real tabl byte buffer util write short length real key dos real queri path serial dos byte buffer util write short length real start dos byte buffer util write short length real finish dos dos write boolean real revers dos write int real count public read command deseri data input dis int version throw boolean digest dis read boolean slice read command slice read command dis read byte buffer util read short length dis queri path deseri dis byte buffer util read short length dis byte buffer util read short length dis dis read boolean dis read int set digest queri digest return public long serial size read command cmd int version slice read command command slice read command cmd int size constant bool size size constant short size util encod length command tabl size constant short size command key remain size command queri path serial size size constant short size command start remain size constant short size command finish remain size constant bool size size constant int size return size 