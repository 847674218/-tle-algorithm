packag org apach cassandra licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java data input import java data output import java import java nio byte buffer import org slf logger import org slf logger factori import org apach cassandra column serial import org apach cassandra util file data input import org apach cassandra util byte buffer util import org apach cassandra util util public class column serial implement column serial privat static final logger logger logger factori logger column serial class public final static int public final static int public final static int public final static int public void serial column column data output dos assert column remain byte buffer util write short length column dos tri dos write byte column serial flag column instanceof counter column dos write long counter column column timestamp delet els column instanceof expir column dos write int expir column column time live dos write int column local delet time dos write long column timestamp byte buffer util write length column valu dos catch throw runtim public column deseri data input dis throw return deseri dis flag counter column deseri deseri remot host doe clear delta public column deseri data input dis column serial flag flag throw return deseri dis flag int system current time milli public column deseri data input dis column serial flag flag int expir befor throw byte buffer byte buffer util read short length dis remain string format invalid column length string detail dis instanceof file data input file data input fdis file data input dis detail string format byte remain fdis path fdis byte remain throw corrupt column string format format remain detail int dis read unsign byte long timestamp delet dis read long long dis read long byte buffer valu byte buffer util read length dis return counter column creat valu timestamp delet flag els int ttl dis read int int expir dis read int long dis read long byte buffer valu byte buffer util read length dis return expir column creat valu ttl expir expir befor flag els long dis read long byte buffer valu byte buffer util read length dis return counter updat column valu column valu delet column valu public long serial size column object return object serial size privat static class corrupt column extend public corrupt column string super 