licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java nio byte buffer import java util import org apach cassandra import org apach cassandra filter queri path import org apach cassandra servic storag proxi import org apach cassandra servic storag servic import org apach cassandra thrift import org apach cassandra util byte buffer util import org apach thrift import org apach thrift protocol binari protocol import org apach thrift protocol protocol import org apach thrift transport frame transport import org apach thrift transport socket import org apach thrift transport transport import org apach thrift transport transport import org slf logger import org slf logger factori public class client onli exampl privat static final logger logger logger factori logger client onli exampl class privat static final string keyspac privat static final string standard privat static void start client throw storag servic instanc init client sleep bit gossip tri thread sleep catch throw assert error privat static void test write throw write int row mutat chang row mutat byte buffer util byte key column path column path set column colb byte chang add queri path byte buffer util byte valu don call chang appli reason static call tabl perform local storag initi creat local directori chang appli storag proxi mutat array list chang consist level system println wrote key system println write privat static void test read throw queri collect byte buffer col array list byte buffer add byte buffer util byte colb int list read command command array list read command slice read command read command slice read command byte buffer util byte key queri path null null col read command set digest queri fals command add read command list row row storag proxi read command consist level assert row size row row row column famili row null column col sort column system println byte buffer util string col byte buffer util string col valu els system err println output indic noth read bring node run client onli exampl argument xmx dcassandra config user gari cassandra conf cassandra yaml option cassandra yaml classpath pass write read program exercis method caveat cassandra reentrant spin client jvm becaus abov forc quit process storag servic stop client doesn spin everyth public static void main string arg throw start client setup keyspac creat connect test write logger info write sleep tri read tri thread current thread sleep catch interrupt throw runtim test read storag servic instanc decommiss storag servic instanc stop client system exit onli realli stop process method fail keyspac alreadi exist privat static void setup keyspac cassandra ifac client throw invalid request list def def list array list def def column famili def def list add column famili tri client system add keyspac def org apach cassandra locat simpl strategi def list int magnitud client describ ring size tri thread sleep magnitud catch interrupt throw runtim catch invalid request probabl exist logger warn problem creat keyspac probabl exist messag privat static cassandra ifac creat connect throw transport system properti cassandra host null system properti cassandra port null logger warn cassandra host cassandra port defin default return creat connect system properti cassandra host localhost integ valu system properti cassandra port boolean valu system properti cassandra frame true privat static cassandra client creat connect string host integ port boolean frame throw transport socket socket socket host port transport tran frame frame transport socket socket tran open protocol protocol binari protocol tran return cassandra client protocol 