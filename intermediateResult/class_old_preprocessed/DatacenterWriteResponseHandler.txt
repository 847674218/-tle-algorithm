packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java net inet address import java util collect import org apach cassandra config databas descriptor import org apach cassandra tabl import org apach cassandra gms failur detector import org apach cassandra locat endpoint snitch import org apach cassandra locat network topolog strategi import org apach cassandra net messag import org apach cassandra thrift consist level import org apach cassandra thrift unavail import org apach cassandra util util class block quorum respons local datacent onli public class datacent write respons handler extend write respons handler privat static final endpoint snitch snitch databas descriptor endpoint snitch privat static final string localdc static localdc snitch datacent util broadcast address protect datacent write respons handler collect inet address write endpoint consist level consist level string tabl runnabl callback super write endpoint consist level tabl callback assert consist level consist level public static write respons handler creat collect inet address write endpoint consist level consist level string tabl runnabl callback return datacent write respons handler write endpoint consist level tabl callback overrid protect int determin block string tabl network topolog strategi strategi network topolog strategi tabl open tabl replic strategi return strategi replic factor localdc overrid public void respons messag messag messag null localdc equal snitch datacent messag respons decrement signal overrid public void assur suffici live node throw unavail int live node inet address destin write endpoint localdc equal snitch datacent destin failur detector instanc aliv destin live node live node respons throw unavail 