licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java util import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra auth authent user import org apach cassandra auth permiss import org apach cassandra auth permiss deni import org apach cassandra auth resourc import org apach cassandra config databas descriptor import org apach cassandra config schema import org apach cassandra cql statement import org apach cassandra tabl import org apach cassandra thrift authent import org apach cassandra thrift invalid request import org apach cassandra util semant version client thread local state avro thrift thread hold kill thrift public class client state privat static final int buggi client ing privat static logger logger logger factori logger client state class public static final semant version org apach cassandra cql queri processor current user session privat authent user user privat string keyspac reusabl array author privat final list object resourc array list object privat semant version cql version map prepar statement privat map integ statement prepar link hash map integ statement true protect boolean remov eldest entri map entri integ statement eldest return size privat map integ org apach cassandra cql statement cql prepar link hash map integ org apach cassandra cql statement true protect boolean remov eldest entri map entri integ org apach cassandra cql statement eldest return size privat long clock construct empti client state reus logout reset public client state reset public map integ statement prepar return prepar public map integ org apach cassandra cql statement prepar return cql prepar public string raw keyspac return keyspac public string keyspac throw invalid request keyspac null throw invalid request keyspac specifi return keyspac public void set keyspac string throw invalid request schema instanc meta data null throw invalid request keyspac doe exist keyspac public string schedul valu switch databas descriptor request schedul case keyspac return keyspac return default attempt login client credenti map public void login map extend char sequenc extend char sequenc credenti throw authent authent user user databas descriptor authent authent credenti logger debug enabl logger debug log user user user public void logout logger debug enabl logger debug log user reset privat void resourc clear resourc clear resourc add resourc resourc add resourc public void reset user databas descriptor authent default user keyspac null resourc clear prepar clear cql prepar clear cql version public void keyspac access string keyspac permiss perm throw invalid request valid login valid keyspac keyspac prevent system schema modif keyspac perm resourc clear resourc add keyspac set permiss perm databas descriptor author author user resourc access user perm perm resourc privat void prevent system schema modif string keyspac permiss perm throw invalid request keyspac equal ignor case tabl perm equal permiss throw invalid request system keyspac user modifi confirm client thread permiss context column famili current keyspac public void column famili access string keyspac string column famili permiss perm throw invalid request valid login valid keyspac keyspac resourc clear resourc add keyspac prevent system schema modif keyspac perm check user perm keyspac permiss cfs databas descriptor author author user resourc perm return resourc add column famili set permiss perm databas descriptor author author user resourc access user perm perm resourc privat void valid login throw invalid request user null throw invalid request log privat static void valid keyspac string keyspac throw invalid request keyspac null throw invalid request set keyspac session privat static void access authent user user set permiss perm permiss perm list object resourc throw permiss deni perm perm return throw permiss deni string format doe permiss user perm resourc string resourc clock guarante updat client order sequenc multipl updat happen millisecond client perform multipl updat singl column public long timestamp long current system current time milli clock clock current clock current return clock public void set version string str throw invalid request semant version version tri version semant version str catch illeg argument throw invalid request messag semant version cql org apach cassandra cql queri processor semant version cql org apach cassandra cql queri processor version support cql cql version cql els version support cql cql version cql els throw invalid request string format provid version support server support version string util join support version public semant version version return cql version public static semant version support version semant version cql org apach cassandra cql queri processor semant version cql org apach cassandra cql queri processor return semant version cql cql 