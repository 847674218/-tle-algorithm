licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql statement import java nio byte buffer import java util list import java util map import org apach cassandra cql statement import org apach cassandra config configur import org apach cassandra config schema import org apach cassandra cql import org apach cassandra servic client state import org apach cassandra servic storag proxi import org apach cassandra thrift cql result import org apach cassandra thrift invalid request import org apach cassandra thrift schema disagr import googl common base predic import googl common collect map abstract class statement alter schema public abstract class schema alter statement extend statement implement statement privat static final long time limit schema agreement privat final boolean column famili level protect schema alter statement super null column famili level fals protect schema alter statement super column famili level true overrid public void prepar keyspac client state state throw invalid request column famili level super prepar keyspac state public prepar prepar throw invalid request return prepar public abstract void announc migrat throw invalid request configur overrid public void valid client state state throw invalid request schema disagr valid schema agreement public cql result execut client state state list byte buffer variabl throw invalid request schema disagr tri announc migrat catch configur invalid request invalid request string init caus throw valid schema settl return null copypasta cassandra server privat privat static void valid schema agreement throw schema disagr describ schema version size throw schema disagr privat static map string list string describ schema version unreach host don count disagr return map filter key storag proxi describ schema version predic predic equal storag proxi privat static void valid schema settl throw schema disagr long limit system current time milli time limit schema agreement outer limit system current time milli string current version schema instanc version string string version describ schema version key set version equal current version continu outer schema agre return throw schema disagr 