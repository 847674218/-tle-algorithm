licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra tool import java file import java import java print stream import java nio byte buffer import java util import org apach cassandra config meta data import org apach cassandra config databas descriptor import org apach cassandra config schema import org apach cassandra import org apach cassandra marshal abstract type import org apach common cli import org apach cassandra config configur import org apach cassandra dht partition import org apach cassandra sstabl import org apach cassandra util byte buffer util import org codehaus jackson json generat import org codehaus jackson map object mapper import static org apach cassandra util byte buffer util byte hex import static org apach cassandra util byte buffer util hex byte export tabl format public class tabl export privat static object mapper json mapper object mapper privat static final string privat static final string privat static final string privat static option option privat static command line cmd static option option option opt key option true row key number time key pass command line opt key set arg option add option opt key option exclud key option true exclud row key number time key pass command line exclud key set arg option add option exclud key option opt enumer option fals enumer key onli option add option opt enumer disabl auto close stream json mapper configur json generat featur fals hash key serial param output steam write data param valu valu set key privat static void write key print stream string valu write valu print serial column column iter param column column iter param output stream param compar column compar param meta data column famili metadata valid privat static void serial column iter column column print stream abstract type compar meta data meta data column write serial column column compar meta data column print serial column format param column column present param compar column compar param meta data column famili metadata valid return column serial list privat static list object serial column column column abstract type compar meta data meta data array list object serial column array list object byte buffer byte buffer util clone column byte buffer valu byte buffer util clone column valu serial column add compar string column instanceof delet column serial column add byte buffer util byte hex valu els abstract type valid meta data valu valid serial column add valid string valu serial column add column timestamp column instanceof delet column serial column add els column instanceof expir column serial column add serial column add expir column column time live serial column add column local delet time els column instanceof counter column serial column add serial column add counter column column timestamp delet return serial column portion column serial loop column left row param row tabl ident iter row represent column famili param key decor key requir row param output stream privat static void serial row tabl ident iter row decor key key print stream column famili column famili row column famili boolean super column famili super meta data meta data column famili metadata abstract type compar column famili compar write key byte hex key key print super super row column column row write key compar string column print write key delet print column mark delet print write key column print serial column column column iter column famili compar meta data print print row print els serial column row compar meta data print super enumer row key tabl reader write result print stream param desc descriptor file export row param print stream write output throw failur read write input output public static void enumeratekey descriptor desc print stream throw key iter iter key iter desc decor key key null iter decor key key iter valid order key sstabl key null key compar key throw key order key key key key println byte hex key key iter close flush export specif row tabl write result print stream param desc descriptor sstabl tabl read param print stream write output param export key correspond row export param exclud key exclud export throw failur read write input output public static void export descriptor desc print stream collect string export string exclud throw tabl reader reader tabl reader open desc tabl scanner scanner reader direct scanner partition partition reader partition exclud null export remov array list exclud println int key compar order decor key key null string key export decor key decor key partition decor key hex byte key key null key compar decor key throw key order key decor key key decor key scanner seek decor key scanner continu tabl ident iter row tabl ident iter scanner row key equal decor key continu serial row row decor key println println flush scanner close necessari accommod test suit sinc open reader onc process static void export tabl reader reader print stream string exclud throw set string exclud set hash set string exclud null exclud set hash set string array list exclud tabl ident iter row tabl scanner scanner reader direct scanner println int collect key export scanner row tabl ident iter scanner string current key byte hex row key key exclud set current key continu els println serial row row row key println flush scanner close export tabl write result print stream param desc descriptor sstabl tabl read param print stream write output param exclud key exclud export throw failur read write input output public static void export descriptor desc print stream string exclud throw export tabl reader open desc exclud export tabl write result standard param desc descriptor sstabl tabl read param exclud key exclud export throw failur read write tabl standard public static void export descriptor desc string exclud throw export desc system exclud argument specifi tabl option output file export content tabl param arg command line argument throw failur open read write file output stream throw configur configur failur wrong param public static void main string arg throw configur string usag string format usag sstabl key key key key tabl export class command line parser parser posix parser tri cmd parser pars option arg catch pars system err println messag system err println usag system exit cmd arg length system err println suppli exact sstabl system err println usag system exit string key cmd option valu string exclud cmd option valu string tabl file file cmd arg absolut path databas descriptor load schema schema instanc system tabl size string msg system tabl defin system err println msg throw configur msg descriptor descriptor descriptor filenam tabl file schema instanc meta data descriptor null system err println string format provid column famili part cassandra databas keyspac column famili descriptor ksname descriptor cfname system exit cmd option enumeratekey descriptor system els key null key length export descriptor system array list key exclud els export descriptor exclud system exit privat static void write print stream object valu tri json mapper write valu valu catch throw runtim messag 