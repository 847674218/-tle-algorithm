licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import java buffer input stream import java buffer output stream import java import java net inet socket address import java net socket import java net socket import org apach thrift transport stream transport import org apach thrift transport transport import org slf logger import org slf logger factori socket implement transport interfac add socket buffer public class custom socket extend stream transport privat static final logger logger factori logger custom socket class wrap socket object privat socket socket null remot host privat string host null remot port privat int port socket timeout privat int timeout constructor alreadi creat socket param socket alreadi creat socket object throw transport error set stream public custom socket socket socket throw transport socket socket tri socket set linger fals socket set tcp delay true catch socket warn configur socket open tri input stream buffer input stream socket input stream output stream buffer output stream socket output stream catch iox close throw transport transport iox creat unconnect socket connect host port param host remot host param port remot port public custom socket string host int port host port creat unconnect socket connect host port param host remot host param port remot port param timeout socket timeout public custom socket string host int port int timeout host host port port timeout timeout init socket initi socket object privat void init socket socket socket tri socket set linger fals socket set tcp delay true socket set timeout timeout catch socket error configur socket set socket timeout param timeout millisecond timeout public void set timeout int timeout timeout timeout tri socket set timeout timeout catch socket warn set socket timeout return refer socket public socket socket socket null init socket return socket check socket connect public boolean open socket null return fals return socket connect connect socket creat socket object necessari public void open throw transport open throw transport transport socket alreadi connect host length throw transport transport open null host port throw transport transport open port socket null init socket tri socket connect inet socket address host port timeout input stream buffer input stream socket input stream output stream buffer output stream socket output stream catch iox close throw transport transport iox close socket public void close close stream super close close socket socket null tri socket close catch iox warn close socket iox socket null 