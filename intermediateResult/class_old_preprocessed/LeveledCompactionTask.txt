packag org apach cassandra compact licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util collect import java util set import java util concurr count latch import org apach cassandra column famili store import org apach cassandra sstabl tabl reader import org apach cassandra sstabl tabl writer public class level compact task extend compact task privat final int sstabl size privat final count latch latch count latch public level compact task column famili store cfs collect tabl reader sstabl final int befor int sstabl size super cfs sstabl befor sstabl size sstabl size overrid public int execut compact manag compact executor stat collector collector throw tri return super execut collector final latch count public boolean return latch count public boolean mark tabl compact int min int max return super mark tabl compact integ overrid protect boolean tabl segment threshold reach tabl writer writer throw return writer disk file pointer sstabl size overrid protect boolean compact interest set tabl reader compact return true overrid protect boolean partial compact accept return fals overrid protect void cancel latch count 