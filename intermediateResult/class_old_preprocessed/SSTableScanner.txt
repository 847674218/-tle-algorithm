licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java error import java import java util array import java util iter import org apach cassandra columniter column iter factori import org apach cassandra columniter lazi column iter import org slf logger import org slf logger factori import org apach cassandra compact compact scanner import org apach cassandra decor key import org apach cassandra row posit import org apach cassandra columniter column iter import org apach cassandra filter queri filter import org apach cassandra util random access reader import org apach cassandra util byte buffer util public class tabl scanner implement compact scanner privat static logger logger logger factori logger tabl scanner class protect final random access reader file public final tabl reader sstabl privat column iter row protect boolean exhaust fals protect iter column iter iter privat queri filter filter param sstabl tabl scan tabl scanner tabl reader sstabl boolean skip cach tri file sstabl open data reader skip cach catch sstabl mark suspect throw error sstabl sstabl param sstabl tabl scan param filter filter scan column tabl scanner tabl reader sstabl queri filter filter tri file sstabl open data reader fals catch sstabl mark suspect throw error sstabl sstabl filter filter public void close throw file close public void seek row posit seek key tri long posit sstabl posit seek key tabl reader oper posit exhaust true return file seek posit row null catch sstabl mark suspect throw runtim corrupt sstabl public long length byte tri return file length catch throw error public long current posit return file file pointer public string file return sstabl string public boolean iter null iter exhaust array list column iter iter key scan iter return iter public column iter iter null iter exhaust array list column iter iter key scan iter return iter public void remov throw unsupport oper protect class key scan iter implement iter column iter protect long finish public boolean tri row null return file return finish file length catch sstabl mark suspect throw runtim public column iter tri row null file seek finish assert file final decor key key tabl reader decod key sstabl partition sstabl descriptor byte buffer util read short length file long data size tabl reader read row size file sstabl descriptor long data start file file pointer finish data start data size filter null row tabl ident iter sstabl file key data start data size return row els return row lazi column iter key column iter factori public column iter creat return filter tabl column iter sstabl file key catch sstabl mark suspect throw runtim tabl scanner fail provid column public void remov throw unsupport oper overrid public string string return class simpl finish finish overrid public string string return class simpl file file sstabl sstabl exhaust exhaust 