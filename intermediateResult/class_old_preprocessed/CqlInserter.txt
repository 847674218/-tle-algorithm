packag org apach cassandra stress oper licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java nio byte buffer import java util array list import java util list import org apach cassandra column famili type import org apach cassandra stress session import org apach cassandra stress util cassandra client import org apach cassandra stress util oper import org apach cassandra thrift compress import org apach cassandra util gen public class cql insert extend oper privat static list byte buffer valu privat static string cql queri null public cql insert session client int idx super client idx public void run cassandra client client throw session column famili type column famili type super throw runtim super column implement valu null valu generat valu construct queri string onc cql queri null string builder queri string builder standard append session consist level string append int session column key queri append queri append queri append cql queri queri string list string queri parm array list string int session column key column session time compar queri parm add gen type host session local address string els queri parm add string column valu queri parm add string quot cql blob valu valu size array string key string format session total key length index queri parm add string quot cql blob key string format queri null long start system current time milli boolean success fals string messag null int session retri time success break tri session prepar statement integ stmnt prepar statement client cql queri client execut prepar cql queri stmnt queri param byte buffer queri parm els format queri null format queri format cql queri cql queri queri parm client execut cql queri byte buffer wrap format queri byte compress success true catch messag messag success fals success error string format oper retri time error insert key index session retri time key messag null messag session oper increment session key increment session latenc add system current time milli start 