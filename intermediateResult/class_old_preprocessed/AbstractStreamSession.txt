licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra stream import java net inet address import java util concurr atom atom boolean import org slf logger factori import org slf logger import org apach cassandra config databas descriptor import org apach cassandra gms import org apach cassandra util pair public abstract class abstract stream session implement endpoint state chang subscrib failur detect event listen privat static final logger logger logger factori logger abstract stream session class protect string tabl protect pair inet address long context protect final stream callback callback privat final atom boolean close atom boolean fals protect abstract stream session string tabl pair inet address long context stream callback callback tabl tabl context context callback callback gossip instanc regist failur detector instanc regist failur detect event listen public int sourc flag return int context public long session return context public inet address host return context left public void close boolean success close compar set fals true logger debug stream session alreadi close session return close intern success gossip instanc unregist failur detector instanc unregist failur detect event listen logger debug close status success callback null success callback success els callback failur protect abstract void close intern boolean success public void join inet address endpoint endpoint state state public void chang inet address endpoint applic state state version valu valu public void aliv inet address endpoint endpoint state state public void dead inet address endpoint endpoint state state public void remov inet address endpoint convict endpoint doubl public void restart inet address endpoint endpoint state state convict endpoint doubl public void convict inet address endpoint doubl phi endpoint equal host return higher confid failur detect usual becaus fail stream wrong high cost phi databas descriptor phi convict threshold return logger error stream fail becaus die restart remov stream activ background stream won start endpoint close fals 