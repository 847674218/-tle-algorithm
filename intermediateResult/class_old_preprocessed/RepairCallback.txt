packag org apach cassandra servic licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java net inet address import java util list import java util concurr time unit import java util concurr timeout import java util concurr atom atom integ import org apach cassandra config databas descriptor import org apach cassandra row import org apach cassandra net async callback import org apach cassandra net messag import org apach cassandra util simpl condit public class repair callback implement async callback public final row repair resolv resolv privat final list inet address endpoint privat final simpl condit condit simpl condit privat final long start time protect final atom integ receiv atom integ main differ read callback read callback consist level achiev repair hand happi repair repli timeout main differ cours onli creat onc digest mismatch full data read everyon final stage read process public repair callback row repair resolv resolv list inet address endpoint resolv resolv endpoint endpoint start time system current time milli public row throw timeout digest mismatch long timeout databas descriptor rpc timeout system current time milli start time tri condit await timeout time unit catch interrupt throw assert error return receiv resolv resolv null public void respons messag messag resolv preprocess messag receiv increment endpoint size condit signal public boolean latenc snitch return true public int max live column return resolv max live column 