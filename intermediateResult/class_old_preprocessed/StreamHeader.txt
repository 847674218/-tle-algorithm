packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java net inet address import java util array list import java util collect import java util collect import java util list import org apach cassandra version serial import org apach cassandra net compact endpoint serial helper import org apach cassandra net messag servic import org apach cassandra util util public class stream header privat static version serial stream header serial stream session flag avoid duplic session node stream session stream session public static final int public static final int static serial stream header serial public static version serial stream header serial return serial public final string tabl file initi stream public final pend file file session tupl host sessionid public final long session file add session public final collect pend file pend file address sender public final inet address broadcast address public stream header string tabl long session pend file file tabl session file collect pend file empti list public stream header string tabl long session pend file collect pend file pend file tabl session pend file util broadcast address public stream header string tabl long session pend file collect pend file pend file inet address broadcast address tabl tabl session session file pend file pend file broadcast address broadcast address privat static class stream header serial implement version serial stream header public void serial stream header data output dos int version throw dos write tabl dos write long session pend file serial serial file dos version dos write int pend file size pend file file pend file pend file serial serial file dos version compact endpoint serial helper serial broadcast address dos public stream header deseri data input dis int version throw string tabl dis read long session dis read long pend file file pend file serial deseri dis version int size dis read int list pend file pend file array list pend file size int size pend file add pend file serial deseri dis version inet address bca null version messag servic bca compact endpoint serial helper deseri dis return stream header tabl session file pend file bca public long serial size stream header stream header int version throw unsupport oper 