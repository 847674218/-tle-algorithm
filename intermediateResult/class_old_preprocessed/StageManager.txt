licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra concurr import java util enum map import java util concurr link block queue import java util concurr thread pool executor import java util concurr time unit import static org apach cassandra config databas descriptor import org apach cassandra util util class manag executor servic messag reciev messag request run specif stage concurr control henc map approach stage executor creat dynam public class stage manag privat static enum map stage thread pool executor stage enum map stage thread pool executor stage class public static final long extra thread aliv idl public static final int util avail processor static stage put stage multi thread configur stage stage concurr writer stage put stage multi thread configur stage stage concurr reader stage put stage multi thread stage stage util avail processor stage put stage multi thread stage stage util avail processor stage put stage multi thread configur stage stage concurr replic rest singl thread stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage enabl thread pool executor stage stage put stage multi thread stage stage util avail processor privat static thread pool executor multi thread stage stage stage int num thread return enabl thread pool executor num thread time unit link block queue runnabl thread factori stage jmx stage jmx type privat static thread pool executor multi thread configur stage stage stage int num thread return configur thread pool executor num thread time unit link block queue runnabl thread factori stage jmx stage jmx type privat static thread pool executor multi thread configur stage stage stage int num thread int max task befor block return configur thread pool executor num thread time unit link block queue runnabl max task befor block thread factori stage jmx stage jmx type retriev stage stage manag param stage stage retriev public static thread pool executor stage stage stage return stage stage method shut regist stage public static void shutdown stage stage stage valu stage manag stage stage shutdown 