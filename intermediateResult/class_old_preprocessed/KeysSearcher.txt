licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra index key import java import java nio byte buffer import java util import org apach cassandra import org apach cassandra filter import org apach cassandra index secondari index import org apach cassandra index secondari index manag import org apach cassandra index secondari index searcher import org apach cassandra dht abstract bound import org apach cassandra dht rang import org apach cassandra thrift index express import org apach cassandra thrift index oper import org apach cassandra util byte buffer util import org slf logger import org slf logger factori public class key searcher extend secondari index searcher privat static final logger logger logger factori logger key searcher class public key searcher secondari index manag index manag set byte buffer column super index manag column privat index express highest select predic list index express claus index express null int count integ index express express claus skip column belong differ index type column express column continu secondari index index index manag index column express column index null express index oper continu int column index index cfs column column count express count column return privat string express string index express expr return string format base cfs column famili base cfs compar string expr column expr base cfs metadata column metadata expr column valid string expr valu public boolean index list index express claus return highest select predic claus null overrid public list row search list index express claus abstract bound row posit rang int max result filter data filter boolean max column assert claus null claus empti extend filter filter extend filter creat base cfs data filter claus max result max column fals return base cfs filter index iter rang filter filter public column famili store abstract scan iter index iter final abstract bound row posit rang final extend filter filter start restrict index claus appli remain claus row match claus merg join index loop final index express primari highest select predic filter claus final secondari index index index manag index column primari column logger debug enabl logger debug primari scan claus base cfs compar string primari column assert index null final decor key index key index manag index key primari column primari valu rang request token rang start stop index row unfortun ineffici becaus intuit small possibl key token fix actual store token key index row final byte buffer start key rang left instanceof decor key decor key rang left key byte buffer util final byte buffer key rang instanceof decor key decor key rang key byte buffer util return column famili store abstract scan iter privat byte buffer key start key privat iter column index column privat final queri path path queri path base cfs column famili privat int column read integ protect row comput int column math max index index cfs column shouldn fetch onli row provid buggi page case row doesn satisfi claus int row queri math max math min filter max row filter max column column true index column null index column column read row queri logger debug read onli page column read row queri return data logger debug enabl logger debug string format scan index start express string primari index base cfs metadata key valid string start key queri filter index filter queri filter slice filter index key queri path index index cfs column famili key key fals row queri column famili index row index index cfs column famili index filter logger debug fetch index row index row null logger debug data return data collect column sort column index row sort column column read sort column size index column sort column iter column column sort column iter page raci possibl column page key start key key equal column skip row alreadi page result index column logger debug skip base cfs metadata key valid string column els rang instanceof rang index column column equal start key skip key exclud rang index column logger debug skip key rang exclud index column column column index column key column column mark delet logger debug skip column continu decor key base cfs partition decor key key rang minimum base cfs partition rang compar logger debug reach assign scan rang return data rang logger debug skip entri outsid assign scan rang token continu logger debug return index hit column famili data base cfs column famili queri filter path filter initi filter column famili primari claus column initi filter null data null data column famili creat base cfs metadata return row data public void close throw 