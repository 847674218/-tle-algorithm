licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra gms import java import java net inet address import java util array list import java util hash map import java util list import java util map import java util map entri import org slf logger import org slf logger factori import org apach cassandra version serial import org apach cassandra net compact endpoint serial helper messag start gossip protocol class gossip digest syn messag privat static version serial gossip digest syn messag serial static serial gossip digest syn messag serial string cluster list gossip digest digest array list gossip digest public static version serial gossip digest syn messag serial return serial public gossip digest syn messag string cluster list gossip digest digest cluster cluster digest digest list gossip digest gossip digest return digest class gossip digest serial helper privat static logger logger logger factori logger gossip digest serial helper class static void serial list gossip digest digest list data output dos int version throw dos write int digest list size gossip digest digest digest list gossip digest serial serial digest dos version static list gossip digest deseri data input dis int version throw int size dis read int list gossip digest digest array list gossip digest size int size digest add gossip digest serial deseri dis version return digest class endpoint state serial helper privat static final logger logger logger factori logger endpoint state serial helper class static void serial map inet address endpoint state state map data output dos int version throw dos write int state map size entri inet address endpoint state entri state map entri set inet address entri key compact endpoint serial helper serial dos endpoint state serial serial entri valu dos version static map inet address endpoint state deseri data input dis int version throw int size dis read int map inet address endpoint state state map hash map inet address endpoint state size int size inet address compact endpoint serial helper deseri dis endpoint state state endpoint state serial deseri dis version state map put state return state map class gossip digest syn messag serial implement version serial gossip digest syn messag public void serial gossip digest syn messag digest syn messag data output dos int version throw dos write digest syn messag cluster gossip digest serial helper serial digest syn messag digest dos version public gossip digest syn messag deseri data input dis int version throw string cluster dis read list gossip digest digest gossip digest serial helper deseri dis version return gossip digest syn messag cluster digest public long serial size gossip digest syn messag gossip digest syn messag int version throw unsupport oper 