licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra thrift import java net inet address import java net inet socket address import java util array import java util list import java util concurr executor servic import java util concurr synchron queue import java util concurr time unit import org apach cassandra servic abstract cassandra daemon import org apach cassandra util util import org apach thrift server nonblock server import org apach thrift server thread pool server import org slf logger import org slf logger factori import org apach cassandra concurr enabl thread pool executor import org apach cassandra concurr thread factori import org apach cassandra config databas descriptor import org apach thrift protocol protocol factori import org apach thrift server server import org apach thrift transport frame transport import org apach thrift transport nonblock server transport import org apach thrift transport server transport import org apach thrift transport transport import org apach thrift transport transport factori class support method creat cassandra node daemon invok class main method jsvc wrapper common daemon inform class jsvc wrapper href http common apach org daemon jsvc html common daemon document public class cassandra daemon extend org apach cassandra servic abstract cassandra daemon protect static cassandra daemon instanc static abstract cassandra daemon init log privat static logger logger logger factori logger cassandra daemon class privat final static string sync privat final static string async privat final static string hsha public final static list string rpc server type array list privat thrift server server protect void start server server null server thrift server listen addr listen port server start protect void stop server server null server stop server tri server join catch interrupt logger error interrupt wait thrift server stop server null public static void stop string arg instanc stop server instanc deactiv public static void main string arg instanc cassandra daemon instanc activ simpl class run thrift connect accept code separ thread control privat static class thrift server extend thread privat server server engin public thrift server inet address listen addr int listen port start listen client final cassandra server cassandra server cassandra server cassandra processor processor cassandra processor cassandra server transport logger info string format bind thrift servic listen addr listen port protocol factori protocol factori protocol factori binari protocol factori true true transport factori int frame transport size databas descriptor thrift frame transport size transport factori transport factori frame transport factori frame transport size transport factori transport factori frame transport factori frame transport size logger info fast frame transport max frame size byte frame transport size databas descriptor rpc server type equal ignor case server transport server transport tri server transport custom server socket inet socket address listen addr listen port databas descriptor rpc aliv databas descriptor rpc send buffer size databas descriptor rpc recv buffer size catch transport throw runtim string format unabl creat thrift socket listen addr listen port thread pool server invoc connect basi thread pool server arg server arg thread pool server arg server transport min worker thread databas descriptor rpc min thread max worker thread databas descriptor rpc max thread input transport factori transport factori output transport factori transport factori input protocol factori protocol factori output protocol factori protocol factori processor processor executor servic executor servic clean thread pool cassandra server client state server arg min worker thread server arg max worker thread server engin custom thread pool server server arg executor servic logger info string format synchron threadpool thrift server listen addr listen port els nonblock server transport server transport tri server transport custom nonblock server socket inet socket address listen addr listen port databas descriptor rpc aliv databas descriptor rpc send buffer size databas descriptor rpc recv buffer size catch transport throw runtim string format unabl creat thrift socket listen addr listen port databas descriptor rpc server type equal ignor case singl thread henc invoc thread nonblock server arg server arg nonblock server arg server transport input transport factori transport factori output transport factori transport factori input protocol factori protocol factori output protocol factori protocol factori processor processor logger info string format block asynchron thrift server listen addr listen port server engin custom block server server arg els databas descriptor rpc server type equal ignor case selector servic invoc multi thread executor servic executor servic executor servic enabl thread pool executor databas descriptor rpc min thread databas descriptor rpc max thread time unit synchron queue runnabl thread factori thread nonblock server arg server arg nonblock server arg server transport input transport factori transport factori output transport factori transport factori input protocol factori protocol factori output protocol factori protocol factori processor processor logger info string format custom sync async thrift server listen addr listen port check avail processor system equal thread server engin custom server server arg executor servic util avail processor public void run logger info listen thrift client server engin serv public void stop server logger info stop listen thrift client server engin stop 