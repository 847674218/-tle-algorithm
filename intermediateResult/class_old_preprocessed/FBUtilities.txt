licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java import java lang reflect field import java lang reflect invoc target import java math big integ import java net inet address import java net import java net unknown host import java nio byte buffer import java secur messag digest import java secur algorithm import java util import java util concurr execut import java util concurr futur import java util concurr time unit import java util concurr timeout import googl common base joiner import googl common collect abstract iter import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra cach row cach provid import org apach cassandra concurr creation time awar futur import org apach cassandra config configur import org apach cassandra config databas descriptor import org apach cassandra decor key import org apach cassandra dht partition import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra version serial import org apach cassandra util data output buffer import org apach cassandra locat properti file snitch import org apach cassandra net async result import org apach thrift base import org apach thrift deseri import org apach thrift import org apach thrift serial import org codehaus jackson json factori import org codehaus jackson map object mapper import org codehaus jackson type type refer public class util privat static logger logger logger factori logger util class privat static object mapper json mapper object mapper json factori public static final big integ big integ privat static volatil inet address local inet address privat static volatil inet address broadcast inet address public static int avail processor system properti cassandra avail processor null return integ pars int system properti cassandra avail processor els return runtim runtim avail processor privat static final thread local messag digest local digest thread local messag digest overrid protect messag digest initi valu return messag digest overrid public messag digest messag digest digest super digest reset return digest privat static final thread local random local random thread local random overrid protect random initi valu return random public static final int public static messag digest thread local digest return local digest public static messag digest messag digest string algorithm tri return messag digest instanc algorithm catch algorithm nsae throw runtim request digest algorithm algorithm avail nsae public static random thread local random return local random pleas broadcast address onli listen connect public static inet address local address local inet address null tri local inet address databas descriptor listen address null inet address local host databas descriptor listen address catch unknown host throw runtim return local inet address public static inet address broadcast address broadcast inet address null broadcast inet address databas descriptor broadcast address null local address databas descriptor broadcast address return broadcast inet address bit array repres big integ number signific bit calcul midpoint param left left point param point param sigbit number bit point signific return midpoint compar bitwis halfway param boolean repres lsbit remaind generat public static pair big integ boolean midpoint big integ left big integ int sigbit big integ midpoint boolean remaind left compar big integ sum left add remaind sum test bit midpoint sum shift els big integ max pow sigbit wrap case big integ distanc max add subtract left remaind distanc test bit midpoint distanc shift add left mod max return pair big integ boolean midpoint remaind public static int compar unsign byte byte byte byte int offset int offset int len int len return fast byte comparison compar byte offset len byte offset len return bitwis input output length longer input input null output null public static byte xor byte left byte left null null return null left length length byte swap left left swap left length length byte array copi length int left length byte left return public static big integ hash big integ byte buffer data byte result hash data big integ hash big integ result return hash ab public static byte hash byte buffer data messag digest messag digest local digest byte buffer block data block array messag digest updat block array block array offset block posit block remain els messag digest updat block duplic return messag digest digest public static void renam confirm string tmp filenam string filenam throw file tmp filenam renam file filenam throw renam fail filenam public static void serial serial serial base struct data output throw assert serial null assert struct null assert null byte byte tri byte serial serial struct catch throw runtim write int byte length write byte public static void deseri deseri deseri base struct data input throw assert deseri null assert struct null assert null byte byte byte read int read fulli byte tri deseri deseri struct byte catch throw public static void sort sampl key list decor key key rang token rang rang left compar rang rang wrap care sort order rang find midpoint final token rang compar decor key compar compar decor key public int compar decor key decor key compar token compar token compar token compar token token side wrap point return compar return compar collect sort key compar els unwrap rang left standard sort collect sort key public static int encod length string int strlen length int utflen int strlen int char utflen els utflen els utflen return utflen public static string resourc file string filenam throw configur class loader loader util class class loader scpurl loader resourc filenam scpurl null throw configur unabl locat filenam return scpurl file public static string releas version string tri input stream util class class loader resourc stream org apach cassandra config version properti null return unknown properti prop properti prop load return prop properti cassandra version catch logger warn unabl load version properti return debug version public static long timestamp micro microsecond resolut compat client librari actual microsecond precis return system current time milli public static void wait futur iter futur futur futur futur wait futur public static void wait futur futur futur tri futur catch execut throw runtim catch interrupt throw assert error public static void wait futur list async result result long throw timeout async result result result result time unit wait futur complet param timeout timeout express code time unit code unit param time unit time unit throw timeout wait time exceed code timeout code public static void wait futur list creation time awar futur hint futur long timeout time unit time unit throw timeout futur futur hint futur tri futur timeout time unit catch interrupt throw assert error catch execut throw runtim public static partition partition string partition class throw configur partition class partition class org apach cassandra dht partition class return util construct partition class partition return class param classnam fulli qualifi classnam param readabl descript noun role class play throw configur class public static class class string classnam string readabl throw configur tri return class class classnam catch class throw configur string format unabl find class readabl classnam construct instanc class arg constructor param classnam fulli qualifi classnam param readabl descript noun role class play throw configur class public static construct string classnam string readabl throw configur class cls util class classnam readabl tri return cls constructor instanc catch method throw configur string format default constructor class readabl classnam catch illeg access throw configur string format default constructor class inaccess readabl classnam catch instanti throw configur string format abstract class classnam readabl catch invoc target caus instanceof configur throw configur caus throw configur string format error instanti class readabl classnam public static extend compar sort set singleton column return tree set array list column public static string string map map joiner map joiner joiner joiner key valu separ return joiner join map access protect privat field specifi class param klass class param field field return field null error public static field protect field class klass string field field field tri field klass declar field field field set access true catch throw assert error return field public static row cach provid cach provid string cach provid throw configur cach provid cach provid org apach cassandra cach cach provid return util construct cach provid row cach provid public static closeabl iter closeabl iter iter iter return wrap closeabl iter iter public static map string string json map string json tri return json mapper read valu json map class catch throw runtim public static list string json list string json tri return json mapper read valu json list class catch throw runtim public static string json object object tri return json mapper write valu string object catch throw runtim start wait param finish throw java exit code public static void exec process builder throw process start tri int err code wait err code buffer reader buffer reader input stream reader input stream buffer reader err buffer reader input stream reader error stream string builder string builder string str str read line null append str append system properti line separ str err read line null append str append system properti line separ throw execut command string util join command command error code err code command output string catch interrupt throw assert error public static void sleep int milli tri thread sleep milli catch interrupt throw assert error privat static final class wrap closeabl iter extend abstract iter implement closeabl iter privat final iter sourc public wrap closeabl iter iter sourc sourc sourc protect comput sourc return data return sourc public void close public static byte serial object version serial serial int version throw int size int serial serial size object version data output buffer buffer data output buffer size serial serial object buffer version assert buffer length size buffer data length size string format final buffer length accomod data size predict buffer data length buffer length size object return buffer data public static runtim uncheck return instanceof runtim runtim runtim 