licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra util import java error import java import java nio map byte buffer import java util iter import java util element import org apach cassandra config config import org apach cassandra util pair abstract read onli file split segment repres independ file data input iter file data input random access file data input posit onli map time segment size mmap segment longer segment mmap random access file creat access segment public abstract class segment file public final string path public final long length differ length compress file length segment iter becaus offset file relat uncompress size public final long disk length builder builder construct segment file segment file string path long length path length length protect segment file string path long length long disk length path path length length disk length disk length return segment file builder public static builder builder config disk access mode mode return mode config disk access mode mmap mmap segment file builder buffer segment file builder public static builder compress builder return compress segment file builder public abstract file data input segment long posit return iter segment segment posit segment close public iter file data input iter long posit int buffer size return segment iter posit whatev action reclaim ressourc segment file public abstract void cleanup collect potenti segment point file build segment file repres public static abstract class builder add posit safe place segment boundari file block row base file format safe boundari block row edg param boundari absolut posit potenti boundari file public abstract void add potenti boundari long boundari call potenti boundari ad appli builder concret file disk param path file disk public abstract segment file complet string path static final class segment extend pair long map byte buffer implement compar segment public segment long offset map byte buffer segment super offset segment public final int compar segment return int math signum left left lazi iter segment order posit final class segment iter implement iter file data input privat long nextpo public segment iter long posit nextpo posit public boolean return nextpo length public file data input long posit nextpo posit length throw element file data input segment segment nextpo tri nextpo nextpo segment byte remain catch throw error return segment public void remov throw unsupport oper overrid public string string return class simpl path path length length 