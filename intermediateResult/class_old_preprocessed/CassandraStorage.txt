licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra hadoop pig import java import java math big integ import java nio byte buffer import java util import org apach cassandra auth authent import org apach cassandra config configur import org apach cassandra column import org apach cassandra column import org apach cassandra marshal import org apach cassandra marshal abstract composit type composit compon import org apach cassandra hadoop import org apach cassandra thrift import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util hex import org apach cassandra util gen import org apach hadoop conf configur import org apach hadoop path import org apach hadoop mapreduc import org apach pig import org apach pig backend executionengin exec import org apach pig backend hadoop executionengin map reduc layer pig split import org apach pig data import org apach pig impl util context import org apach pig resourc schema resourc field schema import org apach thrift deseri import org apach thrift import org apach thrift serial import org slf logger import org slf logger factori load store func retriev data store data cassandra row standard return nest tupl key val val public class cassandra storag extend load func implement store func interfac load metadata privat enum marshal type system environ variabl set configur connect info altern hadoop job conf variabl set key config helper public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string public final static string privat final static string org apach cassandra hadoop column famili input format privat final static string org apach cassandra hadoop column famili output format privat final static string cassandra partit filter privat final static byte buffer byte buffer util privat static final logger logger logger factori logger cassandra storag class privat byte buffer slice start privat byte buffer slice privat boolean slice revers fals privat boolean delet fals privat string usernam privat string password privat string keyspac privat string column famili privat string load signatur privat string store signatur privat configur conf privat record reader byte buffer map byte buffer column reader privat record writer byte buffer list mutat writer privat string input format class privat string output format class privat int limit privat boolean widerow fals privat boolean partit filter fals wide row hack privat byte buffer key privat map byte buffer column row privat boolean true public cassandra storag param limit number column fetch slice public cassandra storag int limit super limit limit public int limit return limit public tupl wide throw def def def load signatur byte buffer key null tupl tupl null default data bag bag default data bag tri true reader key valu tupl null tupl tupl factori instanc tupl row null tupl size row key byte buffer reader current key tupl key tupl key def pars type def key valid class map entri byte buffer column entri row entri set bag add column tupl entri valu def pars type def compar type key null row null tupl append bag return tupl els tupl size rare case wide row key alreadi set tupl append bag return tupl els return null key null byte buffer reader current key equal key key chang read hold time key byte buffer reader current key row sort map byte buffer column reader current valu return tupl append bag return tupl key null onli set key iter key byte buffer reader current key key null key equal key key onli valu tupl null tupl key tupl key def pars type def key valid class els add key tupl tupl key def pars type def key valid class map entri byte buffer column entri row entri set bag add column tupl entri valu def pars type def compar type tupl append bag key key row sort map byte buffer column reader current valu return tupl tupl null tupl key tupl key def pars type def key valid class els add key tupl tupl key def pars type def key valid class sort map byte buffer column row sort map byte buffer column reader current valu row null prepend read time map entri byte buffer column entri row entri set bag add column tupl entri valu def pars type def compar type key null row null map entri byte buffer column entri row entri set bag add column tupl entri valu def pars type def compar type catch interrupt throw messag overrid public tupl throw widerow return wide tri load pair reader key valu return null def def def load signatur byte buffer key reader current key map byte buffer column reader current valu assert key null null output tupl hold key index column tupl bag rest set tupl size onli key set tupl valu tupl tupl key tupl key def pars type def key valid class default data bag bag default data bag add index column match schema map byte buffer boolean ad hash map byte buffer boolean care iter order schema doe column def cdef def column metadata key cdef tupl append column tupl cdef def pars type def compar type els otherwis add empti tupl place tupl append tupl factori instanc tupl ad put cdef true add column map entri byte buffer column entri entri set ad key entri key bag add column tupl entri valu def pars type def compar type tupl append bag final special top level index partit filter column def cdef index tupl throwaway column tupl cdef def pars type def compar type tupl append throwaway return tupl catch interrupt throw messag deconstruct composit type tupl privat tupl compos composit abstract composit type compar byte buffer throw list composit compon result compar deconstruct tupl tupl factori instanc tupl result size int result size set tupl valu result compar compos result valu return privat tupl key tupl byte buffer key def def abstract type compar throw tupl tupl tupl factori instanc tupl add key tupl tupl key def compar return tupl privat void add key tupl tupl tupl byte buffer key def def abstract type compar throw compar instanceof abstract composit type set tupl valu tupl compos composit abstract composit type compar key els set tupl valu tupl default marshal def marshal type compos key privat tupl column tupl column col def def abstract type compar throw tupl pair tupl factori instanc tupl compar instanceof abstract composit type set tupl valu pair compos composit abstract composit type compar col els set tupl valu pair compar compos col col instanceof column standard map byte buffer abstract type valid valid map def valid col null map marshal type abstract type marshal default marshal def set tupl valu pair marshal marshal type compos col valu els set tupl valu pair valid col compos col valu return pair els super array list tupl subcol array list tupl column subcol col column subcol add column tupl subcol def pars type def subcompar type pair set default data bag subcol return pair privat void set tupl valu tupl pair int posit object valu throw exec valu instanceof big integ pair set posit big integ valu int valu els valu instanceof byte buffer pair set posit data byte array byte buffer util array byte buffer valu els valu instanceof pair set posit data byte array gen decompos java util valu els valu instanceof date pair set posit date type instanc decompos date valu long els pair set posit valu privat def def string signatur context context context context properti properti context properti cassandra storag class return cfdef string properti properti signatur privat list index express index express context context context context properti properti context properti cassandra storag class properti properti null return index express string properti properti els return null privat map marshal type abstract type default marshal def def throw map marshal type abstract type marshal enum map marshal type abstract type marshal type class abstract type compar abstract type subcompar abstract type default valid abstract type key valid compar pars type def compar type subcompar pars type def subcompar type default valid pars type def default valid class key valid pars type def key valid class marshal put marshal type compar marshal put marshal type default valid marshal put marshal type key valid marshal put marshal type subcompar return marshal privat map byte buffer abstract type valid map def def throw map byte buffer abstract type valid hash map byte buffer abstract type column def def column metadata valid class null valid class empti abstract type valid null tri valid type parser pars valid class valid put valid catch configur throw return valid privat abstract type pars type string type throw tri alway treat counter long specif compos type null type equal org apach cassandra marshal counter column type return long type instanc return type parser pars type catch configur throw overrid public input format input format tri return util construct input format class inputformat catch configur throw runtim overrid public void prepar read record reader reader pig split split reader reader public static map string string queri map string queri string param queri split map string string map hash map string string string param param string key valu param split map put key valu key valu return map privat void set locat uri string locat throw tri locat start cassandra throw bad scheme string url part locat split url part length map string string url queri queri map url part abstract type compar byte type instanc url queri key compar compar type parser pars url queri compar url queri key slice start slice start compar string url queri slice start url queri key slice slice compar string url queri slice url queri key revers slice revers boolean pars boolean url queri revers url queri key limit limit integ pars int url queri limit url queri key delet delet boolean pars boolean url queri delet url queri key widerow widerow boolean pars boolean url queri widerow url queri key secondari partit filter boolean pars boolean url queri secondari string part url part split string credenti keyspac part split credenti keyspac length string credenti credenti keyspac split usernam credenti password credenti keyspac credenti keyspac els keyspac part column famili part catch throw expect cassandra usernam password keyspac columnfamili slice start start slice revers true limit delet true widerow true secondari true messag privat void set connect inform throw system getenv null config helper set input rpc port conf system getenv config helper set output rpc port conf system getenv system getenv null config helper set input rpc port conf system getenv system getenv null config helper set output rpc port conf system getenv system getenv null config helper set input initi address conf system getenv config helper set output initi address conf system getenv system getenv null config helper set input initi address conf system getenv system getenv null config helper set output initi address conf system getenv system getenv null config helper set input partition conf system getenv config helper set output partition conf system getenv system getenv null config helper set input partition conf system getenv system getenv null config helper set output partition conf system getenv system getenv null input format class fulli qualifi class system getenv els input format class system getenv null output format class fulli qualifi class system getenv els output format class system getenv null delet boolean valu system getenv privat string fulli qualifi class string classnam return classnam classnam org apach cassandra hadoop classnam overrid public void set locat string locat job job throw conf job configur set locat uri locat config helper input slice predic conf null slice rang rang slice rang slice start slice slice revers limit slice predic predic slice predic set slice rang rang config helper set input slice predic conf predic system getenv null widerow boolean valu system getenv system getenv null partit filter boolean valu system getenv partit filter index express null config helper set input rang conf index express usernam null password null config helper set input keyspac user password conf usernam password config helper set input column famili conf keyspac column famili widerow set connect inform config helper input rpc port conf throw environ variabl set config helper input initi address conf null throw environ variabl set config helper input partition conf null throw environ variabl set load signatur null load signatur locat init schema load signatur public resourc schema schema string locat job job throw set locat locat job def def def load signatur def column type equal super return null return schema key index valu index valu column valu column metadata return tupl unknown column bag wide row handl bag column easili referenc top level schema type resourc schema schema resourc schema default marshal valid map marshal type abstract type marshal default marshal def map byte buffer abstract type valid valid map def add key resourc field schema key field schema resourc field schema key field schema set key key field schema set type pig type marshal marshal type resourc schema bag schema resourc schema resourc field schema bag field resourc field schema bag field set type data type bag field set column insid bag place tupl default compar valid schema resourc schema bag tupl schema resourc schema resourc field schema bag tupl field resourc field schema bag tupl field set type data type resourc field schema bagcol schema resourc field schema resourc field schema bagval schema resourc field schema bagcol schema set bagval schema set valu bagcol schema set type pig type marshal marshal type bagval schema set type pig type marshal marshal type bag tupl schema set field resourc field schema bagcol schema bagval schema bag tupl field set schema bag tupl schema bag schema set field resourc field schema bag tupl field bag field set schema bag schema field schema list resourc field schema schema field array list resourc field schema add key index column final bag schema field add key field schema defin valid index column def cdef def column metadata tupl col val pair resourc schema tupl schema resourc schema resourc field schema tupl field resourc field schema tupl field set type data type tupl field set schema tupl schema tupl field set string cdef resourc field schema idx col schema resourc field schema idx col schema set idx col schema set type pig type marshal marshal type resourc field schema val schema resourc field schema abstract type valid valid cdef valid null valid marshal marshal type val schema set valu val schema set type pig type valid tupl schema set field resourc field schema idx col schema val schema schema field add tupl field bag unknown column schema field add bag field add top level index element partit filter column def cdef index resourc field schema idx schema resourc field schema idx schema set index string cdef abstract type valid valid cdef valid null valid marshal marshal type idx schema set type pig type valid schema field add idx schema top level schema everyth schema set field schema field array resourc field schema schema field size return schema privat byte pig type abstract type type type instanceof long type type instanceof date type date type bad feel bad return data type els type instanceof integ type type instanceof int type integ type overflow compat pig big integ return data type els type instanceof ascii type return data type els type instanceof type return data type els type instanceof float type return data type els type instanceof doubl type return data type els type instanceof abstract composit type return data type return data type public resourc statist statist string locat job job return null public string partit key string locat job job partit filter return null list column def index index string partit key string index size int index size partit key string index return partit key public void set partit filter express partit filter context context context context properti properti context properti cassandra storag class properti set properti index express string filter index express partit filter privat list index express filter index express express express list index express index express array list index express express binari express express binari express express byte buffer byte buffer wrap lhs string byte byte buffer valu byte buffer wrap rhs string byte switch express type case index express add index express index oper valu break case index express add index express index oper valu break case index express add index express index oper valu break case index express add index express index oper valu break case index express add index express index oper valu break case index express add filter index express lhs index express add filter index express rhs break default throw runtim unsupport express type express type return index express privat list column def index def cfdef def load signatur list column def index array list column def column def cdef cfdef column metadata cdef index type null index add cdef return index overrid public string relat absolut path string locat path cur dir throw return locat overrid public void set context signatur string signatur load signatur signatur store func method public void set store func context signatur string signatur store signatur signatur public string rel ab path store locat string locat path cur dir throw return relat absolut path locat cur dir public void set store locat string locat job job throw conf job configur set locat uri locat usernam null password null config helper set output keyspac user password conf usernam password config helper set output column famili conf keyspac column famili set connect inform config helper output rpc port conf throw environ variabl set config helper output initi address conf null throw environ variabl set config helper output partition conf null throw environ variabl set check write column tupl system getenv null partit filter boolean valu system getenv init schema store signatur public output format output format tri return util construct output format class outputformat catch configur throw runtim public void check schema resourc schema schema throw don care type cast byte buffer public void prepar write record writer writer writer writer privat byte buffer obj object null return byte buffer instanceof java lang string return byte buffer wrap data byte array string instanceof integ return int type instanc decompos integ instanceof long return long type instanc decompos long instanceof float return float type instanc decompos float instanceof doubl return doubl type instanc decompos doubl instanceof return byte buffer wrap gen decompos instanceof tupl list object object tupl list byte buffer serial array list byte buffer object size int total length object object byte buffer buffer obj serial add buffer total length buffer remain byte buffer byte buffer alloc total length byte buffer serial int length remain put byte length put byte length put put byte flip return return byte buffer wrap data byte array public void put tupl throw support case output origin output key valu valu valu tupl bag option super onli accept origin output size simpli noth delet key logger warn empti output skip filter empti tupl suppress warn return byte buffer key obj type data type write column tupl key els type data type size throw argument bag write column bag key default data bag els throw argument output tupl bag privat void write column tupl byte buffer key tupl int offset throw array list mutat mutat list array list mutat int offset size type data type write column bag key default data bag els type data type tupl tupl size empti index column wasn present mutat list add mutat tupl els partit filter throw output type bag tupl mutat list size write mutat key mutat list privat mutat mutat tupl tupl throw mutat mutat mutat null delet mutat delet delet mutat delet predic org apach cassandra thrift slice predic mutat delet predic column array list obj mutat delet set timestamp util timestamp micro els throw null delet disabl set true environ delet true enabl els org apach cassandra thrift column column org apach cassandra thrift column column set obj column set valu obj column set timestamp util timestamp micro mutat column supercolumn column super column mutat column supercolumn column column return mutat privat void write column bag byte buffer key default data bag bag throw list mutat mutat list array list mutat tupl pair bag mutat mutat mutat data type find type pair data type supercolumn super column super column set obj pair list org apach cassandra thrift column column array list org apach cassandra thrift column tupl subcol default data bag pair org apach cassandra thrift column column org apach cassandra thrift column column set obj subcol column set valu obj subcol column set timestamp util timestamp micro column add column column empti delet mutat delet delet mutat delet super column obj pair mutat delet set timestamp util timestamp micro els throw super column delet attempt empti bag delet disabl set true environ delet true enabl els column column mutat column supercolumn column super column mutat column supercolumn super column els mutat mutat tupl pair mutat list add mutat wide row limit amount mutat write onc mutat list size arbitrari batch won care write mutat key mutat list mutat list clear write batch mutat list size write mutat key mutat list privat void write mutat byte buffer key list mutat mutat throw tri writer write key mutat catch interrupt throw public void cleanup failur string failur job job method column famili schema cassandra privat void init schema string signatur properti properti context context properti cassandra storag class onli schema haven alreadi properti key signatur tri cassandra client client config helper client input address list conf client set keyspac keyspac usernam null password null map string string credenti hash map string string credenti put authent usernam credenti put authent password tri client login authent request credenti catch authent logger error authent invalid usernam password throw runtim catch author throw assert error actual throw author def def null def def client describ keyspac keyspac list def def def def def def def column famili equal ignor case def def def break def null properti set properti signatur cfdef string def els throw runtim string format column famili keyspac column famili keyspac catch throw runtim catch invalid request throw runtim catch throw runtim catch throw runtim privat static string cfdef string def def assert def null aw kind cool serial serial serial binari protocol factori tri return hex byte hex serial serial def catch throw runtim privat static def cfdef string string assert null deseri deseri deseri binari protocol factori def def def tri deseri deseri def hex hex byte catch throw runtim return def privat static string index express string list index express index express assert index express null thought cfdef string aw index claus index claus index claus index claus set express index express index claus set start key byte serial serial serial binari protocol factori tri return hex byte hex serial serial index claus catch throw runtim privat static list index express index express string string assert null deseri deseri deseri binari protocol factori index claus index claus index claus tri deseri deseri index claus hex hex byte catch throw runtim return index claus express 