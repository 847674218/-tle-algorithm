licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra sstabl import java file import java import java util collect import java util set import java util concurr copi write array set import java util concurr execut import java util concurr time unit import googl common collect set import org slf logger import org slf logger factori import org apach cassandra data tracker import org apach cassandra servic storag servic import org apach cassandra util wrap runnabl public class tabl delet task extend wrap runnabl privat static final logger logger logger factori logger tabl delet task class delet sstabl tricki becaus mmap final delet fail window onli forc unmap addit delet data file restart recogn cabl privat static final set tabl delet task fail task copi write array set tabl delet task public final descriptor desc public final set compon compon privat data tracker tracker privat final long size public tabl delet task tabl reader refer desc refer descriptor compon refer compon size refer byte disk public void set tracker data tracker tracker tracker tracker public void schedul storag servic task submit protect void run throw throw success delet compon set task retri abov file datafil file desc filenam compon datafil delet logger error unabl delet datafil remov server restart retri fail task add return remaind clean delet tabl delet desc set differ compon collect singleton compon tracker null tracker space reclaim size retri delet fail time presum sstabl mmap becaus time invok expos mbean public static void reschedul fail task tabl delet task task fail task fail task remov task task schedul test public static void wait delet runnabl runnabl runnabl public void run tri storag servic task schedul runnabl time unit catch interrupt throw assert error catch execut throw runtim 