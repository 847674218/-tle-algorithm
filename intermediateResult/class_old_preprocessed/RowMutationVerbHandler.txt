licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java data input stream import java import java net inet address import org slf logger import org slf logger factori import org apach cassandra util fast byte array input stream import org apach cassandra net compact endpoint serial helper import org apach cassandra net verb handler import org apach cassandra net messag import org apach cassandra net messag servic public class row mutat verb handler implement verb handler privat static logger logger logger factori logger row mutat verb handler class public void verb messag messag string tri row mutat row mutat byte messag messag bodi messag version logger debug enabl logger debug appli check ani header messag byte byte messag header row mutat byte null messag version messag servic local node messag byte appli write respons respons write respons tabl key true messag respons messag write respons write respons messag messag respons logger debug enabl logger debug appli send respons messag messag servic instanc send repli respons messag messag catch logger error error row mutat older version send messag henc don check version data privat void local node messag messag byte byte throw data input stream dis data input stream fast byte array input stream byte int size dis read int remov fwds messag avoid infinit loop messag messag copi messag header remov row mutat int size send messag address list inet address address compact endpoint serial helper deseri dis string dis read logger debug enabl logger debug messag address respons coordin messag servic instanc send messag copi address 