packag org apach cassandra compact licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util array list import java util compar import java util list import org slf logger import org slf logger factori import org apach cassandra columniter column iter import org apach cassandra sstabl tabl ident iter import org apach cassandra sstabl tabl reader import org apach cassandra util closeabl iter import org apach cassandra util merg iter public class compact iter extend abstract compact iter privat static logger logger logger factori logger compact iter class privat long row privat static final compar column iter compar compar column iter public int compar column iter column iter return key compar key public compact iter oper type type list compact scanner scanner compact control control super control type scanner row public closeabl iter abstract compact row iter return merg iter scanner compar reduc public string string return compact info string protect class reduc extend merg iter reduc column iter abstract compact row protect final list tabl ident iter row array list tabl ident iter public void reduc column iter current row add tabl ident iter current protect abstract compact row reduc assert row empti tri abstract compact row compact row control compact row array list tabl ident iter row compact row empti control invalid cach row compact row key return null row cach call remov delet read time coher queri return row push cach obsolet tombston persist indefinit control remov delet cach compact row key return compact row final row clear row long compact scanner scanner scanner scanner current posit byte read control throttl byte read 