licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra locat import java net inet address import java util import java util map entri import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra config configur import org apach cassandra dht token import org apach cassandra util util import org apach cassandra util pair replic strategi properti file give intend replic factor datacent sum total datacent replic factor valu equal keyspac replic factor exampl keyspac replic factor datacent replic factor replica datacent anoth anoth total class cach endpoint invalid cach chang number token public class network topolog strategi extend abstract replic strategi privat final endpoint snitch snitch privat final map string integ datacent privat static final logger logger logger factori logger network topolog strategi class public network topolog strategi string tabl token metadata token metadata endpoint snitch snitch map string string config option throw configur super tabl token metadata snitch config option snitch snitch map string integ datacent hash map string integ config option null entri string string entri config option entri set string entri key equal ignor case replic factor throw configur replic factor option simpl strategi network topolog strategi integ replica integ valu entri valu datacent put replica datacent collect unmodifi map datacent logger debug configur datacent replica util string datacent public list inet address calcul natur endpoint token search token token metadata token metadata list inet address endpoint array list inet address replic factor entri string integ entri datacent entri set string entri key int replica entri valu collect endpoint add bulk token meta data comput complex reason set pair token inet address token updat hash set pair token inet address entri token inet address token entri token metadata token endpoint map read entri set snitch datacent token entri valu equal token updat add pair creat token entri key token entri valu token metadata token token metadata token updat normal token token updat list inet address endpoint array list inet address replica set string rack hash set string pass onli collect replica uniqu rack iter token iter token metadata ring iter token sort token search token fals endpoint size replica iter token token iter inet address endpoint token endpoint token string rack snitch rack endpoint rack rack endpoint add endpoint rack add rack pass replica count achiev uniqu rack add node duplic rack iter token iter token metadata ring iter token sort token search token fals endpoint size replica iter token token iter inet address endpoint token endpoint token endpoint endpoint endpoint add endpoint logger debug enabl logger debug endpoint datacent token object string util join endpoint search token endpoint add endpoint return endpoint public int replic factor int total int rep factor datacent valu total rep factor return total public int replic factor string integ replica datacent return replica null replica public set string datacent return datacent key set public void valid option throw configur entri string string config option entri set valid replic factor valu 