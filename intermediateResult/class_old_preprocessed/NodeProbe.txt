licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra tool import java import java print stream import java lang manag manag factori import java lang manag memori bean import java lang manag memori usag import java lang manag runtim bean import java net inet address import java net unknown host import java text simpl date format import java util import java util map entri import java util concurr execut import java util concurr timeout import java util concurr lock condit import javax manag import javax manag remot connector import javax manag remot connector factori import javax manag remot servic import googl common collect iter import org apach cassandra concurr enabl thread pool executor bean import org apach cassandra config configur import org apach cassandra column famili store bean import org apach cassandra compact compact manag import org apach cassandra compact compact manag bean import org apach cassandra gms failur detector import org apach cassandra gms failur detector bean import org apach cassandra locat endpoint snitch info bean import org apach cassandra net messag servic import org apach cassandra net messag servic bean import org apach cassandra servic import org apach cassandra stream stream servic import org apach cassandra stream stream servic bean import org apach cassandra thrift invalid request import org apach cassandra thrift unavail import org apach cassandra util simpl condit client oper cassandra public class node probe privat static final string fmt url servic jmx rmi jndi rmi jmxrmi privat static final string obj org apach cassandra type storag servic privat static final int default port final string host final int port privat string usernam privat string password privat connector jmxc privat bean server connect mbean server conn privat compact manag bean compact proxi privat storag servic bean proxi privat memori bean mem proxi privat runtim bean runtim proxi privat stream servic bean stream proxi public messag servic bean proxi privat failur detector bean proxi privat cach servic bean cach servic privat storag proxi bean proxi privat boolean fail creat node probe specifi host port usernam password param host hostnam address agent param port port remot agent throw connect failur public node probe string host int port string usernam string password throw interrupt assert usernam null usernam empti null password password empti usernam password blank host host port port usernam usernam password password connect creat node probe specifi host port param host hostnam address agent param port port remot agent throw connect failur public node probe string host int port throw interrupt host host port port connect creat node probe specifi host default port param host hostnam address agent throw connect failur public node probe string host throw interrupt host host port default port connect creat connect agent setup bean proxi throw connect failur privat void connect throw servic jmx url servic string format fmt url host port map string object env hash map string object usernam null string cred usernam password env put connector cred jmxc connector factori connect jmx url env mbean server conn jmxc bean server connect tri object object obj proxi bean proxi mbean server conn storag servic bean class object messag servic proxi bean proxi mbean server conn messag servic bean class object stream servic stream proxi bean proxi mbean server conn stream servic bean class object compact manag compact proxi bean proxi mbean server conn compact manag bean class object failur detector proxi bean proxi mbean server conn failur detector bean class object cach servic cach servic bean proxi mbean server conn cach servic bean class object storag proxi proxi bean proxi mbean server conn storag proxi bean class catch malform object throw runtim invalid object pleas report bug mem proxi manag factori platform bean proxi mbean server conn manag factori memori bean class runtim proxi manag factori platform bean proxi mbean server conn manag factori runtim bean class public void close throw jmxc close public void forc tabl cleanup string tabl string column famili throw execut interrupt proxi forc tabl cleanup tabl column famili public void scrub string tabl string column famili throw execut interrupt proxi scrub tabl column famili public void upgrad tabl string tabl string column famili throw execut interrupt proxi upgrad tabl tabl column famili public void forc tabl compact string tabl string column famili throw execut interrupt proxi forc tabl compact tabl column famili public void forc tabl flush string tabl string column famili throw execut interrupt proxi forc tabl flush tabl column famili public void forc tabl repair string tabl boolean sequenti string column famili throw proxi forc tabl repair tabl sequenti column famili public void forc repair async final print stream final string tabl boolean sequenti boolean primari rang string column famili throw repair runner runner repair runner tabl column famili tri proxi add notif listen runner null null runner repair wait proxi sequenti primari rang fail true catch throw final tri proxi remov notif listen runner catch listen ignor public void forc repair rang async final print stream final string tabl boolean sequenti final string start token final string token string column famili throw repair runner runner repair runner tabl column famili tri proxi add notif listen runner null null runner repair rang wait proxi sequenti start token token fail true catch throw final tri proxi remov notif listen runner catch listen ignor public void forc tabl repair primari rang string tabl boolean sequenti string column famili throw proxi forc tabl repair primari rang tabl sequenti column famili public void forc tabl repair rang string token string token string tabl boolean sequenti string column famili throw proxi forc tabl repair rang token token tabl sequenti column famili public void invalid key cach throw cach servic invalid key cach public void invalid row cach throw cach servic invalid row cach public void drain throw interrupt execut proxi drain public map string string token endpoint map return proxi token endpoint map public list string live node return proxi live node public list string join node return proxi join node public list string leav node return proxi leav node public list string move node return proxi move node public list string unreach node return proxi unreach node public map string string load map return proxi load map public map string float ownership return proxi ownership public map string float effect ownership string keyspac throw configur return proxi effect ownership keyspac public cach servic bean cach servic bean string cach path org apach cassandra type cach tri return bean proxi mbean server conn object cach path cach servic bean class catch malform object throw runtim public iter map entri string column famili store bean column famili store bean proxi tri return column famili store bean iter mbean server conn catch malform object throw runtim invalid object pleas report bug catch throw runtim retriev list stat mbean public compact manag bean compact manag proxi return compact proxi public string token return proxi token public string load string return proxi load string public string releas version return proxi releas version public int current generat number return proxi current generat number public long uptim return runtim proxi uptim public memori usag heap memori usag return mem proxi heap memori usag snapshot tabl option specifi onli specif column famili param snapshot snapshot param column famili column famili snapshot null param keyspac keyspac snapshot public void snapshot string snapshot string column famili string keyspac throw column famili null keyspac length throw specifi column famili snapshot specifi onli keyspac proxi column famili snapshot keyspac column famili snapshot els proxi snapshot snapshot keyspac remov exist snapshot public void clear snapshot string tag string keyspac throw proxi clear snapshot tag keyspac public boolean join return proxi join public void join ring throw configur proxi join ring public void decommiss throw interrupt proxi decommiss public void move string token throw interrupt configur proxi move token public void remov token string token proxi remov token token public string remov status return proxi remov status public void forc remov complet proxi forc remov complet public iter map entri string enabl thread pool executor bean thread pool bean proxi tri return thread pool proxi bean iter mbean server conn catch malform object throw runtim invalid object pleas report bug catch throw runtim retriev list stat mbean compact threshold param stream write public void compact threshold print stream string string column famili store bean cfs proxi cfs proxi println current compact threshold min cfs proxi minimum compact threshold max cfs proxi maximum compact threshold set compact threshold param minimum compact threshold minimum compact threshold param maximum compact threshold maximum compact threshold public void set compact threshold string string int minimum compact threshold int maximum compact threshold column famili store bean cfs proxi cfs proxi cfs proxi set compact threshold minimum compact threshold maximum compact threshold public void set cach capac int key cach capac int row cach capac tri string key cach path org apach cassandra type cach cach servic bean cach bean bean proxi mbean server conn object key cach path cach servic bean class cach bean set key cach capac key cach capac cach bean set row cach capac row cach capac catch malform object throw runtim public list inet address endpoint string keyspac string string key return proxi natur endpoint keyspac key public list string tabl string keyspac string string key column famili store bean cfs proxi cfs proxi keyspac return cfs proxi tabl key key public set inet address stream destin return stream proxi stream destin public list string file destin inet address host throw return stream proxi outgo file host host address public set inet address stream sourc return stream proxi stream sourc public list string incom file inet address host throw return stream proxi incom file host host address public string oper mode return proxi oper mode public void truncat string tabl string tri proxi truncat tabl catch unavail throw runtim error execut truncat catch timeout throw runtim error execut truncat catch throw runtim error execut truncat public endpoint snitch info bean endpoint snitch info proxi tri return bean proxi mbean server conn object org apach cassandra type endpoint snitch info endpoint snitch info bean class catch malform object throw runtim public column famili store bean cfs proxi string string column famili store bean cfs proxi null tri set object bean mbean server conn queri object org apach cassandra type column famili keyspac columnfamili null bean empti throw malform object couldn find bean assert bean size object bean bean cfs proxi bean proxi mbean server conn bean column famili store bean class catch malform object mone system err println column famili store system exit catch system err println column famili store system exit return cfs proxi public storag proxi bean proxi return proxi public string endpoint tri find endpoint local token crazi manner maintain compat bean interfac string string token proxi token map string string token endpoint proxi token endpoint map map entri string string pair token endpoint entri set pair key string equal string token return pair valu throw assert error find endpoint list someth veri wrong public string data center tri return endpoint snitch info proxi datacent endpoint catch unknown host return unknown public string rack tri return endpoint snitch info proxi rack endpoint catch unknown host return unknown public list string keyspac return proxi keyspac public void stop gossip proxi stop gossip public void start gossip proxi start gossip public void stop thrift server proxi stop server public void start thrift server proxi start server public boolean thrift server run return proxi server run public boolean initi return proxi initi public void set compact throughput int valu proxi set compact throughput sec valu public int compact throughput return proxi compact throughput sec public int count return proxi count public map string integ drop messag return proxi drop messag public void load tabl string string proxi load tabl public void rebuild index string string string idx proxi rebuild secondari index idx public string gossip info return proxi endpoint state public void stop string string compact proxi stop compact string public void set stream throughput int valu proxi set stream throughput sec valu public string schema version return proxi schema version public list string describ ring string keyspac throw invalid request return proxi describ ring keyspac public void rebuild string sourc proxi rebuild sourc public list string sampl key rang return proxi sampl key rang public void reset local schema throw proxi reset local schema public boolean fail return fail class column famili store bean iter implement iter map entri string column famili store bean privat iter object res iter privat bean server connect mbean server conn public column famili store bean iter bean server connect mbean server conn throw malform object null pointer object queri object org apach cassandra type column famili res iter mbean server conn queri queri null iter mbean server conn mbean server conn public boolean return res iter public entri string column famili store bean object object res iter string tabl object key properti keyspac column famili store bean cfs proxi bean proxi mbean server conn object column famili store bean class return abstract map simpl immut entri string column famili store bean tabl cfs proxi public void remov throw unsupport oper class thread pool proxi bean iter implement iter map entri string enabl thread pool executor bean privat iter object res iter privat bean server connect mbean server conn public thread pool proxi bean iter bean server connect mbean server conn throw malform object null pointer set object request mbean server conn queri object org apach cassandra request type null set object intern mbean server conn queri object org apach cassandra intern type null res iter iter concat request intern iter mbean server conn mbean server conn public boolean return res iter public map entri string enabl thread pool executor bean object object res iter string pool object key properti type enabl thread pool executor bean thread pool proxi bean proxi mbean server conn object enabl thread pool executor bean class return abstract map simpl immut entri string enabl thread pool executor bean pool thread pool proxi public void remov throw unsupport oper class repair runner implement notif listen privat final simpl date format format simpl date format yyyi privat final condit condit simpl condit privat final print stream privat final string keyspac privat final string column famili privat int cmd privat boolean success true repair runner print stream string keyspac string column famili keyspac keyspac column famili column famili public boolean repair wait storag servic bean proxi boolean sequenti boolean primari rang onli throw interrupt cmd proxi forc repair async keyspac sequenti primari rang onli column famili cmd condit await els string messag string format noth repair keyspac format format system current time milli keyspac println messag return success public boolean repair rang wait storag servic bean proxi boolean sequenti string start token string token throw interrupt cmd proxi forc repair rang async start token token keyspac sequenti column famili cmd condit await els string messag string format noth repair keyspac format format system current time milli keyspac println messag return success public void handl notif notif notif object handback repair equal notif type repair status int array cmd number status int status int notif user data assert status length onli output invok cmd status string messag string format format format notif time stamp notif messag println messag status anti entropi servic status ordin success fals els status anti entropi servic status ordin condit signal 