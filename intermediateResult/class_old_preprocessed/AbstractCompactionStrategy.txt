licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra compact import java import java util import java util concurr time unit import org apach cassandra column famili store import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra sstabl tabl import org apach cassandra sstabl tabl reader import org apach cassandra servic storag servic pluggabl compact strategi determin tabl merg main goal perform background compact constant typic tradeoff compact merg read time perform full maximum possibl compact request user public abstract class abstract compact strategi protect final column famili store cfs protect final map string string option protect abstract compact strategi column famili store cfs map string string option assert cfs null cfs cfs option option public map string string option return option releas ani resourc strategi shutdown reload schema chang default noth public void shutdown return background minor compact task run null noth param befor throw tombston older public abstract abstract compact task background task final int befor return compact task run compact columnfamilystor possibl null noth param befor throw tombston older public abstract abstract compact task maxim task final int befor return compact task correspond request sstabl null throw user request invalid compact param befor throw tombston older public abstract abstract compact task user defin task collect tabl reader sstabl final int befor return number background task estim columnfamilystor public abstract int estim remain task return size byte largest sstabl strategi public abstract long max tabl size return true check key exist ignor param sstabl ignor expens public abstract boolean key exist expens set extend tabl sstabl ignor filter tabl blacklist collect param origin candid collect check blacklist tabl return list tabl blacklist filter public static list tabl reader filter suspect tabl collect tabl reader origin candid list tabl reader filter candid array list tabl reader tabl reader candid origin candid candid mark suspect filter candid add candid return filter candid return list key scanner sstabl rang scan default implement simpli grab tabl scanner sstabl overrid method memori effici solut sstabl don overlap level compact strategi instanc public list compact scanner scanner collect tabl reader sstabl rang token rang throw array list compact scanner scanner array list compact scanner tabl reader sstabl sstabl scanner add sstabl direct scanner rang return scanner public list compact scanner scanner collect tabl reader compact throw return scanner compact null 