packag org apach cassandra columniter licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java error import java import java nio byte buffer import java util array dequ import java util dequ import java util list import googl common collect abstract iter import org apach cassandra column famili import org apach cassandra decor key import org apach cassandra column import org apach cassandra marshal abstract type import org apach cassandra sstabl index helper import org apach cassandra util file data input import org apach cassandra util file mark import org apach cassandra sstabl tabl reader import org apach cassandra util file util reader find block start column return block befor call function assum sort exploit index class index slice reader extend abstract iter column implement column iter privat final column famili empti column famili privat final list index helper index info index privat final file data input file privat final byte buffer start column privat final byte buffer finish column privat final boolean revers privat block fetcher fetcher privat dequ column block column array dequ column privat abstract type compar public index slice reader tabl reader sstabl file data input input byte buffer start column byte buffer finish column boolean revers file input start column start column finish column finish column revers revers compar sstabl metadata compar tri index helper skip bloom filter file index index helper deseri index file empti column famili column famili serial deseri tabl column column famili creat sstabl metadata file fetcher index null simpl block fetcher index block fetcher catch sstabl mark suspect throw error public column famili column famili return empti column famili public decor key key throw unsupport oper privat boolean column column column start column remain finish column remain return true els start column remain revers return compar compar column finish column els start column remain revers return compar compar column finish column els finish column remain revers return compar compar column start column els finish column remain revers return compar compar column start column els revers return compar compar column start column compar compar column finish column els revers return compar compar column start column compar compar column finish column protect column comput true column column block column poll column null column column return column tri column null fetcher block return data catch throw runtim public void close interfac block fetcher public boolean block throw privat class index block fetcher implement block fetcher privat final file mark mark privat int cur rang index index block fetcher throw file read int column count mark file mark cur rang index index helper index start column index compar revers public boolean block throw cur rang index cur rang index index size return fals seek correct offset data calcul data size index helper index info cur col posit index cur rang index read realli necessari revers finish column remain compar compar finish column cur col posit start column remain compar compar start column cur col posit return fals els start column remain compar compar start column cur col posit finish column remain compar compar finish column cur col posit return fals boolean bound fals file reset mark file util skip byte fulli file cur col posit offset file byte mark mark cur col posit offset cur col posit width bound column column empti column famili column serial deseri file revers block column add column els block column add column stop seek revers finish column remain bound compar compar column finish column els revers start column remain bound compar compar column start column revers cur rang index els cur rang index return true privat class simpl block fetcher implement block fetcher privat simpl block fetcher throw int column file read int int column column column empti column famili column serial deseri file revers block column add column els block column add column stop seek boolean bound fals revers finish column remain bound compar compar column finish column els revers start column remain bound compar compar column start column bound break public boolean block throw return fals 