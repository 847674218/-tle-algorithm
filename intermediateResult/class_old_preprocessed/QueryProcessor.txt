licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra cql import java nio byte buffer import java util import org antlr runtim import org slf logger import org slf logger factori import org apach cassandra cql statement import org apach cassandra config import org apach cassandra import org apach cassandra marshal abstract type import org apach cassandra marshal type parser import org apach cassandra servic client state import org apach cassandra thrift import org apach cassandra util util import org apach cassandra util semant version public class queri processor public static final semant version semant version beta privat static final logger logger logger factori logger queri processor class public static void valid key byte buffer key throw invalid request key null key remain throw invalid request key empti check key handl util write short byte array key remain util throw invalid request key length key remain longer maximum util public static void valid column iter byte buffer column throw invalid request byte buffer column remain column throw invalid request string format column long remain column remain throw invalid request length column public static void valid column byte buffer column throw invalid request valid column collect singleton list column public static void valid slice predic meta data metadata slice predic predic throw invalid request predic slice rang null valid slice rang metadata predic slice rang els valid column predic column public static void valid slice rang meta data metadata slice rang rang throw invalid request valid slice rang metadata rang start rang finish rang revers public static void valid slice rang meta data metadata byte buffer start byte buffer finish boolean revers throw invalid request abstract type compar metadata compar null compar byte buffer order compar revers compar revers compar compar start remain finish remain order compar compar start finish throw invalid request rang finish start travers order privat static cql result process statement statement statement client state client state list byte buffer variabl throw unavail invalid request time schema disagr statement check access client state statement valid client state cql result result statement execut client state variabl result null result cql result result type cql result type return result public static cql result process string queri string client state client state throw recognit unavail invalid request time schema disagr logger trace queri string return process statement statement queri string client state statement client state collect byte buffer empti list public static cql result process intern string queri client state state tri statement statement statement queri state statement statement valid state cql result result statement execut state collect byte buffer empti list result null result row empti result cql result result type cql result type return result catch recognit throw runtim catch unavail throw runtim catch invalid request throw assert error catch time throw runtim catch schema disagr throw runtim public static untyp result set resultifi string queri string row row select statement tri select statement statement queri string null statement catch invalid request throw runtim catch recognit throw runtim list cql row cql row tri cql row process collect singleton list row catch invalid request throw runtim return untyp result set cql row public static cql prepar result prepar string queri string client state client state throw recognit invalid request logger trace queri string pars statement prepar prepar statement queri string client state int statement statement queri string client state prepar put statement prepar statement logger trace string format store prepar statement bind marker statement prepar statement bound term assert prepar statement bound term prepar bound size list string var type array list string prepar bound size list string var array list string prepar bound size definit prepar bound var type add select statement short type type var add string cql prepar result result cql prepar result statement prepar bound size result set variabl type var type result set variabl var return result public static cql result process prepar statement statement client state client state list byte buffer variabl throw unavail invalid request time schema disagr check ani bound variabl verifi variabl empti statement bound term variabl size statement bound term throw invalid request string format marker bound variabl statement bound term variabl size point match count marker variabl logger trace enabl int variabl size logger trace variabl return process statement statement client state variabl privat static final int statement string cql hash string someth provid return cql hash code privat static pars statement prepar statement string queri str client state client state throw invalid request recognit pars statement statement pars statement queri str set keyspac statement requir login statement instanceof statement statement statement prepar keyspac client state return statement prepar privat static pars statement pars statement string queri str throw invalid request recognit tri lexer parser char stream stream string stream queri str cql lexer lexer cql lexer stream token stream token stream common token stream lexer cql parser parser cql parser token stream pars queri string statement instanc pars statement statement parser queri lexer parser queue ani error encount necessari turn lexer throw recognit error parser throw recognit error return statement catch runtim invalid request ire invalid request fail pars statement queri str reason class simpl messag ire init caus throw ire 