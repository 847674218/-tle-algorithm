packag org apach cassandra util licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java net inet address import java nio byte buffer import java secur messag digest import java secur algorithm import java util hash map import java util map import java util random import java util good www ietf org rfc rfc txt public class gen grand day milli oct privat static final long privat static final long clock random system current time milli long placement singleton import instanti static privat static final gen instanc gen privat long nano privat final map inet address long node cach hash map inet address long privat static final thread local messag digest local digest thread local messag digest overrid protect messag digest initi valu tri return messag digest instanc catch algorithm nsae throw runtim digest algorithm avail nsae overrid public messag digest messag digest digest super digest reset return digest privat gen someon didn whack clock chang order instanti clock throw runtim singleton instanti misplac creat type time base substitut hash address place unavail java param addr host address return instanc public static type host inet address addr return instanc creat time safe instanc clock seq node addr creat type uuid raw byte public static byte buffer raw return raw long raw posit raw long raw posit read uuid input stream public static read data input dis throw return dis read long dis read long write uuid output stream public static void write uuid data output dos throw dos write long uuid signific bit dos write long uuid signific bit decompos uuid raw byte public static byte decompos uuid long uuid signific bit long uuid signific bit byte byte int byte byte return return byte represent type time base base current system time return type repres byte public static byte time byte return creat time byte instanc creat time safe convert millisecond sinc epoch timestamp byte represent type time base warn method guarante return uniqu multipl invoc ident timestamp result ident param time milli return type repres byte public static byte time byte long time milli return creat time byte instanc creat time unsaf time milli privat static byte creat time byte long msb long lsb instanc clock seq node util local address byte uuid byte byte int uuid byte byte msb int uuid byte byte lsb return uuid byte return millisecond sinc epoch valu type param uuid type time base return number millisecond sinc unix epoch throw illeg argument version public static long adjust timestamp uuid uuid version throw illeg argument incompat uuid version uuid version return uuid timestamp todo cach valu assum node doesn chang privat long clock seq node inet address addr long lsb lsb clock lsb lsb clock lsb node addr return lsb return differ valu generat privat synchron long creat time safe long nano sinc system current time milli nano sinc nano nano nano sinc els nano sinc nano return creat time nano sinc privat long creat time unsaf long long nano sinc return creat time nano sinc privat long creat time long nano sinc long msb msb ffffffff nano sinc msb ffff nano sinc msb xffff nano sinc msb set version return msb lazili creat node hash cach privat long node inet address addr node cach key addr return node cach addr ideal address java doesn expos byte hash hash addr string long node int math min hash length node long hash assert xff node node cach put addr node return node privat static byte hash string data messag digest messag digest local digest string block data messag digest updat block byte return messag digest digest curious generat calendar calendar instanc time zone time zone set calendar set calendar calendar set calendar set calendar set calendar set calendar set calendar long time milli 