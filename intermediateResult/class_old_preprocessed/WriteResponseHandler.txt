licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra servic import java net inet address import java util array import java util collect import java util concurr atom atom integ import org slf logger import org slf logger factori import org apach cassandra tabl import org apach cassandra gms failur detector import org apach cassandra net messag import org apach cassandra thrift consist level import org apach cassandra thrift unavail import org apach cassandra util util handl block write consist level public class write respons handler extend abstract write respons handler protect static final logger logger logger factori logger write respons handler class protect final atom integ respons protect write respons handler collect inet address write endpoint consist level consist level string tabl runnabl callback super write endpoint consist level callback respons atom integ determin block tabl protect write respons handler inet address endpoint super array list endpoint consist level null respons atom integ public static write respons handler creat collect inet address write endpoint consist level consist level string tabl runnabl callback return write respons handler write endpoint consist level tabl callback public static write respons handler creat inet address endpoint return write respons handler endpoint public void respons messag respons decrement signal protect int determin block string tabl switch consist level case return case return case return case return case return tabl open tabl replic strategi replic factor case return tabl open tabl replic strategi replic factor default throw unsupport oper invalid consist level consist level string public void assur suffici live node throw unavail consist level consist level ensur block distinct live node hint local includ local node coordin valid replica alreadi int effect endpoint write endpoint util broadcast address write endpoint size write endpoint size effect endpoint respons throw unavail return count destin part desir target set int live node inet address destin write endpoint failur detector instanc aliv destin live node live node respons throw unavail public boolean latenc snitch return fals 