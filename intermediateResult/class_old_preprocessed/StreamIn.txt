packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java net inet address import java util collect import org apach cassandra gms gossip import org apach common lang string util import org slf logger import org slf logger factori import org apach cassandra column famili store import org apach cassandra tabl import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra sstabl descriptor import org apach cassandra net messag import org apach cassandra net messag servic import org apach cassandra util util stream data node send messag sourc node stream side stream detail public class stream privat static logger logger logger factori logger stream class request rang column famili keyspac public static void request rang inet address sourc string tabl collect rang token rang stream callback callback oper type type request rang sourc tabl tabl open tabl column famili store rang callback type request rang transfer specif public static void request rang inet address sourc string tabl collect column famili store column famili collect rang token rang stream callback callback oper type type assert rang size logger debug enabl logger debug request rang sourc string util join rang stream session session stream session creat sourc callback stream request messag srm stream request messag util broadcast address rang tabl column famili session session type messag messag srm messag gossip instanc version sourc messag servic instanc send messag sourc translat remot file local file creat local sstabl remot sstabl public static pend file context map pend file remot throw creat local sstabl remot sstabl descriptor remotedesc remot desc remotedesc stream compat throw unsupport oper string format tabl compat current version remot filenam descriptor local sstabl tabl tabl tabl open remotedesc ksname column famili store store tabl column famili store remotedesc cfname descriptor localdesc descriptor filenam store flush path remot size remot desc version return pend file localdesc remot 