licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra import java import java nio byte buffer import java util array import java util array list import java util list import org apach cassandra config meta data import org apach cassandra config schema import org apach cassandra dht abstract bound import org apach cassandra version serial import org apach cassandra util data output buffer import org apach cassandra util fast byte array input stream import org apach cassandra net messag import org apach cassandra net messag produc import org apach cassandra net messag servic import org apach cassandra servic read command import org apach cassandra servic storag servic import org apach cassandra thrift column parent import org apach cassandra thrift index claus import org apach cassandra thrift index express import org apach cassandra thrift invalid request import org apach cassandra thrift slice predic import org apach cassandra thrift binari protocol import org apach cassandra thrift thrift valid import org apach cassandra util byte buffer util import org apach cassandra util util import org apach thrift deseri import org apach thrift serial public class rang slice command implement messag produc read command privat static final rang slice command serial serial rang slice command serial public final string keyspac public final string column famili public final byte buffer super column public final slice predic predic public final list index express row filter public final abstract bound row posit rang public final int max result public final boolean max column public final boolean page public rang slice command string keyspac string column famili byte buffer super column slice predic predic abstract bound row posit rang int max result keyspac column famili super column predic rang null max result fals fals public rang slice command string keyspac string column famili byte buffer super column slice predic predic abstract bound row posit rang int max result boolean max column boolean page keyspac column famili super column predic rang null max result max column fals public rang slice command string keyspac column parent column parent slice predic predic abstract bound row posit rang list index express row filter int max result keyspac column parent column famili column parent super column predic rang row filter max result fals fals public rang slice command string keyspac column parent column parent slice predic predic abstract bound row posit rang list index express row filter int max result boolean max column boolean page keyspac column parent column famili column parent super column predic rang row filter max result max column page public rang slice command string keyspac string column famili byte buffer super column slice predic predic abstract bound row posit rang list index express row filter int max result keyspac column famili super column predic rang row filter max result fals fals public rang slice command string keyspac string column famili byte buffer super column slice predic predic abstract bound row posit rang list index express row filter int max result boolean max column boolean page keyspac keyspac column famili column famili super column super column predic predic rang rang row filter row filter max result max result max column max column page page public messag messag integ version throw version messag servic row filter null row filter empti pre version index scan command index queri generat return index scan command messag version data output buffer dob data output buffer serial serial dob version return messag util broadcast address storag servic verb array copi dob data dob length version overrid public string string return rang slice command keyspac keyspac column famili column famili super column super column predic predic rang rang row filter row filter max result max result max column max column public static rang slice command read messag messag throw byte byte messag messag bodi fast byte array input stream bis fast byte array input stream byte return serial deseri data input stream bis messag version public string keyspac return keyspac convert equival index scan command compat sake public index scan command index scan command assert row filter null row filter empti max column page throw illeg state proceed rang queri remot version pleas updat full cluster meta data cfm schema instanc meta data keyspac column famili tri thrift valid valid filter claus cfm row filter throw illeg state proceed index queri remot version pleas updat full cluster catch invalid request throw runtim row posit start rang left byte buffer start key byte buffer util start instanceof decor key start key decor key start key index claus claus index claus row filter start key max result return index scan command keyspac column famili claus predic rang class rang slice command serial implement version serial rang slice command public void serial rang slice command slice command data output dos int version throw dos write slice command keyspac dos write slice command column famili byte buffer slice command super column dos write int null remain null byte buffer util write dos serial ser serial binari protocol factori util serial ser slice command predic dos version messag servic slice command row filter null dos write int els dos write int slice command row filter size index express expr slice command row filter util serial ser expr dos abstract bound serial serial slice command rang dos version dos write int slice command max result version messag servic dos write boolean slice command max column dos write boolean slice command page public rang slice command deseri data input dis int version throw string keyspac dis read string column famili dis read int length dis read int byte buffer super column null length byte buf byte length dis read fulli buf super column byte buffer wrap buf deseri dser deseri binari protocol factori slice predic pred slice predic util deseri dser pred dis list index express row filter null version messag servic int filter count dis read int row filter array list index express filter count int filter count index express expr index express util deseri dser expr dis row filter add expr abstract bound row posit rang abstract bound serial deseri dis version row bound int max result dis read int boolean max column fals boolean page fals version messag servic max column dis read boolean page dis read boolean return rang slice command keyspac column famili super column pred rang row filter max result max column page public long serial size rang slice command rang slice command int version throw unsupport oper 