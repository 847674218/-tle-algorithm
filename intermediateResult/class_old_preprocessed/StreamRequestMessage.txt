packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java net inet address import java util import googl common collect iter import org apach cassandra column famili store import org apach cassandra tabl import org apach cassandra dht abstract bound import org apach cassandra dht rang import org apach cassandra dht token import org apach cassandra version serial import org apach cassandra util fast byte array output stream import org apach cassandra net compact endpoint serial helper import org apach cassandra net messag import org apach cassandra net messag produc import org apach cassandra net messag servic import org apach cassandra servic storag servic import org apach cassandra util util class encapsul messag node handoff data messag inform rang transfer target node file specifi rang tabl vice versa hold class stream request messag implement messag produc privat static version serial stream request messag serial static serial stream request messag serial protect static version serial stream request messag serial return serial protect final long session protect final inet address target specifi rang tabl protect final pend file file specifi file shoud protect final collect rang token rang protect final string tabl protect final iter column famili store column famili protect final oper type type stream request messag inet address target collect rang token rang string tabl iter column famili store column famili long session oper type type target target rang rang tabl tabl column famili column famili session session type type file null stream request messag inet address target pend file file long session target target file file session session type file type rang null tabl null column famili null public messag messag integ version fast byte array output stream bos fast byte array output stream data output stream dos data output stream bos tri stream request messag serial serial dos version catch throw error return messag util broadcast address storag servic verb bos byte array version public string string string builder string builder file null append tabl append append column famili string append append target append rang token rang rang append rang append append type els append file string return string privat static class stream request messag serial implement version serial stream request messag public void serial stream request messag srm data output dos int version throw dos write long srm session compact endpoint serial helper serial srm target dos srm file null dos write boolean true pend file serial serial srm file dos version els dos write boolean fals dos write srm tabl dos write int srm rang size rang token rang srm rang abstract bound serial serial rang dos version version messag servic dos write srm type version messag servic dos write int iter size srm column famili column famili store cfs srm column famili dos write int cfs metadata public stream request messag deseri data input dis int version throw long session dis read long inet address target compact endpoint serial helper deseri dis boolean singl file dis read boolean singl file pend file file pend file serial deseri dis version return stream request messag target file session els string tabl dis read int size dis read int list rang token rang size null array list rang token size int size rang add rang token abstract bound serial deseri dis version token bound oper type type oper type version messag servic type oper type valu dis read list column famili store store array list column famili store version messag servic int cfs size dis read int int cfs size store add tabl open tabl column famili store dis read int return stream request messag target rang tabl store session type public long serial size stream request messag stream request messag int version throw unsupport oper 