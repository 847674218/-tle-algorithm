packag org apach cassandra commitlog licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java import java util concurr import org apach cassandra config databas descriptor import org apach cassandra util util import org apach cassandra util wrap runnabl class period commit log executor servic implement commit log executor servic privat final block queue runnabl queue protect volatil long complet task count privat final thread append thread privat volatil boolean run true public period commit log executor servic final commit log commit log queue link block queue runnabl util avail processor runnabl runnabl wrap runnabl public void run throw throw run runnabl queue poll time unit null continu run complet task count commit log sync append thread thread runnabl append thread start final callabl syncer callabl public object call throw commit log sync return null thread runnabl public void run run tri submit syncer thread sleep databas descriptor commit log sync period catch interrupt throw assert error catch execut throw runtim start public void add commit log log record adder adder tri queue put adder catch interrupt throw runtim public futur submit callabl task futur task futur task task tri queue put catch interrupt throw runtim return public void shutdown thread wrap runnabl public void run throw throw interrupt queue empti thread sleep run fals append thread join commitlog shutdown start public void await termin throw interrupt append thread join public long pend task return queue size public long complet task return complet task count 