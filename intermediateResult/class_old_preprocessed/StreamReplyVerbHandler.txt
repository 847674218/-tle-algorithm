packag org apach cassandra stream licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens import java data input stream import java error import java import org slf logger import org slf logger factori import org apach cassandra util fast byte array input stream import org apach cassandra net verb handler import org apach cassandra net messag public class stream repli verb handler implement verb handler privat static logger logger logger factori logger stream repli verb handler class public void verb messag messag string byte bodi messag messag bodi fast byte array input stream buf fast byte array input stream bodi tri stream repli repli stream repli serial deseri data input stream buf messag version logger debug receiv stream repli repli stream session session stream session messag repli session session null logger debug receiv stream action repli action unknown session messag return switch repli action case logger info success repli file messag session valid current file repli file session start break case session valid current file repli file logger info stream file repli file messag session retri break case session close true break case session close fals break default throw runtim handl file status action repli action catch throw error 