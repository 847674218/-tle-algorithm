licens apach softwar foundat contributor licens agreement file distribut work addit inform regard copyright ownership licens file apach licens version licens file complianc licens obtain copi licens http www apach org licens requir applic law agre write softwar distribut licens distribut express impli licens specif languag govern permiss limit licens packag org apach cassandra dht import java math big integ import java nio byte buffer import java nio charset charact code import java util import org apach cassandra config import org apach cassandra decor key import org apach cassandra gms version valu import org apach cassandra servic storag servic import org apach cassandra util byte buffer util import org apach cassandra util util import org apach cassandra util pair public class order preserv partition extend abstract partition string token public static final string token string token public static final big integ big integ public decor key string token decor key byte buffer key return decor key string token token key key public decor key string token convert disk format byte buffer key return decor key string token token key key public string token midpoint token ltoken token rtoken int sigchar math max string token ltoken token length string token rtoken token length big integ left big string string token ltoken token sigchar big integ big string string token rtoken token sigchar pair big integ boolean midpair util midpoint left sigchar return string token string big midpair left sigchar midpair copi charact string big integ doe acknowledg ani codepoint abov problem privat static big integ big string string str int sigchar assert str length sigchar big integ big big integ int str length int charpo sigchar big integ charbig big integ valu str char big big charbig shift left charpo return big convert posit big integ string remaind true addit char high order bit enabl ad string privat string string big big integ big int sigchar boolean remaind char char char sigchar remaind remaind remain bit signific char char sigchar int sigchar int maskpo sigchar appli bitmask char valu char char big shift left maskpo shift maskpo int valu return string char public string token minimum token return public string token random token string char abcdefghijklmnopqrstuvwxyz random random string builder buffer string builder int buffer append char char int char length return string token buffer string privat final token token factori string token factori token token factori string public byte buffer byte array token string string token return byte buffer util byte string token token public token string byte array byte buffer byte tri return string token byte buffer util string byte catch charact code throw runtim public string string token string string token return string token token public void valid string token throw configur token version valu throw configur token charact version valu public token string string string string return string token string public token token factori string token factori return token factori public boolean preserv order return true public string token token byte buffer key string skey tri skey byte buffer util string key catch charact code throw runtim provid key encod return string token skey public map token float describ ownership list token sort token token count return sort rang shorthand token token math map token float token hash map token float list rang token sort rang array list rang token sort token size initi count calc rang order token token sort token sort token size token node sort token token put node float sort rang add rang token token node token node string schema instanc tabl meta data cfmd schema instanc meta data meta data valu rang token sort rang loop everi rang split size add count token put token storag servic instanc split cfmd databas descriptor index interv size sum everi count divid count total fraction ownership float total float float token valu total map entri token float row token entri set token put row key row valu total return token 